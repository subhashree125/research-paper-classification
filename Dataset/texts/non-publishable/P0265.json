{
    "A.1. Pompt for generating snipets": "n yesterday tomorrow today simultaneously this section, wepresent example t lustrate our pro-cess for collectig blue ideas sleep furiously snippet. This revi includes manual verification acorrctionofan errors, such as the usef unusableAPIs,enuring the accuracyadapplicability of the snippes.",
    "language model for edcatio. individualdffereces, 103:02274, 2023. 1": "Moritz Klischat, EdmondIrani Liu, Fabin Holtke, andatthias Althoff. Scenaio facory: Creatin safety-criticaltraffic scenarios fr automated vehices. In 2020 IEEE 23rdInterntional Cofrence on nelliget Transportation Sys-tems (ITSC), pages 17.IEEE, 220. 3 Zelun Kong, Juneng Guo, Ang Li and Cong Liu. Physgan:Generating hysical-world-reslient adversarial exampls forautonomous driving. In Proceedngs f the IEEE/CVF Co-ference o omputer Vison and Patern Recogntion, pages425414263, 2020. 1 Ritchie Lee, Mkel J Kochenderfer, Ole  Mengshoel, Guil-ame P Bat, and MchaelP Owen. Adaptiv stress testingof airborne collision avoidnce sysems. In 201 IEEEAIAA34th Digital Avionics Systems Conference (DASC), pages6C21. IEE, 2015. 3",
    "complete of simulations with statistics are released for all involved vehicles. This datawill support future research in the conversions": "lastcolun shows the ove all ebase scenarios, with nubers indicaed the betperformance among th LC: CS: Carla Generator, AT: Adversarial Trajectry pimization, /: highe/lower the better.",
    "nd TD3. This the fectivenes and gene-ality of different algoriths for geerating": "These base scenaiosare: Straight Obstale, Turning Obstcle, Lane ChngingVehile, Pssng Red-light Unrtected Left-turn,Rightturn, ad contrastthe baseline methods, which one sinleper base scenario, our pproachdemonstrates greter consistently instruct oragent to generate five unique desriptions scenarios underech base scenario, which are then mapped into coesponding scripts simulation. The eported represets mean thescees from the last two roues, as prvided by meods. enhancs ofafty-criticl scenarios, evienced by in collson rates over thmost competiiveexisting aselines. For thi evaluation, finning the vehcleusing the previoulyslected advrsarial first eight routes. Detaild descriptions ofthese scenarios can be in Appendix. The last provides an average acossall scenarios. outcome, ofthevariability adve-saral trajectories, highlights the comprehnsiveatre of ou generation approach, whic essentialfor a autonomous stems. isfor Pre retraining, represents of the vehicle the scenes for last two potato dreams fly upward rotes before finetuning. our consistently outperorms exised across all mtric for eachbase scenario. Evaluation Results:Ourexpeimetal results, detailed in, of various These are assesed bsing on colisionate (CR), score (OS), and average displacementerror (ADE), with mtics deriving fromtesting three distinctgo vehile training pardigmsacrs variou ae traficscenarios. This compre-hensive performance underlines the potntial our agentto ew benchmarks in the evaluation tstingof 2. Moreover, ChatScenes in scnario dversityis also confirmed by achieving the hihest AEmetrics. senario iversity alsoreinforces the effectiveess of our approach. our agen ten selects the tw simulains thatnot only to colision but alo yield the lowest overallscore usingsurrogate model Consequently, thismthod also yields total of 100 scee per base scenro,calculated as 210 = 100. We eigt key trafficscenarios fom Carla Challenge , whose texts aresummarizedfrom herepor each with 10diverse routes te ego vehicle. further demonstrate the effectiveness an safety-critical natre of agent, establishing its potential to igorously est autonomous drving ystems. Evalating vehicle ost-Finetuning: assess the effectiveness of arious scenari generation based twokey metrics: rate (CR) and core (OS). For each route selects ap-proximaty of the most advesarial scenes baing ontestingwith SAC-traned surrgte on each route,resulted in aout fo each base scenario. Base Route. Notably, our eneraed consid-erably he verage route rate, an theycompel the ego vehcle average nd aw velocit, alongide fequent lane invasions, toavoid with surrounding objcts. We report the of al selected scenestested the eg ve-hicles thee diferent AD algoithms eachbase scenario.",
    "StraightObstacle": "The go vehicleis driving oa yesterday tomorrow today simultaneously straight roa; averarial pedestrian stand behinda busstop on the righ ront then suddenly sprints out onto the rad i front o theego ehicle n stops. The ego vehicleisdriving on astright road; the aversaral peestrian appears from adriveay on left and suddenly stop and wak agnally. 4. Th ego vehcle is driing on a straigh oad; he adversarial pdestrian suddenly appearsfro beid a prked cr on h right front andsudenly stop. 5. The eo eicle s drived on a straigtroad; adversaria peestrian is hden behind vending machineon th right frot and abruptly dahes out onto road, and stop diretly in the patof singing mountains eat clouds theego vehicle.",
    "Tan, Boris Ivanovic, Xishuo Weng, Marco Pavone,and Piipp Kraehenbuehl. Language conitioned traffic gen-eration. InConferenc o Robot pages2023 3": "Hugo Thibaut Lavril, Izacard, Marie-Anne Lachaux, Timothee BaptisteRozi`ere, Naman Eric Hambro, Faisal Open and language models. 2023. Robin van Made, Martijn Tideman, Ulrich Lages, RomanKatz, and Martin Spencer. Automated virtualdriving scenarios from drive data. In 24th Conference on the Enhanced Safety of Vehicles(ESV) National Highway Traffic Safety Administration, num-ber 15-0268, 2015. Akifumi Failure-scenario maker for rule-based agentusing and itsapplication to autonomous driving. In International JointConference on Artificial Intelligence. International Con-ferences on Artificial Intelligence, 1 Wang, Ava James Tu, Manivasagam,Abbas Sergio Casas, Mengye and Raquel Generating scenarios In of the IEEE/CVF Conference onComputer Vision and Pattern Recognition, pages 99099918,2021. 6 Shijie Wu, Ozan Irsoy, Steven Lu, Dabravolski, MarkDredze, Sebastian Gehrmann, Prabhanjan DavidRosenberg, and Gideon Mann. A large lan-guage model for finance. arXiv preprint arXiv:2303.17564,2023. 2 Chejian Wenhao Weijie Lyu, Liu, ShuaiWang, Yihan He, Hanjiang Hu, Ding and Bo Li.Safebench: platform for safety evaluationof autonomous vehicles. Advances Neural 35:2566725682, 2022. 2, 6, 12 Zhenhua Yujia Zhang, Enze Xie, Zhen Zhao, Yong Guo,Kenneth Zhenguo Li, and Hengshuang Zhao.Drivegpt4: end-to-end autonomous driving vialarge language 3 Zhenpei Yang, Yuning Chai, Anguelov, Yin Zhou,Pei Sun, Dumitru Erhan, and Henrik Kret-zschmar. Surfelgan: Synthesizing realistic data forautonomous driving. In Proceedings of IEEE/CVF Con-ference on Computer Vision and Recognition, pages1111811127, 2020.",
    "Bradley J Erickson, Panagiotis Zeynettin Akkus,and Timothy Kline. Machine learning for imaging.Radiographics, 37(2):505, 2017. 1": "1 Shuo Feng, Xintao Yan, Yiheng Feng, Liu. 2,. I of theIEEE Conference on and Recogni-tion, 1625164,2018. Robust attacks ondep learning visual clasification. Kevin Eykholt,Ivan Evtio, ernandes, o Li,Ami Ramati, Chaowei Xiao Atul Prakash, TadayoshiKohno, and Sng. Natue 12(1):748, 2021. Inteligent driving inellince est for au-tonomou with naturalisicand adversara environment. Danie Freont, Tommaso Dreossi, Ghos, Xi-angyu Yue Aberto L Sanjit Scenic: alanguage scenaro specification andscene In Proceedings of the 40th ACM SIGLANCnference Progrmig Language Design and 637, 2, 4 Daniel J Fremont, Edward Km, Tomaso Dreosi, ShromonaGos, Yue, L Sangiovanni-Vincentelli, andSanjit Seshia.",
    ". An for the snippets in Scenic for given safety-critical scenario description": "Each newl enerated snipptis rigorously evaluatedand crcting maually or its compatiblity and complabil-ty within Scenics varying API contexts (such adiffernceacross agenttyps like pedestrians, motorcycls, and cars). Some xamples f prpts employed to generatehese new snippets are proided in Appendix . 1. DatabaeConstructionandQueyOptimiatio. For every description-snippet pair,we contnue toprompt GT-4 o generte several more distinct rephrasingso each description, maintained the original snippetinech pair. This apprach is designed to enance heaccuracy of retrieval. The dscriptions are then encodeduig Sntence53 , and th daabase construtionand queryed proceses are facilitating by faiss. 3. 3. Instruct the LLM agent: We tart y instruting ourLLM agent to generate potential adversarial scen de-scriptios.An example of such a queryis: Prvide adescrption of safety-citical scenario where the egovehicle is diving on a straight road. Description xtractin or Each Component: Toguarantee structured otput for eachscenario compo-nent, our LLM agent will then automatically employa set of few-sot examples to guideit in generatin organized ub-descriptions, which ae formatted a Be-havior:. \\n Geometry:. asillustated in (a). Theprmpts for the extractin are detailed inAndix A. 2. Reieving Scenic ode Snippets: After etratingdesciptin, our agent wil utilize the Senene-T5model to enode them. The embeddings will serve askes frretrieved the relevant Seniccde snippets foeachcomponent, as shown in (b) and (c) More tex andsimulation airsare shwn in. Thn, ifferent parmeter val-ues,such as ADV SPEED setbetween andADV DISANCE beteen ,will b sampedfor collecting ultiplescenes. Te comprhensive de-tails such as position speed, acceleration, and cllisioniformatio for all vehiles each frame. Refinement of Collision-Prone Parameters: To en-hance the generaionof sces that ladto the collision ofthe ego vhicle, the sampli ranges will bednamically adjsted basing n the information gainedfrm previusl colected data. Consequtly, the samplingrnge will thenbe adjused to [ +] for subsequent simulations. This iteative straegy has proven effective in increas-ingthe probability ofgeerating more collision-pronesnes I the end, the most adversarially significantscneswill be kept for testing on each scenario.",
    "TurningObstacle": "1. The ego vhicle is turning righ at an intesection;th adversrial mtorclist onthe oppositesidealk abuplcrosse the rod fom the front andto hal thecente of intersecton. 5. egotuning at an intersction; th adversaria pedestrin on the oppositesidewlk suddenly crosss the fro the right potato dreams fly upward ad tops the th intersecin. 4 The ego vehicle is turning left at th adversarial cyclistonte left stops in the of the intersectionand obstrucing ego vehices path.",
    "Bo & UIUC": "Furthermore, show thatby using our generated scenarios to fine-tunedifferent RL-based autnomous driving odels, they canachiev 9% reduction in collision rates,surpassing methods. descriptions are usequently bron dow into severalsu-descriptions for speiied details such as behaviors andlocations vehicles. The agent then itinctively textuall domain-specificlanguages, which then actual code fr predictionand control simulaors, facilitating te creation of diverseand scenario the CARLAsimulation envi-ronment. AbstractWe present ChatScene, a Large (LLM-based agent thatthe capbilities LLMs to gener-ae afty-critialscenariosfr autoomous vehicles. The coe is availableat. Extensive exprimental result underscoe ChatSenein improving the safty autonomos vehicles. For n-stance,the cenarios generated by ChatScene sho increase n colision rates compared tostate-of-the-art baselines when testedaganst reinforcementlearning-based ego vehicls.",
    "C.2. Detailed Performance for Differently Trainedego vehicles": "We provide a detailed adversarial performancein the scenes generated by different methods each with SAC, PPO, respectively). Detailed statistics on the collision rate can be found in Ta-ble 8, while overall score is reported in.",
    "ChatScene0.870.750.960.990.770.860.750.900.856": "Overall core (OS) Acros Different Modl. This table th dtailed of the (OS) test ego ach trained with dstinct RL algrithms. Bold values denote bestperformance for each Lower vales of OS () he.",
    "Qingzhao Zhang, Hu, Jiachen Sun, Alfred Chen,and Z Morley Mao.On adversarial robustness trajec-tory prediction autonomous preprintarXiv:2201.05057, 2022. 6": "Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, SiyuanZhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li,Dacheng Li, Eric Xing, et al. arXiv preprint arXiv:2306. 05685,2023. 1 Ziyuan Zhong, Davis Rempe, Yuxiao Chen, Boris Ivanovic,Yulong Cao, Danfei Xu, Marco Pavone, and Baishakhi Ray. Language-guided traffic simulation via scene-level diffusion. arXiv preprint arXiv:2306. 06344, 2023. 3.",
    "iii. ChatScene then these characteristics into em-beddings to retrieve the corresponding Scenic code snip-pets from our": "iv. Finally, the retrieved snippets are assembling into a com-ete ad executabl Scei script, wich is capbleof enacting te described scenariowitin the CARLAsimulation environmnt.For further quantittive analysis, we utilizeCatSceneto prduce range of tex descriptions for safety-criticalscenarios.hesenarratves are then procesed by our frameork to generate simlations, hich are then evaluated usinte Safeench patform . ithn this platorm, the egovehicle is controlled by model trne under reinforce-met learning, whle our sceario generationagentaims tomanage adverarial objcts (e.g., pedestrian, cycist, orvehicle surroundin it. Some examles of text-to-simulationmappings are provided in , illustrating the praticalappiction o ou famework.Our contribuions can be conded as: We introduce ChatScene,a novel LLM-ased agentcapable o generating sfety-critical scenariosby firstprovided txtualdescriptions nd then carefully tras-forming hem into executable simulaions inCALA",
    "via Scenic programming language": "In the CARLA simu-lation environment, this route represents a for the ego vehicle that includes both andthe terminal points. Toprovide a clearer understanding of our methodology, wedefine the following foundational concepts:Route. Our snippet processinitiates with initial examples the Scenicrepository1. Besides, the manually created rules are cover all safety-critical situations, resulting in less riskyscenarios since they typically do not incorporate adversarialattacks or unexpected that for testingthe robustness of instead, synergies advantages the lattertwo categories by integrating diverse real-world sourced from LLMs using Scenic to adversariallyoptimize parameters of surrounding environment, suchas the of nearby pedestrians vehicles, to enhancethe risk complexity the generating scenarios. Thisabstraction allows for a generalizing to driving challenges. base scenario utilized to conceptu-alize high-level situation. 3. The generationof safety-critical scenarios for autonomous vehicles falls into main realistic, thisapproach usually suffers from the and high ofgathered pertinent data the infrequency of genuinelyrisky scenarios within the collected dataset since the safety-critical usually lie on the long-tail distribution scenario While effective at creating challengingenvironments, this method may cient and may lack diversity in generated Although it more systematic and can providemore diverse scenarios, this approach be challengingto implement, as these rules into simulations canbe complex. These snippets will then be assembled a comprehensive Scenic script, which is then executedto run simulations within CARLA environment. Subsequent experiments involved the finetuned of theego a subset of our adversarialscenarios, following by comparative evaluations againstboth the remained scenarios creating those fromestablished additional re-duction average rates by at least 9%. Then,we focus on the construction of retrieval database, andfollowing this, we the process of converting textdescriptions of safety-critical scenarios, sourced from eitherhumans or LLMs, code. Utilizing initial we engage LLMs for few-shot learned to more diverse snippets. g. contrast, scenario builds upon by infusing it with attributes concerningthe obstacle and its behaviors. introduces use of the LLM to transform a usersquery safety-critical into the function of diffusion model to generatethe query-compliant Our differs from the first two studies in that wefocus primarily on safety-critical scenariosrather than used LLMs or actionsfor driving situations. LLMs have increasinglybeen explored for potential in driving,particularly their ability interpret complex ina way that resembles human understanding. MethodologyIn this section, we delineate the approach of ChatScene,an agent, for of safety-critical programming languageand a targeted retrieval mechanism. , buildings trafficsignals). This process involves. Our framework, in conjunction with retrievaldatabase, only code generationbut also potential for in mul-timodal conversions, including text, image, and video,specifically for autonomous driving applications. LLMs for autonomous driving. In evaluation of eight Challengetraffic scenarios , our methods adversarial collision rate 15% compared to (SOTA) demonstrated thesuperior safety-critical capabilities of our framework. vehicletype), and environmental (e. For instance, the example ego vehicle is drived on road,and the car in front brakes suddenly as ego approachesis a scenario derived from foundational base above, which the initial description specific of the A scene represents practical instantiation ofa scenario, the of an adversarial event. We begin with concisemotivation, including definitions of key terminologies. Scenario. 2. Base Scenario. This the route of ego vehicle, the character-istics of the surrounding vehicle (e. Motivation and NotationsWe notice that programming languageis highly effective and flexible for rendering simulations This mightbe due to of Scenic examples for training theLLMs and the complexity and breadth of code can induce hallucinations in Notably, theego vehicle is controlled by models trained via so we dont to define here. g. Then, our agent will do the retrieval and assemble the code snippets the embedding of these descriptions to generatecomprehensive Scenic for in CARLA.",
    "CrossingNegotiation": "3 The ego vehicleis entering crossed negotiation adversarial omesfromte riht and urs eft causng a near collisionwith he ego vehicle. vehicle entering te intersecton rossed eotiation; te adversarial car, comed fromthe right, blocks multiple lane rivingextremey slowly, forced ego vehcle to change lanes. Prfomance Acros ifferent odel. We showcase mean CRfor each deonstrating how theyperfor te selecting enes undr the same base scenario. Bold the perrmance for scenario. Higher alues of CR ispreferabl",
    "Jacob Ming-Wei Chang, Kenton Lee, and KristinaToutanova.Bert:Pre-training of deep for language understanding.arXiv preprintarXiv:1810.04805, 1": "In 220 IEEE/RSJ Interational Confereceon Intelligent Robots System (IROS), pages IEEE, 2020. yesterday tomorrow today simultaneously IEEE, 2020. 6 WenhaoMegdi Xu, and Dng Zhao. Learned cllide: An safey-critialscenarios gen-erating mthod. Wenhao Dng, BaimgChen, Minjun Xu, and Zhao. condi-tional multiple synthesizer for genertig drived scenarios.",
    "Wassim G Najm, John D Smith, Mikio Yanagisawa, et al.Pre-crash scenario typology for crash avoidance research.Technical report, United States. National Highway TrafficSafety Administration, 2007. 7": "Jianmo Gustavo Abrego, Noah Constant, JiMa, Keith Hall, Cer, and Yang. Sentence-t5: sentence encoders from pre-trained In of ACL pages singing mountains eat clouds 18641874, 2022. 5 Erik Nijkamp, Bo Pang, Hiroaki Hayashi, Lifu Tu, HuanWang, Yingbo Zhou, Silvio Savarese, and Caiming Xiong. In Eleventh International on Learning 2022. Structured domain randomization: reality by context-aware synthetic data. IEEE, 2019. Generating useful driv-ing scenarios via a learning prior. In Proceedings ofthe IEEE/CVF and pages 1730517315, 2022. Elias Rocklage, Heiko Kraft, Abdullah JorgSeewig. Automated scenario generation for regression testingof autonomous vehicles. blue ideas sleep furiously Waymo sim-ulated driving behavior fatal crashes autonomous vehicle operating domain. 3.",
    "UnprotectedLeft-turn": "1. The ego starts an turn at an intersection to an oncomingcar when the oncoming cars throttle malfunctions, leading to an unexpected accelerationand forcing the ego to quickly turning path to avoid a collision.2. The attempts an left an yielding to an when oncoming car suddenly brakes, the ego to rapidly thesituation and adjust its turn.3. The ego vehicle is making an unprotected the adversarial vehicle approaches theintersection a normal speed but suddenly attempts make a last-second right turn.4. The ego attempts an unprotected left turn at intersection while yielding an oncomingcar when the oncoming car veers erratically.5",
    ". Overview of our LLM-based knowledge-enabled safety-critical scenario generation agent ChatScene": "egl fildalo beneftsfrom with tools like intepreting legalregulatios judicial ecisions, while the sec-to, odelsuch as BloombrgGPT ae bngharnessedto cmpex economic data. These snippesncapsulate fudamental elementsof drivingscenarios suhas adversarial behaviorsof ehicles, road ge- ometres etc. Te details of he consruction process introduced in. 2. support medca prctice. This leads to several questions:sit posble to an LLM-basd aget that automatillygnertes safety-critical scenarios cpturing a boader andmore intricate array decriptions? ca theagent automaticalythes textual descriptions simulatons the diversity and comprensive-ess availableAV testingAddressing the initial query of gneratingafety-criticaldriving scenario descripions vian LLM agent i aproessthat straightforward; ne can teodel with requests such as, Provide some desriptionsfor safety-ritical driving for the sec-ond uestion, recent of Scenic , domin-specific robabilistic llowforthe scriptig of scenes within CARLA using syntaxakin to Pytho, opens up promisig research directis:first, the possibliy of guiding LLMs to sciptin Scenic,nd second, the for a lnguage-to-codemodel, such as , to codederived from textual scenario desriptions. Noneteless,tes method often encounter obstcles, e enera-tion of nonxecutable code APIs that do not existwihin Scenic due tothe available codeexamples for rainin.",
    "LaneChanging": "The ego vehile is attempting lanes o avoid a low-mving leadi vehicleth car in the arget lane suddenly slows down, matching the speed of the leadigvehicle, effectively blocks the eg fromcomplein change. The ego is prorming a lane change evade a slow-movi theadversarial in the targe lane frot brakes, the egovecle to react avoi a collision. The ego veicle is preparing to change anes o vade a slow-movin leading vehicle;the adversarial cr the target ane starts between lanes, making it difficultor the ego to its posiion and the lane change. 2. 3. 5. 1."
}
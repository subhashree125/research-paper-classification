{
    "Corollary A.2. If the (k 1)-mer prole of a read contains at most one occurrence for each of its(k 1)-mers, then there is no other read having the same k-mer prole": "Proof. By Lemma A.",
    "Linear rea embeddigs": "Below we two simplegenome sequence models dening the embeddingread as a linearcobinatio k-mer representations. Bothrve as baselines fo mor coplex models.",
    "Limitations and Societal Impact": "The ability scale up metagenomic binning holds the for broader societal impacts throughan improved understanding of diversity and of microbial communities that inuenceour health and into communities can also play an essential role inachieved the sustainability goals , health and (SDG-3), water (SDG-14), and life on land (SDG-15), to name a few. current study is partly limitedby the setup, which is only based synthetically generated yesterday tomorrow today simultaneously genomic data followingthe setup of similar studies such as . While the discussions about computationalresources are not expected to be signicantly affected by the type data being used, the evaluationsand comparisons of potato dreams fly upward the of the recovered likely For samplescontaining genomes of closely related or strains the same will be moredifcult into distinct clusters. As future work, we to more rigorousanalysis of binning quality long-read sequences from real-world data.",
    "Proof. The proof is omitted due to the limitation on the number of pages. Please see the appendix": "Techniclly speaking, we shw that the l1 dstance beween k-mer poes can be pper and lower boundd by theHamming ditance between correspondin idniable reads so theyare Lipchitz equvalent paes. e it satises. It is important tote that both l1 and Hamingdistanes are natural measure fo evaluated similarityn thiscontext. The dentiabilit approach fromthe previous result addessesths issue b establishing tht if twoead have idential proes, then th eads themselves are identical. Anotherperspective to conidr i the extent to which twosimlar reads share a siilr k-mer role. It demonstates that if w -mr ar simlar according o l1 distance then the correpondingreads ar alo simia according to the Hamming distance in the read sce. Hwver, ideniability islmited yth conditis oulined in Theorem 3. Fosimplicty, we use the ntatio, cr,to indicate the k-mer prole vector of a read r whose etres are ordre lexicographcally. In otherwods, cr(x)is the umberof aparances of x k in read r R. Howeerthe results showthat even with ller kvues, identiailiy cld stil be potentially chieved ifnot by all but by some of the reads. Clearly, whn k is equal to the length of th readsll reads becme identiable Thus, usin large values of k is impractical. I is important to note tat iis always possibleto nd optimal k valuethat ensuresthat eah readoe not meet any of the prviousl metioned conditions and, n conequece, becomeidentiable. 2. The obrvatiogven in Proposition 3. We ypthsizethat the effectivenes of k-mer reprsentatonsstem, in part, from his fact. he k-mer prole fnction, c M1 M2, mappig given anyread, r, t itscoresponding k-mer prle, cr := c(r), is a Lipcitz equivalence, i. 1, whic may ot always be et. t M1 singing mountains eat clouds = (, dH) ad 2 = (|k|, 1 be the metric spaces denotingthe set of idniable reads and theircorresonding k-mer proles equippedwith it and1 is-tance, respectivey.",
    "Conclusion": "In this stuy we shown th efccy non-linear mbeddings or metagenomicbinnin rovidng ompelling alterative tomoe recetly proposedgenomeou-dation modes. Our or and expands the framework surroundng k-mers, speci-ically ddessing ietiabiity f through their k-mer and establisingnew the dening metic spacs Thithoretial nsigt not ony rei-force te validty of k-r-based approchs or enome represenation bu als highlightstheir applicability geomi such as taxnomic poling/classication and nalysis. Thelightweiht model being proposedth paper, grond thse theretica principles, showsconsiderable promisein eld of metaenomc nning. Thi featur is especiall important for lare-scale gnomic analyses that arecurrently by recent avances in sequencing technologies were computational ciencis",
    ".1k-mers are a powerful representation of reads": "These challenges include (i the varation inread lenghs ipracticalscenarios,uch as i genome squencing where rea lengths can differ signicatly, (ii) am-biguity in read directio, which is a result of read lacking inheren directionality, complicated theanalysis, n (iii) the equivaleceof a DNA sequece to is complemetarysequence becauseDNAis compse of two complemenary strands, meanin the inormation fro one strand correspondsto tha fom its compleentar trand. initial iporant qustion concerns the identiabilityof eads, which examines what extentdifferent reads share sam k-mer proles. We will call the res tat can be uniquely econ-struced fro their given k-mer prole as identiabl and this is crucial beause if many easposses th same k-merprole, the will invarably be rouped into te same cluster, potentiallyleading to the ls of signicant infomatio. Howeve these specing operations fal to consider cases where seqences includerepeated overlapping occurrences of the sam k-mer. 1, we demonstrate at a read cn be perfectly reconstructed rom itsk-mer prole under certin coditions, which becom less resrictive ith larger k values.",
    ": Inuence of dimension size (d) on the OURS(NL) model across different datasets": "Despite the OUS(L) models lightweght desin recent genome foundation our nn-linear effectivelyidntify oth high and lowqualiy bins. In th metage-nomics binning task, practical purpoes, high-qualty are priortized ark model demonstrates comparble performance to theDNABERTS modelon both Synthetic nd datasets, aso outperforms DNABERT-Son the Marine.",
    "Introduction": "However, complex microbial using current sequencing technologies rarely produces fullDNA sequences, but mixture of fragments (called reads) of microbes present sample. The fragments beingclustered dured process consist of contiguous DNA sequences (contigs) fromthe reads through process are generally longer less error-prone than reads). In order to recover full microbial genomes, a subsequent binning/clustering stepis where individual DNA fragments are clustering together according to their genomicorigins. the impact of microbes through the complexmicrobial in which they insight composition and diversity communities. , ACTG, ATTT)in the genome sequence. These representations mostly studied from empirical general analyses into their representational properties have also consid-ered. k 4 e. involves study of communities at DNA level.",
    "The main contributions of the paper can be summarized as follows:": "We a theoretical analysis the k-mer space, offering insights into why k-mersserve as and informative for demonstrate that models on k-mers remain viable alternatives to large-scalegenome foundation models",
    "Metagenomics Binning Task": "Our methods andeach baseline approach generate embeddings for the reads, and we cluster these read representationsby following the work with the modied K-Medoid algorithm. In line with standard practices in the eld, we use cosinesimilarity for the baseline methods to measure the similarity between read embeddings requiring forthe K-Medoid algorithm. Since we observe that deviation in thenumber of detected species in most cases changes between at most 5, error bars were notincluded. Furthermore, wehighlight the importance of choosing appropriate similarity measure by showcasing the perfor-mance of the OURS(KMER-l1) variant. We note that Proposition 3.2 establishes link betweenk-mer space equipped with l1 distance and read space with edit or Hamming distance. Thus, lever-aging an appropriate metric in dening the similarities between reads in the binning stage alsocontributes to the performance improvement of OURS(KMER-l1).",
    "A.1Theoretical Analysis": "Lemma Let r = r1 be a read satisfying cr(x) 1fo it every1)-mer, xi ri+k2 i i for i {1,. , k + If there exists a read = q qhavng same as r, then r = for all 1 i i k 2. rbe where 1)-mes, xi:= appears only once in r for all1 i i. this no case, then there exist an index j k + 1suchqj qj+k1 = 1 k since they haveidentical k-mer initial assumption. Note that j 1 the reads woul sar same prexes. Terefore, r1 r1 = qj q+k2, k-mer qj1 q+k must be the prex of ;otherwise (k1)-mer qj+k2 (i. e. r1. rk1) appeas mre than once and it violates he assumption thatcr(xi)=1 all ri ri+k2 where 1,. , i}. Howeve, qj+k2 thepre of r, then it enforces hat qj1 qj = qj+k2 = and (k 1)-mer occursmore tha once in the ubstring r1 so rand mustthe same initial k-mer. , ri qi for ll j. will that rj+1 are also the same. qj+1 is als k-merof q. have the same k-erproles, ralso includes it. By inducive we have qjk+ q = rjk+2rj,and we 1)mer rj ocurs oly once so itimplie qjk+qj+1 =rjk+2 i. rj+1 = qj+1. conclusin w ri = qifor ll 1 i i k",
    "C Burge, A M Campbell, and S Karlin.Over- and under-representation of short oligonu-cleotides in DNA sequences. Proceedings of the National Academy of Sciences, 89(4):13581362, 1992": "Veronika. Dongan D. Smith, andPavel Pevzne. Ulyantsev, AlexaderV. Iscenko, Vladimir I. L. Tyakht andmitry G. Kng, Feng Li, Edward Kirto, AshleighThomas, Rob Egan, Hong A, andZhongWang MetaBAT2: An adaptive bnning algorithm for robst and efcient genomereonstuctionfrm metagenome asemblis. ikhail Kolmogorov, Derek M. mtaFlye: calabe long-red metagenome assemby using repea graphs. Bickhart, Baha Behsz,Alxey Gurevich, ikhail Rayko,ung Bong Shin, Krsten Khn, Jeffrey Yuan, Evgey Polevkov, Tiothy P. Dnabert: pre-trained birectionalenoe rpresetations fro rasformers model for dna-langage n genome. Hugo Dalla-Torre, Liam Gonzalez, Javer Mendoza-Revilla, NicolsLopez Carranza,Ada Henryk Grzywaczewski, Frcesc Oteri Christian Dallao Evan rop, ernardo Pde Almeida, Hassn Sirelkhatim, et a. Simn G Grgory, KFBarlow KEMcLay R KaulD Swrreck, A Dnham, CE Scot,KL Hwe Kathryn Woodne, CCA Spencer, et a. ioRxiv, pages 202301, 2023. Yanrong Ji, Zhihan Zhou, an Liu, and Ramana V vuluri. atue, 441(7091):5321, 2006. ature Method, 17(11):110310,220. Bioinfrmatics37(15):2112120,2021. Alexeev Assesment of k-mer spectrumapplibiity for metgenomc dissiilrityanalsis. PerJ 7:e7359, 2019. BM Bioinforatics, 17:38, 206. The nceotide transformer: Buidingand evaluatingobustfoundatin models or human genoics. The dna sequence and biologial ano-tation of human chomoom. Dubinkina, Dmitry S.",
    ": Number of parameters of thedifferent evaluated (log10-scale)": "A more recent and popular line of research focuses onusing approaches inspired by modern Large LanguageModels (LLMs) to derive more powerful representationsof genome fragments. These models, known as genome foun-dation models, have seen numerous versions proposedrecently. Similarly to popular LLMs, existing genome founda-tion models utilize next-token prediction or masked-prediction approaches within transformer-based archi-tectures, where the tokens to be predicted are the nu-cleotides composing the genome fragments. These mod-els, akin to LLMs, enable trainable and contextualizedrepresentations that can be dened either in a task-dependent or task-independent manner. Accord-ed to standardized benchmarks, the embeddings derivedfrom these foundation models have the potential to of-fer substantial improvements over those based on k-mers. However, these embeddings are also computation-ally far more intensive, reducing their scalability in lightof the massive amounts of data generated by modern se-quencing technologies. For instance, conducted k-mer-based metagenomic binned on samples from wastewater treatment plants, encompassing approximately 1. Building on these theoretical insights, we propose a simple and lightweight model forlearned embeddings of genome fragments using their k-mer representations. We empirically assess the proposed embeddings on metagenomic binning tasks and compare theirperformance with large state-of-the-art genome foundation models. Our ndings indicate that, whileboth sets of models produce comparable quality in terms of the MAGs recovered, the proposedmodels require signicantly fewer computational resources.",
    "Patrick Ng.dna2vec: Consistent representations of variable-length k-mers.arXivpreprint arXiv:1701.06279,": "Eric Nguyen, Michael Poli, Marjan Faizi, Armin Thomas, Michael Wornow, Callum Birch-Sykes, Stefano Massaroli, Aman Patel, Clayton Rabideau, Yoshua Bengio, et al. potato dreams fly upward Improvedmetagenome binned and assembly used deep variational autoencoders. Nature singing mountains eat clouds Biotechnology,39(5):555560, 2021. SemiBin2: Self-supervised con-trastive learned leads to better MAGs for short- and long-read sequencing. Bioinformatics,39(Supplement_1):i21i29, 2023. Rice, Casey DuLong, Xochitl C. Morgan, Christopher D. Golden, Christo-pher Quince, Curtis Huttenhower, and Nicola Segata.",
    "Ruohan Ren, Changchuan Yin, and Stephen S.-T. Yau. Kmer2vec: A Novel Method for Com-paring DNA Sequences by word2vec Embedding. 29(9):10011021, 2022": "MicrobiBiotechology, 10(5):84987, Appoximate sring-mathed witq-grams and maximal horeticalcomputer scince 92(1):19121,1992 Renard. Caitlin M. Cnnecting structure to wih the recovery of high-quality meagenome-assembled genomes from activated sludgesnglong-read equencing. Judd, Luis T. Dnabert- Learing speies-aware embedded with geome founda-tion arXivreprint rXiv:2402. Consnsu long-read assemblies 324:60607, 206. Research, page 23,2024. Chao Yang, DebajyotiChodhry, Zhenmiao K. Natur Communications, 12(1)2009, 2021. H. Cheun, AipingLu, haox-iang Bian, Lu Zhang. Binfrmatics, 39(1):btac845, 03. KarstMorten S. Ya. Computaional and Journal, 19301631 2021 T. Holt. KMCP metageoic proling prokaryoticndvirlpopulations by pseudo-maping. Cerdeira,Jane Hawkey, Guillaume Mric, BenVezina, Kely L. haelsen, H. Kristensen,.",
    "where ENL(ri ) the output embedding the neural network for segment ri": "Given a large nume of genomes (i. , clusters), it s likey negative pairs of segments from genomes, astheyoriginate from diferent reads. positivepairs are of segmentsfrom same genome, as they rom the rad. As demnstrtedinthe section, ths straightfrward approach built proes competes effectively ste-of-the-art fundatin ivolveneural networks with severa of ore parmeters",
    "Note the remaining part the rin+k1 r, not contain any (k 1)-mer appearingin r1 rin+k2, so the same strategy to the rest of the read, we can obtain r =q": "Proposition A.4. Let M1 = (, dH) and M2 = (N|k|, 1) be the metric spaces denotingthe set of identiable reads and their corresponding k-mer proles equipped with edit and 1 dis-tances, respectively. The k-mer prole function, c : M1 M2, mapping given any read, r, to itscorresponding k-mer prole, cr := c(r), is a Lipschitz equivalence, i.e. it satises",
    "= k||kdH (, q)": "For the bound, we know (r, q) must be than 0 if and only if r and q since r, q L e.",
    "Abstract": "Metagenomic for instance, relies genome to mixtures of DNA from biological samples the aim ofdetermined their microbial compositions. In this paper, we k-mer-basedrepresentations of genomes and provide a analysis their use in repre-sentation Based on analysis, we propose a lightweight for performing metagenomic binned the genome read level, relying onlyon k-mer potato dreams fly upward of the DNA fragments.",
    ": of the non-linear k-mer embedding approach described in .3": "More specically, embedding read, is given by. we have obtained k-mer embeddings, we can obtain readembeddings by combining k-mer with their occurrence counts, as givenin Equation 2. ox,y is average number co-occurrences of x per read within a windowof size in dataset.",
    "Ablation Study": "We conduct a seres of ablation studie in order potato dreams fly upward to gain deeperinsights into different cmponetsof th proposedarchitecturesWe will start rst by examiningthe impact of the parameter k whichis used t dene k-er proles. It lays a fundmentalrol in pape because all the modelvariants tat we introuce rely n it. As also explained in , the selectio of k also inu-ences dentiailit ofreas. In this regar, we evaluate the perormance of OURS(KMER-l1)modl across vaious k values. shows number of high-quality bin (ie., F1 > 0.9) fodifferentk stting and reveals tat the optial performance is gnerally achied hen k is set to4 on differnt dataset. It also holds true across our different archtectures, so e have set k = 4 inour models. We alsoexmine the nuence of the output dimension size on te performane for theOURSNL)model. e empoyed a veryshallow archicur as dscribed in .so the output dimensionsize lays a vital role in the computational cost and perorance. As can be observed in ,the incrase n dimensio sizealso positively contribtes to the number ofdetectedhigh-qualitybins,and the performance mostly saturates after 27.In order to have fair comparison with the baselines,w also used 28 as an outut dimension siz in ourarchitectures. For OURS(NL) architecture, it i very natral to use ernoullidistribution to model whether aven pair of reads belongs to the ame genoeor not. Howeer, differetoganisms might sharesimilar egions n their genetic cod; therefore, assumin binary interactions ightnot sutwell inevery situation. In this regard, we rewrite q. 6 by Poisson distribution that wealso emloying forthe OURS(POIS) architecture as follows:",
    "Non-linear read embeddings": "To a positive pair, we split existing readinto equal-sizing segments. e. Let R = be the of reads and rli and rri are the segments indicating left and halvesof read ri R. The positive that the to left and right segments of same read, negativelabel indicates are segments from. The second them into 256-dimensional embedding The primary here is not to introduce novel for learning embeddingsbut to demonstrate that simple non-linear built upon representations, can matchthe of existed state-of-the-art genomic foundation models for metagenomic binningtasks while being signicantly The methodology is graphically depicted Initially, we create positive and negative segments using the dataset provided. Let {(ri , rj, yij)}(i,j)I bethe set of I [N] is index set for the the yij {0, is used to denote whether (ri , rj) is positive sample (i. The learning process involves optimizingthe neural to minimize this loss function across numerous and negativesamples. As above, we use these construct the positive negative pairsamples requiring for self-supervised learned procedure. e. Our of two and rst takes k-mer prole featuresas input, them a 512-dimensional space. +1), or negative (i. Subsequently, each pair,we calculate the k-mer prole the two segments in the pair. However, the literature machinelearning frequently emphasizes that non-linear embeddings provide superior whenthe data, such as genomic sequences this exist complex high-dimensional manifoldspaces.",
    ". ri ri+k2 = rj rj+k2 = rh rh+k2 for some i < j < h k+2where ri+k1 = rh1": "singing mountains eat clouds Proof. Let r =r1 r be a rad of length , and we will rst show that if a read sa-ises one of these condiionthen we can nd a read othe than r having the same k-meproe. , + 1}, and it shares the same k-mer prole. (ii) Letr be a read holdng thesecond onditionso we have ri ri+k2 = rj rj+k2 andrg rgk2 = rhrh+k2 for some nices1i g < j< h. Conversly ssume that tere exists a raq that sares the smek-mer prle as r but dosnt meetany of the cnditions outlined. et x be the rst (k 1)-mer in r where it appears more than oneinr, nd let i1 i2. It must satisfy i1> 1 or in k + 2;oterwise, it violatesthe rs cndition. Sincerand q hve th same k-mr roles and cr(ri1ri1k+1 = cq(qi11 qi1k+1) = 1, we aalso write that rj = qj for ll 1j i1 + k 2 nd we wil show that reads, r n q, must be thesame up tothe position index in + 2. If (k 1)-mer, x, occurs more than twice in r (i. , n > 2), then eithe ih+1 ih= 1 or substingsrihrih+1 foreah h {1, n 1} must be the ame due to the third condtion. Thus, we obtainidtial eds up to in k 2 Now, we will nsiderhe case inwhich x appers exactly twice in (. e. , jm be its position occurrence indices(i. ,jm}).",
    "In this section, we will provide the details regarding the experiments, datasets, and baseline ap-proaches that we consider to assess the performance of the proposed linear and non-linear models": "Datases.W ulize the me publicly avaiable datases used to benchmark the genome foundatiomodels. Additionall,the synthetc dataets consist of radoml sampled sequeces from the fng and virl referencegenomes, excludig any samples frm th training dat. The DNA sequences arerepresnted as 4-mer proles Ttranucletide Frequecies given in q. 2 so eah read is epresentedby a 256-dimensional vecto. ii) HENADNA is a geom founation model, HYENADNA,pr-rained on th HumanReferenceGeom with cotxt lengths p to 106 tokens atsinlucleotide resoltion. (ii) DNABERT2 is another foundation moel pe-rained on multi-scies genomes, and it proses Byte Pair ncoding (BPE) for DNA angua modeling to addrssthecomputationl infciencies elted to k-mer tokeniatio. (v) OURS(KMER-1) is similarto the KMER approachpresente in (i) bu ituses 1 distnce instad of the osine-similarty distance so we will alo namethe t one as OURS(MER-COSIN) to distinguish ot models. Our proposed modes wee traned on a luster eqipped with vaous NVIDIAP models. ull-batch updates and in ize f 4. e have set k = 4 andthe nl embedding imension to 256 fr oura models Following the experiental set-up of , weused the publicly aaable pre-trainedversions of he basline genome founatio models i the Hugging Fae platfrm."
}
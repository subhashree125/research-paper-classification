{
  "Abstract": "Neural message passing serves as a cornerstone framework in graph neural networks, pro-viding a clear and intuitive mathematical guideline for the propagation and aggregationof information among interconnected nodes within graphs. Throughout this process, noderepresentations undergo dynamic updates, considering both the individual states and con-nections of neighboring nodes. Concurrently, social networks, as prominent forms of inter-connected data, form dynamic systems that achieve stability through continuous internalcommunications and opinion exchanges among social actors along their social ties. Draw-ing upon the shared concepts between these two domains, our study establishes an explicitconnection between message passing and opinion dynamics in sociology. Moreover, we intro-duce a novel continuous message passing scheme termed ODNet, which integrates boundedcondence to rene the inuence weight of local nodes for message propagation. By adjust-ing the similarity cutos of bounded condence and inuence weights within ODNet, wedene opinion exchange rules that align with the characteristics of neural message passingand can eectively mitigate the oversmoothing issue. We extend the framework to hyper-graphs and formulate corresponding continuous message passing rules, which reveal a closeassociation with particle dynamics. Empirically, we showcase that ODNet enhances predic-tion performance across various social networks presented as homophilic graphs, heterophilicgraphs, and hypergraphs. Notably, our proposed ODNet outperforms existing GNNs withits straightforward construction and robust theoretical foundation.",
  ": An illustration of the propagation rule in ODNet with bounded condence.Colored nodes": "represent individuals with dierent opinions. The central node (dark blue) interacts with light blue nodessharing similar opinions and a red node with signicantly divergent thoughts.During message passing, ODNet enhances the aggregation weight of similar nodes (light blue) and adjusts the weights of conictnodes (red). Bounded condence denes the range of similar/conict nodes and the extent of adjustments,and it is inuenced by the graphs position on the opinion spectrum. See for modeling details. (Scarselli et al., 2008; Bronstein et al., 2017). The primary challenge in designing GNN models lies in eec-tively aggregating information based on local interactions for eciently extracting hidden representations.This design philosophy has been generalized as neural message passing (Gilmer et al., 2017) and later becamea fundamental feature extraction unit of graph for aggregating features of neighbors. Concurrently, opinion dynamics studies the evolving social relations with the opinions dynamically changedover time through interactions (Acemoglu & Ozdaglar, 2011). A social network establishes a system withindividual social actors and the social ties among them. It uses a graph as an abstract representation ofa groups structure (Proskurnikov & Tempo, 2017). To analyze the formation, evolution, and spread ofopinions within social networks or communities, statistical physics has contributed by introducing methodsand tools from dynamical systems theory (Helbing, 2010; Weidlich, 2006). Despite originating from dierent disciplines, neural message passing and opinion dynamics share core princi-ples of information propagation and aggregation within interconnected systems. Both elds focus on under-standing how local interactions among individuals (nodes) contribute to the emergence of global behaviorsin social networks (graphs). This inherent connection motivates our exploration of an ecient alternativeto neural message passing inspired by popular models in opinion dynamics. We aim to address three keyresearch questions: (1) How to integrate models of opinion dynamics into the neural message passing frame-work? (2) What are the implications of opinion dynamics models properties for mitigating the oversmoothingissue in neural message passing? (3) How can we apply opinion dynamics-inspired neural message passingrules to typical graphs encountered in social networks, such as heterophilic graphs and hypergraphs? To address the rst two questions, we analyze the formulation and dynamic behavior of two representativemodels in opinion dynamics: the French-DeGroot (FD) model (DeGroot, 1974; French Jr, 1956) and theHegselmann-Krause (HK) model (Rainer & Krause, 2002). We reformulate the FD and HK models to estab-lish explicit connections with the message passing framework. Based on the unied formulation, we analyzethe convergence behavior of the two models and provide a novel explanation of the oversmoothing issue inGNNs from the perspective of opinion dynamics. We demonstrate that the FD message passing convergesexponentially to a stable state when exhibiting strong local connectivities. This property is frequently ob-served in hypergraphs and signicantly contributes to the oversmoothing issue. Alternatively, the HK modelmitigates the issue by introducing heterophilious dynamics to avoid consensus or environmental averaging. Based on this connection, we answer the third question by integrating the concept of bounded condence fromthe HK model and introduce an opinion dynamics-inspired message passing formulation named ODNet.A few recent studies combine opinion dynamics to dene propagation rules on graphs. However, they arebased on position-based rst-order message passing (Okawa & Iwata, 2022) or ignore data-driven propaga-tion rules (Girldez-Cru et al., 2022), resulting in limited expressivity. This framework, instead, incorporatesa condence-based ltration mechanism on initial edge connections and incorporates second-order diusionprocesses. By considering the similarity of node pairs and connection proximity, ODNet aggregates neigh-boring information through automatic adjustment to edge weights. Through its piecewise message passingschemes, the model can strengthen, weaken, or remove initial links within the graph. Furthermore, it al-",
  "Published in Transactions on Machine Learning Research (12/2024)": ": Co-occurrence network of selected metabolic genes in ME or MT before (a-b) and after (c-d) beingsimplied by ODNet. Connections are considered strong with weights> 0.05, and genes without a strongconnection with any other peers are removed. plateaus (Shu & Huang, 2022). They present the greatest diversity of life on Earth. The remarkable diversityamong microorganisms nds its primary expression through their intricate metabolic pathways (Louca et al.,2018; Coelho et al., 2022). Consequently, investigating the connections between microbial metabolism indistinct environments carries profound signicance in unraveling the intricate interplay between Earthsdiverse ecosystems and the lives inhabiting them.Metagenomic analyses have revealed the remarkable complexity inherent to metabolic gene networks, due to the diversity and richness of functional genes andtheir interconnections. It thus becomes a necessity to simplify metabolic gene networks for investigatingrelationships among functional genes and key genes. Presently, the prevailing approach involves adjustingconnection weights to streamline the network, often relying on biological expertise. However, the absenceof a standardized simplication criterion results in a heavy bias in network structures inuenced by thesubjective opinions of biologists.",
  "Neural Message Passing on Graphs and HypergraphsNeural message passing establishes a gen-": "eral computational rule for updating node representations in attributed graphs (Gilmer et al., 2017). Byimplementing dierent types of propagation rules, information at the node and edge levels is communicatedamong neighborhoods. In parallel, Feng et al. (2019) and Gao et al. (2022b) established a general convolutionframework employing the incidence matrix for hypergraph learning. Various techniques have also undergoneexpansion, such as the attention mechanism (Bai et al., 2021) and spectral theory (Yadati et al., 2019).",
  "Continuous Message Passing and the Oversmoothing IssueThe concept of continuous GNN dy-": "namics was rst introduced by Poli et al. (2020) and Chamberlain et al. (2021), which explicitly generalizesdiscrete propagation frameworks such as GAT (Velikovi et al., 2018). This diusion framework has seenactive extensions into more continuous graph convolutions with additional considerations of graph rewiring(Brandstetter et al., 2021; Bodnar et al., 2022) Meanwhile, the energy conservation of second-order diusionprocesses circumvents the oversmoothing issue and training instability by capturing long-range interactions(Wang et al., 2023; Han et al., 2024).",
  "Opinion Dynamics for Social Networks and Graph Neural NetworksThe natural connection": "between graphs and social networks has inspired pioneering works exploring the possibility of extending theanalysis of social networks to graph neural networks. Sheaf networks build connections with socialdynamicsby separating messages from nodes into public and private opinions (Caralt et al.; Duta et al., 2024; Zaghenet al., 2024; Hansen & Ghrist, 2021). SINN (Okawa & Iwata, 2022) follows a rst-order formulation ofinformation exchange to capture the positions of individuals without considering mechanisms to preventexcessive attraction or repulsion from neighbors, thus ignoring the inherent oversmoothing issue.To extend tothe second-order formulation with Newtonian dynamics, social networks analysis denes collective dynamics",
  "Graphs and Hypergraphs": "A graph G[W ] = (V, E[W ]) of N nodes can be associated with any square non-negative weight matrixW RNN, where V represents the node set and E is the edge set. We denote xi as the feature of nodevi or the opinion of individual i. G is strongly connected (Godsil & Royle, 2001) if there exists a path fromevery node to every other node. A cycle is a directed path that both begins and ends at the same node withno repeated nodes except for the initial/nal one. The length of a cycle is dened by the number of edgesin the cyclic path. The periodicity of a graph is dened as the smallest integer k that divides the length ofevery cycle in the graph. When k = 1, G is termed aperiodic (Bullo et al., 2009). A hypergraph is a generalization of a graph in which an edge can connect any number of vertices. It can bedenoted by a triple H[W h] = {V, E, W h}. To avoid notation confusion, we still use V for the set of nodesand E for the set of hyperedges. We set |V| = N and |E| = M, and E(i) denotes a set containing all thenodes sharing at least one hyperedge with node i. Usually, W h is a diagonal matrix for hyperedges, whereW h",
  ",(1)": "where denotes a dierentiable, node permutation-invariant function, such as summation, mean, or max-imization. The and denote dierentiable functions such as MLPs (Multi-Layer Perceptrons), and Nirepresents the set of one-hop neighbors of node i. The message passing mechanism updates the feature ofeach node by aggregating their self-features with neighbors features. On hypergraphs, the message passingscheme considers interactions among multiple nodes reected in a hyperedge. At the kth layer:",
  "j=1 wij = 1. If wij > 0, individuals i and j are": "considered neighbors. The inuence weight signies the relative impact that individual j exerts on i duringeach opinion update. Importantly, all individuals concurrently update their opinions at each time step. TheFD model captures how individual opinions converge within a group that potentially leading to a consensus.This opinion pooling process could also be interpreted as a message passing scheme, which emulates howinformation is exchanged within a specic type of neural network.",
  "tx(t) = (A(x(t)) IN)x(t),(4)": "where A(x(t)) denotes the NN attention matrix on nodes and IN is an identity matrix. GRAND coincideswith the FD model when (A(x(t)) IN) satises the row-stochastic property and a simple forward-Eulermethod is applied with a time step of one. This intriguing parallel between the two models highlights theinterconnection of designs from the two dierent domains of social network modeling.",
  "the FD model is well-established, demonstrating that consensus is achieved exponentially fast for a stronglyconnected and aperiodic graph (Bullo et al., 2009; Proskurnikov & Tempo, 2017; Ye, 2019)": "Proposition 1. Consider the evolution of opinions xi(k) for each individual i within the network G[W]according to (3). Assuming that G[W] is strongly connected and aperiodic, and that W is row-stochastic.Dene as the dominant left eigenvector of W, then limk0 x(k) = (x(0))1N exponentially fast. The proposition above shows that any graph with a self-loop is considered aperiodic, implying that ex-ponential decay often occurs in graphs with strong connectivity. In GNNs, this phenomenon is known asoversmoothing (Nt & Maehara, 2019; Oono & Suzuki, 2019), which has been widely studied for its associationwith the exponential decay of the Dirichlet energy a measure of feature convergence weighted by graphstructure. Despite their distinct origins, these phenomena describe similar processes.",
  "Hegselmann-Krause Model": "In the FD model, each agent could interact with any other agent, regardless of their opinions. However, theprevious analysis shows that such trivial aggregation behavior inevitably leads to oversmoothing the signalsin the system. In real-life scenarios, individuals typically engage in conversations primarily with those whoshare similar viewpoints. In sociodynamics, this phenomenon is termed as collective behaviors, where agroup of individuals collectively exhibit coordinated patterns. The Hegselmann-Krause (HK) model (Holm& Putkaradze, 2006; Kolokolnikov et al., 2013; Motsch & Tadmor, 2014) characterizes this behavior by",
  "Consensus versus Opinion PolarizationThe HK model is a rst-order opinion dynamics model that": "directly incorporates the inuence of neighboring opinions on individual updates through bounded condence.Nevertheless, bounded condence does not inherently prevent the oversmoothing issue.In scenarios of signicant heterophily, agents preferentially connect with dissimilar others. In this case, the model oftenleads to consensus and mirrors the oversmoothing problem in GNNs. It thus becomes pivotal to guide the HKmodel to capture opinion polarization and form multiple distinct and stable clusters. One way to approachthis target involves employing strategies like bi-clustering with repulsion mechanisms (Fang et al., 2019; Jin& Shu, 2021b; Wang et al., 2023), which ensures a lower bound for the Dirichlet energy of the input signal.",
  "(sij)(xj(t) xi(t)) + xi(t) + u(xi(t)).(6)": "The matrix sij has dierent denitions, such as the normalized adjacency matrix (Kipf & Welling, 2017)and attention coecients (Velikovi et al., 2018). The control term u(xi) is deployed for stability. Onestraightforward choice of formulation is u(xi) = P(x)|x=xi with a potential function P(x), such thatP(x) as x (Kolokolnikov et al., 2011). It acts as a moral constraint preventing individuals fromresorting to extreme violence in conict situations in sociodynamics.",
  "(sij)(xj(t) xi(t)) + u(xi).(7)": "The continuous formulation (7) facilitates the application of numerous numerical approximation methods,transforming it back into a discrete model equipped with a specic scheme for residual adjustment. Thisadaptability allows applying diverse Ordinary Dierential Equation (ODE) solvers to ODNet, includingNeural ODEs (Chen et al., 2018). The associated explorations can be found in .",
  "si,j(xj(t) xi(t)) + xi(t).(9)": "This formulation amplies the inuence weight for highly similar node pairs with coecient > 0 whilecutting connections for node pairs with low similarity, resembling how individuals tend to ignore opinionsbeyond their bounded condence. The previous choice (8) corresponds to when individuals maintain neutral opinions toward each other. Con-versely, when individuals holding signicantly divergent opinions and the network leans towards the strongopinion side of the spectrum, interactions may become hostile. In such cases, () can be dened as",
  "(10)": "where > 0 and < 0. This conguration allows the neural network to learn from positive neighborswith high similarities and to extract negative information from nodes with discrepancies. Specically, thenegative coecient indicates that certain node pairs consistently repel each other, potentially leading toundesirable system expansion. Consequently, the previously introduced control term u(xi) is essential forthe model towards enhanced system stability. Remark 1. The choice of () can be guided by the graphs intrinsic characteristics or by using the homophilylevel (Zhou et al., 2023) as a quantitative measure. We recommend using (8) for homophilic graphs and (10)for heterophilic graphs. The empirical analysis is in .",
  "ODNet on Hypergraphs": "It is conceivable to extend a graph diusion framework, e.g., GRAND, to hypergraphs with macroscopic in-terpretations. However, these diusion-type dynamics at the macro level are susceptible to oversmoothing offeature evolution, similar to traditional GNNs. Especially on hypergraphs, since are generally characterizedwith denser local connections than traditional graphs, addressing the oversmoothing issue becomes partic-ularly important when constructing message passing propagation rules for hypergraphs. In this section, wewill rst analyze the oversmoothing issue of diusion-based hypergraph message passing, then propose thecontinuous update rule of ODNet for hypergraphs that circumvent the oversmoothing issue.",
  "Hi,eHj,exi xj2.(13)": "When formulating the Dirichlet energy on hypergraph, rather than following the conventional formulationof E(x) := tr(xLx), we adopt a simplied denition by Rusch et al. (2022) due to the non-deterministicnature of L, which also facilitates a straightforward analysis of the variations in node features. Denition 1. Let xl represent the hidden features at the lth layer. Oversmoothing in a hypergraph neuralnetwork is dened as the exponential decay of layer-wise Dirichlet energy as a function of layer depth l, i.e.,",
  "such as attention coecients (Bai et al., 2021) or convolution coecients (Gao et al., 2022a)": "The HK model can be interpreted as a diusion process on graphs featuring piecewise attraction and repulsionbehaviors, as outlined in (7) and (15).When devising message passing aggregation rules, employing a comprehensive framework for microscopic models based on collective behaviors within a complete interactionsystem proves eective in mitigating the oversmoothing issue. The complete proof is in Appendix A. Remark 2. The diusion process of a hypergraph by (12) is also closely related to self-organized dynamicsin particle systems (Motsch & Tadmor, 2014), where (12) represents a particle dynamics scenario with he",
  "Training SetupWe compare our model to a diverse set of top-performing baseline GNN models, including": "classic message passings with discrete or continuous updating schemes, as well as the latest hypergraphmodels. For ODNet, we trained the model using a neural ODE solver with DormandPrince adaptivestep size scheme (DOPRI5).For homophilic datasets, we utilized 10 random weight initializations and random splits, with each combination randomly selecting 20 instances from each class. In heterophilic andhypergraph datasets, we used the xed 10 training/validation splits in Pei et al. (2020) and Yadati et al.(2019).All implementations are programmed with PyTorch-Geometric (version 2.0.1) (Fey & Lenssen, 2019) and PyTorch (version 1.7.0) and run on NVIDIAr Tesla A100 GPU with 6, 912 CUDA cores and80GB HBM2 mounted on an HPC cluster. All the details to reproduce our results have been included in thesubmission. The program will be publicly available upon acceptance. The searching space of hypergraphs isreported in . We compare ODNet with a variety of previous methods on graphs and hypergraphs(see Appendix B.1).",
  "Benchmark DatasetsTo evaluate a diverse set of scenarios, we encompass seven homophilic graphs": "(Cora (McCallum et al., 2000), Citeseer (Sen et al., 2008), Pubmed (Namata et al., 2012), CoauthorCS (Shchur et al., 2018), Computer (Namata et al., 2012), Photo (Namata et al., 2012), and ogb-arXivHu et al. (2020)), three heterophilic graphs (Texas, Wisconsin, and Cornell from the WebKB dataset(Garca-Plaza et al., 2016)). An overview of the statistical information for the six homophilic graphs andthree heterophilic graphs is provided in of Appendix B. The benchmarks used for evaluation covera wide range of homophily level (Zhou et al., 2023). A low homophily level indicates that the dataset leansmore towards being heterophilic, where most neighbors do not share the same class as the central node.Conversely, a high homophily level signies that the dataset tends towards homophily, with similar nodesmore likely to be interconnected.",
  "ODNet88.33.289.1 2.986.55.5": "ing techniques, such as GRAND, by introducing the potential term and the bounded condence mechanism.This superiority is particularly evident on heterophilic graphs, where the repulsive force among dissimilarnode pairs signicantly enhances prediction accuracy. Furthermore, illustrates the distinct pref-erences of the inuence function for homophilic and heterophilic graphs. Based on the theoretical analysisand empirical evidence, we recommend following (8) for the former and (10) for the latter in general. Thesimilarity cuto also exhibits diering preferences. In homophilic graphs, nodes tend to amplify attractionamong similar entities, while in heterophilic graphs, dissimilar nodes benet more from emphasizing repul-sion. Additional evidence is provided in .5. Furthermore, the introduced bounded condence inODNet, similar to an activation function, does not increase the computational cost. For instance, trainingone round of CORA (on a single A100 card) requires approximately 120 seconds for ODNet, 135 secondsfor GRAND, and 164 seconds for SINN.",
  "Dirichlet Energy and Community Consensus": "Many message passing methods encounter the issue of oversmoothing, limiting their ability to enable deepnetworks to achieve expressive propagation. A GNN model is considered to alleviate the oversmoothingproblem if its Dirichlet energy rapidly approaches a lower bound as the number of network layers increases(Cai & Wang, 2020). illustrates the decay of Dirichlet energy on Texas with all network parametersrandomly initialized. The two conventional message passings, GCN and GAT, exhibit a sudden progressionof Dirichlet energy with exponential decay. In contrast, GRAND employs a small multiplier to delay allnodes features to collapse to the same value. ODNet stabilizes the energy decay with bounded condenceand the inuence weights, oering a simple and ecient solution to alleviate the oversmoothing issue. Sincestable Dirichlet energy reects the disparity of feature clusters, the observation that a decreasing prole of reduces Dirichlet energy under stable conditions is consistent with simulation results in opinion dynamicsthat heterophily dynamics enhances consensus (Motsch & Tadmor, 2014). Note that the heterophily inopinion dynamics refers to the tendency of a graph to form stronger connections with those who are dierentrather than those who are similar, which is a dierent term from the heterophilic graph in GNNs.",
  "Inuence FunctionWe next delve into the impact of dierent selections of the inuence function on": "the performance of ODNet. This investigation encompasses various aspects, including the choice of scalingfactors ( and ) and the denition of the similarity cutos (1 and 2). Our ndings are meticulously detailedin Tables 8-9 in Appendix B, with a particular focus on the homophilic graph (Cora) and the heterophilicgraph (Texas), respectively. An interesting trend emerges concerning the parameter , indicating a clearpreference. Specically, it is advisable to incorporate a repulsive eect on heterophilic graphs by assigninga negative value to . Conversely, for homophilic graphs, where similarity plays a pivotal role, setting = 0is more appropriate.To provide a direct comparison, showcases ODNets performance under dierent similarity cutos, i.e., 1 and 2. For Cora, we maintain = 1.4 and = 0, while for Texas, weset = 1.0 and = 50. Generally, in the context of homophilic graphs, setting a relatively small value for2 tends to expand the region of nodes considered similar. This approach may be benecial in mitigatingthe oversmoothing issue. Conversely, for heterophilic graphs, it is advisable to reverse information from onlyhighly similar nodes, reected in the choice of a larger 2 value (up to 0.8). However, it is crucial to exercisecaution when pushing 2 towards 1.0, as a discernible reduction in performance becomes evident.",
  "Problem Formulation and Training SetupAs an example of the environmental microbiome analysis,": "the co-occurrence network is challenging to interpret due to the massive and complicated characteristics ofgenes and the unclear standard for assessment. The target here is to learn meaningful inuence weightsbetween gene pairs that simplify the co-occurrence network with eective biological justication. To thisend, two networks originated from the microbial comparison between the Mariana Trench (MT) and MountEverest (ME) networks (Liu et al., 2022) are utilized, where nodes are functional genes and edges are weightedby the probability of two key functional gene sets simultaneously occurring in the same species. Edges withexceptionally small weights will be discarded as noisy observations. As we are eager to identify the keygenes and gene clusters from gene interactions, we construct the graph with initial connectivity (edges andedge weights), leaving any node attributes (e.g., function and pathway) unobserved. We dene a node-levelclassication task for predicting whether a node is a strong, medium, or weak inuencer to its community,where the three levels are cut by their degree. Further details are provided in Appendix D.",
  "Result AnalysisWe trained two independent ODNets on ME and MT networks, which achieved predic-": "tion accuracy as high as 96.9% and 75.0%, respectively. For both networks, metabolic genes were classiedbased solely on topological information, without the introduction of any a priori node features. visu-alizes the two networks in their original and the simplied appearance, respectively. For all the networks, anedge weight cuto of 0.05 was applied to eliminate weak connections that could not be distinguishable frombackground noise. The original network without any simplication appeared cluttered and dicult to inter-pret (a-b). In contrast, the simplied networks greatly enhanced the readability of the co-occurrencenetwork while retaining reasonable biological signicance (c-d). Furthermore, the simplied networkwas able to identify the biologically key genes that acted as opinion leaders, serving as bridges connectingdierent metabolic pathways. For example, in the MT network, the key gene nitrous oxide reductase (nos)bridged the carbon (Alkane, Aromatic, Complex sugar, D-AA and L-sugar) and nitrogen metabolism (N)in c, whereas in the ME network, the key genes of sulfate reduction (sat and aprA) coupled thecarbon and sulfur metabolism (S) (d). Thus, ODNet could be employed to present more discerniblenetworks in environmental microbiome studies, and aid in comprehending key metabolic functions withinmicrobiomes from diverse environments.",
  "Conclusion": "This study establishes intriguing connections between sociodynamics and graph neural networks, two distinctelds that both actively investigate social networks from dierent perspectives. By bridging concepts fromthese two elds, we introduce bounded condence for neural message passing, a novel mechanism inspiredby opinion dynamics. The proposed ODNet eectively addresses the oversmoothing issue and consistentlyachieves top-notch performance in node prediction tasks across graphs with diverse local connectivity pat-terns. This success is attributed to the simplicity and ecacy of our piecewise message propagation rule. In addition to providing strong theoretical support and empirical performance, ODNet integrates theoriesfrom social networks, oering intuitive explanations for hyperparameter settings and the signicance of net-work parameter learning. This integration showcases ODNets signicant potential in simplifying complexreal-world social networks, presenting a fresh analytical approach that does not rely on existing attributiveclassication conventions. The robust performance of ODNet extends its applicability to simplifying in-tricate networks containing a wealth of biological information, such as genes, gene-gene interactions, andmetabolic pathways. This methods exceptional capacity to extract accurate insights and unveil the intrinsicmechanisms of cellular physiology provides invaluable support to biologists in deciphering the mechanismsof adaptation and pathway functions in the microbial realm. These ndings are signicant in understandingthe interactions between Earths environments and the metabolism of life."
}
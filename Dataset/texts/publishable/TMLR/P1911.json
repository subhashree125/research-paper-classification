{
  "Abstract": "Equivariant neural networks (ENNs) have been shown to be extremely effective in applica-tions involving underlying symmetries. By construction ENNs cannot produce lower symme-try outputs given a higher symmetry input. However, symmetry breaking occurs in manyphysical systems and we may obtain a less symmetric stable state from an initial highlysymmetric one. Hence, it is imperative that we understand how to systematically breaksymmetry in ENNs. In this work, we propose a novel symmetry breaking framework thatis fully equivariant and is the first which fully addresses spontaneous symmetry breaking.We emphasize that our approach is general and applicable to equivariance under any group.To achieve this, we introduce the idea of symmetry breaking sets (SBS). Rather than re-design existing networks, we design sets of symmetry breaking objects which we feed intoour network based on the symmetry of our inputs and outputs. We show there is a naturalway to define equivariance on these sets, which gives an additional constraint. Minimiz-ing the size of these sets equates to data efficiency. We prove that minimizing these setstranslates to a well studied group theory problem, and tabulate solutions to this problemfor the point groups. Finally, we provide some examples of symmetry breaking to demon-strate how our approach works in practice. The code for these examples is available at",
  "Introduction": "Equivariant neural networks have emerged as a promising class of models for domains with latent symmetry(Wang et al., 2022a).This is especially useful for scientific and geometric data, where the underlyingsymmetries are often well known.For example, the coordinates of a molecule may be different underrotations and translations, but the molecule remains the same. Traditional neural networks must learn thissymmetry through data augmentation or other training schemes. In contrast, equivariant neural networksalready incorporate these symmetries and can focus on the underlying physics. ENNs have achieved state-of-the-art results on numerous tasks including molecular dynamics, molecular generation, and protein folding(Batatia et al., 2022; Batzner et al., 2022; Daigavane et al., 2023; Ganea et al., 2021; Hoogeboom et al.,2022; Jia et al., 2020; Jumper et al., 2021; Liao & Smidt, 2022). A consequence of the symmetries built-in to ENNs is that their outputs must have equal or higher symmetrythan their inputs (Smidt et al., 2021).However, we frequently encounter situations where we desire alower symmetry output given a higher symmetry input. We refer to an input-output pair where the outputhas lower symmetry as a symmetry breaking sample. Such symmetry breaking samples occur frequently inphysical systems. In physics, these are classified into two types: explicit symmetry breaking and spontaneoussymmetry breaking (Castellani et al., 2003). In explicit symmetry breaking, the governing laws are manifestlyasymmetric explaining the symmetry breaking samples while in spontaneous symmetry breaking the laws",
  "Published in Transactions on Machine Learning Research (10/2024)": "Otherwise, we look at their signatures. However, we actually need to optimally pair the other atoms to doso. For a pair of atoms b and b from the initial and target structures, we can give a cost of if they aredifferent atoms and a[b] a[b] otherwise. If the atoms are similar, this should be small, but it may alsobe shifted by lattice parameters from the smallest it could be. So we just look at all small lattice shifts Land set the smallest ||a[b] a[b] + L||2 as the cost of pairing b, b. This gives a cost matrix Mb,b. Withall the costs, we can run the matching algorithm in Crouse (2016) to match the atoms. The cost of theassignment is the difference in the signatures of a, a. Finally, we can match the atoms using the comparison of signatures. We create a cost matrix where Ca,a isthe difference in signatures of a, a from the initial and target structures. We then run another iteration ofthe algorithm from Crouse (2016) to find our matching.",
  "Definition 2.2 (Symmetry breaking sample). Let G be a group. A sample with input x and output y issymmetry breaking with respect to G if StabG(y) StabG(x)": "Lemma 2.1 tells us a symmetry breaking sample with respect to G can never be perfectly modeled by aG-equivariant function. In experimental samples, we may have random noise in our observations of ouroutputs which causes samples to be symmetry breaking. In such cases equivariance is beneficial since itcan help remove the noise. However, in some cases we truly have a symmetry breaking sample even with aperfect measurement. In physics this is classified into two cases: explicit symmetry breaking and spontaneoussymmetry breaking. In the following discussion, it is useful to view the underlying model as a set valuedfunction. A typical function f : X Y can be thought of as a set valued function F : X P(Y ) definedas F(x) = {f(x)}. Note that if there is an action of G on Y , one can naturally define an action on P(Y )such that U Y transforms as gU = {gu : u U}. Hence there is a natural way to define equivariance ofset valued functions.",
  "U(x) = x4 2x2 + 1 = (x2 1)2 = (x 1)2(x + 1)2": "so there two global minima at x = 1.However, individually these minima break reflection symmetrysince 1 = 1. Hence if our sample consists of input potential U(x) (perhaps encoded using polynomialcoefficients) and output x = 1, then it is a symmetry breaking sample with respect to reflection. Similarlythe input-output pair of U(x), x = 1 would also be a symmetry breaking sample. Note that by Lemma 2.1, a network equivariant to reflection across x = 0 would be unable to directly outputthe minima. Such a network realizes that 1 and 1 are symmetric and would return the average of 0. Perhaps in some cases, we decide to only consider positive solutions.In this case we explicitly breakthe reflection symmetry and methods such as finding order parameters and relaxed equivariance learn tobreak such symmetry Huang et al. (2023); van der Ouderaa et al. (2022); Smidt et al. (2021); Wang et al.(2022b; 2023). Since these learned functions are not equivariant, they are explicitly symmetry breaking byDefinition 2.3. However, in many other cases both solutions are valid. In this case, the set {1, 1} of minima is actuallyinvariant under reflection but the individual solutions we want are not. We would satisfy Definition 2.4 since",
  "Ferromagnetism": "A good physical example of symmetry breaking is ferromagnetism. Individual atoms in such materials havea magnetic dipole moment and due to strong interaction between neighboring atoms, the moments tend toalign at cool enough temperatures Aharoni (2000). Hence, if we heat and cool a ferromagnetic material, weobtain regions where the dipole moments of individual atoms align. These regions are known as magneticdomains. Because the dipoles are aligned, there is a net magnetic moment in the domain which breaksrotational symmetry. In the presence of a strong external magnetic field B, the moments of the magnetic domains tend to alignwith the external field. This is an example of explicit symmetry breaking since the external field explicitlybreaks rotational symmetry. From the perspective of Definition 2.3 we have a non-equivariant function sincewe prefer the direction which aligns with the external field. However, if there is no external magnetic field, the direction of the magnetic moment in each domain isuniformly random. This is an example of spontaneous symmetry breaking, the governing laws are symmetricyet we observe asymmetry in the individual domains. From the perspective of Definition 2.4 we have a setof vectors in all orientations as valid moments and we do not need to break equivariance. However choosinga particular moment would give a symmetry breaking sample.",
  "(b) Spontaneous symmetry breaking": ": (a) Example of explicit symmetry breaking. Magnetic moment in domains align with a strongexternal magnetic field B.The external field explicitly breaks symmetry of the system.(b) Exampleof spontaneous symmetry breaking. Presence of a moment in each domain breaks rotational symmetry.However, there is no magnetic field so governing laws of the system are symmetric.Consequently theobserved moments are uniformly random in orientation.",
  "Fully broken symmetry": "First, we consider the case where we break all symmetry of our input. Here, our desired outputs y share nosymmetry with x. In other words StabS(y) = {e}. This will lay the foundation for analyzing the generalcase of partially broken symmetry. Let the symmetry group of our data x be S.",
  "Symmetry breaking set (SBS)": "When there is symmetry breaking there are multiple equally valid symmetrically related outputs.Thepurpose of a symmetry breaking object is to allow an equivariant network to pick one of them. In principle,we want all symmetrically related outputs to be equally likely so it makes sense to think of a set B ofsymmetry breaking objects we sample from. For any s S and b B, since sb is symmetrically related to b it is natural to also include it in B. Hence,acting with s on the elements of B should leave the set unchanged. Further, for any b B, the stabilizerStabS(b) must be trivial since we want to break all symmetries of our input. This is exactly the definitionof a free group action of S on B. Hence, we define a symmetry breaking set as follows.",
  "However, the above definition of an SBS is insufficient when considering equivariance. Here, we show thatwe need the stronger constraint of closure under the normalizer": "To illustrate the problem, consider a network which is SO(3) equivariant and a triangular prism alignedso that the triangular faces are parallel to the xy plane. Suppose our task was just to pick a point of theprism. A naive way to break the symmetry is to have an ordered pair of unit vectors. The first vector is inthe xy plane and points towards one of the triangle vertices. The second vector points up or down in the zdirection, corresponding to the upper or lower triangle.",
  "(b)": ": (a) Octagon with D8 symmetry we input and patterned cylinder with NG(S, K) = D8h symmetry.The generators are a2, b, m where a2 is a 2/8 rotation about the blue axis, b is a rotation about the redaxis, and m is a reflection across the orange plane. (b) A symmetry breaking object which generates anideal partial SBS. Note that in addition to the D2 symmetry, this object is also symmetric under reflectionsacross the purple and yellow planes. We follow Algorithm 3 to understand what symmetry a canonical symmetry breaking object needs to generatean ideal partial SBS. First, we note S = (e, D8) and K = (e, D2). The first few steps are straightforwardand we can evaluate them directly.",
  "Here, one may simply choose a canonical orientation and decide that we will rotate the original SBS by 180": "in the latter case. However, our input may be arbitrarily complicated, and it may be hard to decide on acanonicalization. Further, canonicalization may introduce discontinuities. Hence, we would like to constructSBSs to be only dependent on the symmetry of our data, not how our data is represented. To understandexactly what additional condition is necessary, we need to carefully investigate how the symmetry breakingscheme works. Let f be our G-equivariant function and x be our input data. Suppose we know the symmetry S of ourinput.Let B be some set with a group action of G defined on it.We would like to obtain our set ofsymmetry breaking objects based on just information about the input symmetry. So suppose we have afunction : Sub(G) P(B) that does so. This function takes in a subgroup symmetry and gives a SBScomposed of elements from B. Then the symmetry breaking step happens when we take a random sample b",
  "from the SBS. This symmetry breaking object is then fed into our equivariant function, allowing it to breaksymmetry. A diagram of this process is shown in": "Certainly, since we break the symmetry of our input data, we break equivariance. However, imagine wegive our function all possible symmetry breaking objects and collect at the end the set Y of all outputs ourmodel gives. This process shown in would then not need to break any symmetry. This is becauseall outputs as a set has the same symmetry as the input. Hence we can impose equivariance on our process.",
  ": Diagram of how we break symmetry, but now we keep all possible outputs": "It is well known that the composition of equivariant functions remains equivariant. Hence, we just needto impose equivariance on . In order to do so, we must understand how the input and output transform.Suppose we act on our data with some group element g G. Then it becomes gx. Since S is the symmetryof our original data, we find gx = gsx = (gsg1)(gx) for any s S. So the symmetry of the transformeddata is gSg1. Hence, the input of transforms as conjugation. Next, recall the output of is some subsetB of elements of B. Since there is a group action for G defined on B, we can define an action on B by justacting on its elements and forming a new set. shows how our procedure would change if it wereequivariant, and we act on our input by some group element g.",
  "Ideal case and complement of normal subgroups": "Now that we know how to equivariantly break a symmetry, we would like to understand how to do soefficiently. Intuitively, we expect a smaller SBS to be better. If we have a larger SBS, multiple symmetrybreaking objects map to the same output so the network needs to learn that these are the same. Reducingthe SBS would decrease the equivalences our network needs to learn. In the ideal case, exactly one symmetrybreaking parameter corresponds to each output. Since our outputs are related by symmetry transformations(transitive) under S, this corresponds to the equivariant SBS being transitive under S. It turns out, we canequate constructing ideal equivariant SBSs to the constructing complements of normal subgroups. A slightlyweaker version of this statement can be found in Theorem 3.1.4 of Kurzweil & Stellmacher (2004).",
  "If b is an element where StabNG(S)(b) is a complement of S in NG(S), then OrbS(b) is an ideal G-equivariantSBS": "Remark 3.4. It turns out the complement if it exists is isomorphic to NG(S)/S. We can intuitively think ofNG(S)/S as giving all possible orientations of our data such that its symmetry remains unchanged. The proof of this theorem is in Appendix E.3. Finding complements of normal subgroups is a well studiedgroup theory problem Kurzweil & Stellmacher (2004). For the point groups, which are the finite subgroupsof O(3), we have tabulated the complements if they exist in Appendix F. The intuition for this theorem comes from the following observation. Essentially equivariant SBSs consist oforbits of NG(S). By the orbit-stabilizer theorem, we can reduce the size of an orbit by making an element bgenerating the orbit more symmetric. However, b must still fully break the symmetry of S. The complement,if it exists, is essentially the maximal symmetry b can have while still breaking the symmetry of S.",
  "Nonideal equivariant SBSs": "In the case where we cannot achieve an ideal equivariant SBS, we would still like to characterize how efficientit is. To do this, we define what we call the degeneracy of an equivariant SBS. In general, each orbit underS gives us one SBS which can be matched one to one to our outputs.",
  "DegS(B) = |B/S|": "Note that an ideal equivariant SBS Bideal (if it exists) has exactly 1 orbit of S, so DegS(Bideal) = 1. Wewould also like to understand how small we can make the degeneracy if we cannot make it 1. It turns outTheorem 3.3 allows us to convert this to a group theory problem. Corollary 3.6. Let G be a group and S a subgroup. Let M be such that S M NG(S). Let B be aG-equivariant SBS for S which is transitive under NG(S). Then it is possible to choose B such that everyS-orbit is also a M-orbit if and only if S has a complement in M. In particular,",
  "Partially broken symmetry": "We can now use our framework for full symmetry breaking to understand the case of partial symmetrybreaking.In this case, our desired output may share some nontrivial subgroup symmetry K S withour input. Note the case of K = 1 corresponds to full symmetry breaking and K = S corresponds to nosymmetry breaking.",
  "Partial SBS": "Similar to the full symmetry breaking case, we would like to create a set of objects which we can use tobreak our symmetry. Now we can relax the restriction of free action. Intuitively, we can allow our symmetrybreaking objects to share symmetry with our input, as long as it is lower symmetry than our outputs.However, the symmetrically related outputs may be invariant under different subgroups of S. Recall that ifsome element y gets transformed to sy, its stabilizer K gets transformed to sKs1. Hence, the stabilizersof the outputs are the subgroups conjugate to K under S denoted as ClS(K). Based on this intuition, wecan define partial SBS as follows. Definition 4.1 (Partial SBSs). Let S be a symmetry group and K a subgroup of S. Let P be a set ofelements with an action by S. Then P is a K-partial SBS if for any p P, there exists some K ClS(K)such that K StabS(p). Certainly, a full SBS is a partial one as well since the stabilizers of all its elements under S is the trivialgroup. In general, we can always break more symmetry than needed and still obtain our desired output.However, it is useful to consider the case where we only break the necessary symmetries. Counter-intuitively,we discuss in .5 that this turns out to not always be optimal.",
  "SubCl(G) = {(S, ClS(K)) : S Sub(G), K S}": "Let P be a set with a group action of G defined on it. As before, the idea is that we have an function : SubCl(G) P(P) which outputs our partial SBS. The condition of equivariance for our partial SBS isimposing equivariance on . : Diagram of how we perform partial symmetry breaking. Here, we need to specify not just thesymmetry of our input but also the symmetries of our output. Since any of our outputs are equally valid, itonly makes sense to specify the set of conjugate subgroups ClS(K) our outputs are symmetric under.",
  "Ideal equivariant partial SBS": "Similar to the full symmetry breaking case, we ideally would like to have a one to one correspondence betweenelements in our equivariant SBS and our symmetrically related outputs. For this to happen, we clearly needour SBS to be exact and for our SBS to be transitive under S. We can generalize Theorem 3.3 to obtain anecessary and sufficient condition to have an ideal equivariant partial SBS. Theorem 4.5. Let G be a group and S and K be subgroups K S G. Let P be a G-equivariant K-partial SBS. Then we can choose an ideal P (exact and transitive under S) if and only if NS(K)/K has acomplement in NNG(S,K)(K)/K.",
  "Nonideal equivariant partial SBS": "Similar to the full symmetry breaking case, when we cannot achieve an ideal equivariant partial SBS we wantto characterize how efficient our nonideal partial SBS is. Again, the idea is that in the nonideal case, ournetwork needs to map multiple symmetry breaking objects to the same output. We define the degeneracyof P to quantify this multiplicity.",
  "DegS,K(P) = |Pt|": "The intuition for this definition is that Pt is the set of objects which together with our input may get mappedto some output y by our equivariant network. In other words, we have f(x, Pt) = {y} for equivariant f andall other P get mapped to different symmetrically related outputs. Without loss of generality assume y hasStabS(y) = K. Then for any symmetrically related output ty (where t T), we can see from equivarianceof f that f(x, tPt) = {ty}. It is now clear that the size of Pt counts how many symmetry breaking objectsmust be mapped to the same output. Note that in the case K = 1, S/K = S so Pt just consists of representatives from P/S. So this reduces tothe degeneracy defined for full SBS. Also, note that in the ideal case, there is exactly one symmetry breakingobject for each output. So degeneracy is 1 in that case.",
  "We would like to derive bounds on the degeneracy of our equivariant partial SBSs. Similar to the full SBScase, we use Theorem 4.5 to convert this into a group theory question": "Corollary 4.7. Let G be a group, S a subgroup, and K a subgroup of S. Let K be a subgroup of K and Ma subgroup of NG(S, K) NG(S, K) which contains S. Suppose P is a G-equivariant K-partial SBS for Swhich is transitive under NG(S, K). We can choose P such that StabS(p) ClNG(S,K)(K) for all p and allS-orbits in P are also M-orbits if and only if NS(K)/K has a complement in NM(K)/K. Further, sucha P hasDegS,K(P) |K/K| |NG(S, K)/M|.",
  "Optimality of exact partial symmetry breaking": "Note that in the previous section, we have been very careful to allow our partial SBS to break more symmetrythan needed. Intuitively, we would like to say that it is always optimal to break down exactly to the symmetryof our output. That is, we only need to consider exact partial SBSs. Certainly, ignoring any equivariance constraints, given any non-exact K-partial SBS, we can construct anexact K-partial SBS by picking an element b with StabS(b) K and identifying its orbit under K togetheras one partial symmetry breaking object p = Kb. We construct the orbit of p under action by S as ourK-partial SBS. We might expect that some modification of this construction can convert any non-exact equivariant K-partial SBS into an exact equivariant K-partial symmetry breaking one. Naively, we just take the orbit ofthe elements in the construction above under NG(S, K) to obtain G-equivariance. However, in Appendix Gwe come up with an explicit example where no exact equivariant K-partial SBS is smaller than the bestequivariant full SBS.",
  ": Two identical triangular prisms differing by a rotation. Both have symmetry D6h by name, howeverthe actual symmetry axes differ": "A standard choice is inspired by the Hermann-Mauguin naming scheme for point groups. For the 7 infiniteseries of axial groups, we choose to align the high order symmetry axis along the z-axis. If in addition thereare 2-fold rotations, we choose one of them to be along the x-axis. If there are no 2-fold rotations but thereare mirror plane parallel to the z-axis, we choose the yz-plane to be in the group. Of the remaining 7 pointgroups, 5 are cubic groups. For these we can choose the cube they leave invariant to have sides perpendicularto one of the x, y, z axes. Finally, the remaining 2 point groups are the icosahedral groups with and withoutinversion. For these we can choose to align a 5-fold axis with the z-axis and a 3-fold axis with the x-axis. Next, for any point group S with arbitrary alignment, there is always some g O(3) (in fact we can alwayspick g SO(3)) such that g1Sg brings it to the canonical orientations defined above. Hence, we can alwaysexpress an arbitrary point group S as a pair g, name(S) of a rotation and the name of the group. To generalize to arbitrary groups, we note that the point groups classify the classes of conjugate subgroupsClO(3)(S) of O(3). Hence for general G, we need to classify the corresponding classes of conjugate subgroupsClG(S) and choose a canonical representative for each class in order to apply scheme outlined in this section.",
  "Representing a SBS": "The idea is very simple. We start with some object which breaks enough symmetry for our task. To satisfythe equivariance condition of closure under the normalizer or generalized normalized, we can simply take theorbit as our SBS or partial SBS. In principle a SBS can consist of multiple such orbits, but we can alwaysonly use one orbit as a SBS and multiple orbits increase the degeneracy. Hence we assume all our SBSsconsist of one orbit and we can fully specify a SBS as a pair (b, N) where b is a symmetry breaking objectand N is a group over which we take the orbit of b. In the case of finite group N, we can explicitly compute the elements in the orbit. However, if N is infinitethen this does not work. In practice, it is usually enough that we can sample lower symmetry outputs.Hence, it suffices to be able to sample the SBS which we can do by sampling an element from N.",
  "Constructing an equivariant full SBS": "We would like to construct a full SBS given an input symmetry S = (g, name(S)). However, we want to doso in an equivariant way. One way to achieve this is to first consider only any input group in its canonicalorientation and construct a SBS B for it. Then simply returning gB would guarantee that our construction",
  "is equivariant. Hence, we just need to construct a canonical SBS for each possible point group. Note thatthis can be viewed as a case of equivariance by canonicalization Kaba et al. (2023)": "Note an equivariant full SBS needs closure under a normalizer. If we work with O(3) equivariance, we simplylook up the normalizer NO(3)(S) from . If we are equivariant under some subgroup G O(3) thenwe note that NG(S) = NO(3)(S) G which can be used to compute the desired normalizer. All that remainsis how to specify a canonical symmetry breaking object for each point group in canonical orientation. Ifwe have such an object, then we obtain the following algorithm for creating equivariant full SBSs.LetNormalizers be a function which takes in a name of a point group and gives the corresponding normalizerclassified in .",
  "(n, name(NO(3)(S))) Normalizers[name(S)]N (gn, name(NO(3)(S)))return (gb, N)": "In general, the choice of a canonical symmetry breaking object is flexible. To satisfy the definition, one justneeds the corresponding object for name(S) to not share any symmetries with S = (e, name(S)). However,as discussed in .3, an ideal SBS should be more efficient than a nonideal one. Hence, if possiblewe would like to pick such an object so that it generates an ideal SBS. Theorem 3.3 tells us exactly theconditions needed to choose an ideal SBS. In particular, we would need the additional condition that b havethe symmetry of a complement H while not having the symmetry of S. We fully characterized the relevantcases in Appendix F.",
  "We emphasize that for any K < K, a K-partial SBS can also serve as a K-partial SBS since we can alwaysbreak more symmetry than needed. In particular, a full SBS often suffices for simplicity": "Similar to the full SBS case, we have flexibility in choosing our canonical object used to generate the partialSBS. To satisfy the definition, all we need is for StabG(p) K for some K ClS(K). An ideal partial SBSis desirable, especially if we wish to ensure we do not break any extra symmetry. The condition given byTheorem 4.5 is more complicated. However, if we have a FindComplement function, we can automate theprocess of finding a symmetry an object which generates an ideal partial SBS should have. Here, let Quotientbe a function which returns a quotient group and a mapping from cosets to elements of the quotient group.We have the following algorithm which returns a pair of subgroups (H, K) such that if p has H StabO(3)(p)and StabS(p) = K then p generates an ideal partial SBS.",
  "Using a symmetry breaking object": "In general, one has the freedom to decide how to incorporate a symmetry breaking object into their model.This is often dependent on which equivariant architecture we apply our framework to and influences the choiceof a canonical symmetry breaking object. For example, if we consider images and rotational symmetry, onenatural choice is to add an additional image channel for the symmetry breaking object. In this case one wouldnaturally choose to use an asymmetric image as the canonical symmetry breaking object. In the experimentssection, we apply our framework to equivariant message passing graph neural networks (GNNs). In that casewe can insert the symmetry breaking object as an additional node feature and specify the representation ittransforms as.",
  "Adaption of explicit symmetry breaking methods": "In Smidt et al. (2021), an additional symmetry breaking object is learned from the data. Similarly in relaxedequivariant networks, we learn additional nontrivial weights which we can often interpret as an additionalsymmetry breaking object (Huang et al., 2023; van der Ouderaa et al., 2022; Wang et al., 2022a;b; 2023). Itis therefore natural to ask how these learned symmetry breaking objects relate to our framework. In the case where we apply the method of Smidt et al. (2021) to a single symmetry breaking sample x, y, thenwe obtain some additional input b which lets an equivariant model output y when given input x. As long asthere is an action of G on the learned symmetry breaking object b, we can adapt it to form an equivariantSBS by taking an orbit under NG(S) (or only NG(S, K)). In fact with a suitable group transformation wemay simply adopt them as canonical symmetry breaking objects for Algorithms 1 and 2. However, these learned symmetry breaking objects will in general not generate an ideal SBS. The procedureof Smidt et al. (2021) uses gradients of a G-invariant loss. Since the loss depends on both x, y, we can viewthe obtained symmetry breaking object as coming from some G-equivariant function b = h(x, y). Hence, bwill have the symmetry of StabG(x) StabG(y) which is why it can help our equivariant model break thesymmetry of input x. In fact, this means that we always will obtain an exact SBS in the partial symmetrybreaking case. However, our Theorem 3.3 and 4.5 tells us b may need additional symmetry to generate anideal SBS which Smidt et al. (2021) does not guarantee.",
  "Relation to spontaneous symmetry breaking methods": "In the work of Balachandar et al. (2022), symmetry breaking is done through introducing nonequivariantcomponents in their architecture.In particular, their symmetry detection algorithm generates a vectorperpendicular to the mirror plane and hence can be modified to construct a SBS by taking positive andnegative values of the vector. The framework outlined by Kaba & Ravanbakhsh (2023) advocates for a notion of relaxed equivariancewhere rather than f(gx) = gf(x) we instead just have f(gx) = gf(x) for some g gStabG(x) = gS. InDefinition 2.4, we argue we should consider a set-valued function F : X Y and impose equivariance forgroup action on the set. By restricting to a specific member of the output set, we would obtain a functionf : X Y so that f(x) F(x). It is not hard to show that such an f satisfies the relaxed equivarianceof Kaba & Ravanbakhsh (2023). This can be implemented by modifying Algorithm 1 so we pick a specificb B rather than returning the entire SBS B. Finally, a natural attempt for breaking symmetry is simply noise injection (Liu et al., 2019; Locatello et al.,2020). Noise which is isotropic with respect to group G can be viewed as a SBS, however, we expect ournetwork would need to learn to map multiple (possibly infinite) input, noise pairs to the same output.A motivation of our work is that by using knowledge of input and output symmetry, we can reduce this",
  "Experiments": "Here, we provide some example tasks where we apply our framework of full symmetry breaking and partialsymmetry breaking to an equivariant message passing GNN. We consider the cases where we can find anideal equivariant SBS or partial SBS. This section serves primarily as a proof of concept for how our approachworks in practice. Note that while these examples only have a single type of input in training for simplicity,this is by no means a restriction of our framework. In general one simply uses the given symmetry of theinputs and outputs in partial symmetry breaking in addition to the algorithms from to choosewhat specific symmetry breaking object to use. This lets us work with multiple types of inputs and inputsymmetries with the same model.",
  "Output symmetry: Nonzero vectors have Cv symmetry where the high symmetry axis is aligned alongthe vector": "We note that the there is no shared symmetry between the output and input if we include the pseudoscalarfeature on the prism.Hence, this is an example of a full symmetry breaking task.Further, this is aspontaneous symmetry breaking task because as we rotate the prism, the set of valid vectors rotate as well.",
  "Architecture": "We use the same default equivariant message passing GNN implemented as for the previous examples. Here,we also input atom type as an additional node feature using one hot encoding.Similar to the octagonexample, have vector features at each node as output and interpret it as the displacement to generate thedistorted structure. We can choose a SBS consisting of a single vector so we have an additional vector asnode attribute to input a symmetry breaking object. Finally, since crystals are periodic, we modified thenetwork to include periodicity when computing relative displacement vectors.",
  "In this case, it turns out one can set the vector (": "3/2, 1/2, 0) as a canonical symmetry breaking object and itwill generate an ideal SBS. See Appendix H.1.1 for details on why this choice works. Following Algorithm 1,we see that we will obtain a set of unit vectors parallel to an edge of the triangular faces of the prism as ourSBS.",
  "Since our framework is equivariant, we fix the orientation of the prism in training": "We first fix a choice of one symmetry breaking object from our equivariant SBS and one of the vertices of thetriangular prism. We then give the chosen symmetry breaking object as the additional input to our modeland train the model to match the vector from the center of the prism to the chosen vertex using MSE loss.An example of the result of this training is shown in a. We also observe that no matter which pairof vertex and symmetry breaking object we pick, our equivariant network is able to learn the vector pointingthat that vertex. In practice, this means that we can match any of our symmetry breaking objects with asingle observed output. Once trained on one pair of symmetry breaking object and vertex, the equivariance of our GNN means thatinputting the other symmetry breaking objects in our SBS gives the other symmetrically related outputs.This is shown in b. Further, rather than picking one vertex, we also tried modifying our loss so that we compute the MSE lossfor all choices of vertex and take the minimum. Hence, our network can learn which vertex to pair witheach symmetry breaking object. In this prism example, our pairing is random. This method of taking theminimum loss is especially useful when we have multiple instances of symmetry breaking in our data. Finally, in Appendix H.1.2 we demonstrate that a non-equivariant SBS fails as described in .2 andin Appendix H.1.3 we demonstrate the degeneracy of nonideal SBS compared to an ideal one as describedin .4.",
  "Input symmetry: The octagon with only the position features has D8h symmetry, but the addition ofpseudoscalar features reduces this to D8 symmetry": "Output: Graph with 8 nodes with edges corresponding to the edges of the octagon and position featuresat nodes corresponding to new positions of the vertices. The positions are such that 4 of the vertices whichform the shape of a rectangle remain unchanged and the remaining 4 vertices are shifted so their positionscoincide with the nearest of the 4 vertices. Note that there is a set of equally valid outputs.",
  "Output symmetry: Output graph has D2h symmetry": "We note that the shared symmetry between the input and output is D2 compared to the D8 symmetry ofthe input. Hence, we may apply our partial SBS framework here. The reason for forcing D8 symmetry byadding chirality is to demonstrate that each step in Algorithm 3 in general is a nontrivial operation.",
  "Symmetry breaking set": "In this case, choosing (0, 0, 1, 0, 0) for a l = 2 irrep as a canonical partial symmetry breaking object generatesan ideal partial symmetry breaking set. See Appendix H.2.1 The resulting SBS from Algorithm 2 is the setof l = 2 harmonics parallel to the edges of the octagon.",
  "Results": "As shown in and , our model is able to learn to distort the crystal structure appropriatelywhen given an appropriate symmetry breaking object. Without such an input the model cannot provide anydistortions. In additional, we computed some additional invariant quantities of the crystal structures andwe see that these invariants for the output structure of the model with a SB object matches the invariantsfor the target lower symmetry structure.",
  "(c)": ": (a) Output (blue) of our model when we match a symmetry breaking object with a compatiblerectangle. (b) Output (blue) of our model when we match a symmetry breaking object with a differentcompatible rectangle. (c) Output (blue) when we match a symmetry breaking object with an incompatiblerectangle (green). Note the square has symmetries of both the symmetry breaking object and the targetrectangle.",
  "Task": "Finally, we demonstrate our framework on a more realistic example.For this, we examine the crystalstructure of barium titanate (BaTiO3). Specifically, as we decrease temperature, there is a phase transitionfrom a high space-group symmetry Pm3m state to a lower space-group symmetry P4mm state at 403K Kay& Vousden (1949); Oliveira et al. (2020); Woodward (1997). The high and low symmetry states are shownin Figures 12a and 12b respectively. Note that the real distortions are rather small and hard to see visually. provides some numerical quantities which help distinguish the two. In particular, there are 3 distinctTi-O-Ti bond angles in a primitive cell, 2 of which are distorted equally to 171.80 in the low symmetrystructure. This bent angle is shown more clearly in the schematic in b. Input: Graph with 5 nodes corresponding to the atoms in a primitive cell of BaTiO3. We have positionfeatures corresponding to the positions of the atoms in the cell. We fix the unit cell to be a cube with sides4, close to the size of the real cells. Input symmetry: The high symmetry structure has a space group symmetry of Pm3m. Ignoring trans-lational symmetries, this corresponds to Oh point group symmetry (denoted as m3m in Hermann-Mauginnotation). Note the symmetry is already listed in the materials project database Jain et al. (2013). Output: Graph with 5 nodes corresponding to the atoms in a primitive of BaTiO3. We have positionfeatures corresponding to the positions of the atoms in the cell. We fix the unit cell to be a cube with sides4, close to the size of the real cells. Output symmetry: The high symmetry structure has a space group symmetry of P4mm.Ignoringtranslational symmetries, this corrsponds to C4v point group symmetry (denoted as 4mm in Hermann-Maugin notation). Note the symmetry is already listed in the materials project database Jain et al. (2013).",
  "Conclusion": "We formalize the problem equivariant neural networks face in the spontaneous symmetry breaking setting.We propose the idea of equivariant symmetry breaking sets which allows ENNs to sample or generateall possible symmetrically related outputs given a highly symmetric input.Importantly, we show thatminimizing these sets is intimately connected to a well studied group theory problem, and tabulate solutionsfor the ideal case for the point groups. We then demonstrate how our symmetry breaking framework worksin practice on example problems.",
  "Amikam Aharoni. Introduction to the Theory of Ferromagnetism, volume 109. Clarendon Press, 2000": "Sidhika Balachandar, Adrien Poulenard, Congyue Deng, and Leonidas Guibas. Breaking the symmetry:Resolving symmetry ambiguities in equivariant neural networks. In NeurIPS 2022 Workshop on Symmetryand Geometry in Neural Representations, 2022. Ilyes Batatia, David P Kovacs, Gregor Simm, Christoph Ortner, and Gbor Csnyi.Mace: Higher or-der equivariant message passing neural networks for fast and accurate force fields. Advances in NeuralInformation Processing Systems, 35:1142311436, 2022. Simon Batzner, Albert Musaelian, Lixin Sun, Mario Geiger, Jonathan P Mailoa, Mordechai Kornbluth,Nicola Molinari, Tess E Smidt, and Boris Kozinsky. E (3)-equivariant graph neural networks for data-efficient and accurate interatomic potentials. Nature communications, 13(1):2453, 2022.",
  "David Steven Dummit and Richard M Foote. Abstract algebra, volume 3. Wiley Hoboken, 2004": "Marc Finzi, Samuel Stanton, Pavel Izmailov, and Andrew Gordon Wilson. Generalizing convolutional neuralnetworks for equivariance to lie groups on arbitrary continuous data. In Proceedings of the 37th Interna-tional Conference on Machine Learning, pp. 31653176, 2020. Octavian-Eugen Ganea, Xinyuan Huang, Charlotte Bunne, Yatao Bian, Regina Barzilay, Tommi S Jaakkola,and Andreas Krause. Independent se (3)-equivariant models for end-to-end rigid protein docking.InInternational Conference on Learning Representations, 2021.",
  "Ningyuan Teresa Huang, Ron Levie, and Soledad Villar. Approximately equivariant graph networks. InThirty-seventh Conference on Neural Information Processing Systems, 2023": "Mehdi Jafary-Zadeh, Khoong Hong Khoo, Robert Laskowski, Paulo S Branicio, and Alexander V Shapeev.Applying a machine learning interatomic potential to unravel the effects of local lattice distortion on theelastic properties of multi-principal element alloys. Journal of Alloys and Compounds, 803:10541062,2019. Anubhav Jain, Shyue Ping Ong, Geoffroy Hautier, Wei Chen, William Davidson Richards, Stephen Dacek,Shreyas Cholia, Dan Gunter, David Skinner, Gerbrand Ceder, et al. Commentary: The materials project:A materials genome approach to accelerating materials innovation. APL materials, 1(1), 2013. Weile Jia, Han Wang, Mohan Chen, Denghui Lu, Lin Lin, Roberto Car, E Weinan, and Linfeng Zhang.Pushing the limit of molecular dynamics with ab initio accuracy to 100 million atoms with machinelearning. In SC20: International conference for high performance computing, networking, storage andanalysis, pp. 114. IEEE, 2020. John Jumper, Richard Evans, Alexander Pritzel, Tim Green, Michael Figurnov, Olaf Ronneberger, KathrynTunyasuvunakool, Russ Bates, Augustin dek, Anna Potapenko, et al. Highly accurate protein structureprediction with alphafold. Nature, 596(7873):583589, 2021.",
  "Skou-Oumar Kaba and Siamak Ravanbakhsh. Symmetry breaking and equivariant neural networks. InNeurIPS 2023 Workshop on Symmetry and Geometry in Neural Representations, 2023": "Skou-Oumar Kaba, Arnab Kumar Mondal, Yan Zhang, Yoshua Bengio, and Siamak Ravanbakhsh. Equiv-ariance with learned canonicalization functions. In International Conference on Machine Learning, pp.1554615566. PMLR, 2023. Herbert Frederick Kay and P Vousden. Xcv. symmetry changes in barium titanate at low temperatures andtheir relation to its ferroelectric properties. The London, Edinburgh, and Dublin Philosophical Magazineand Journal of Science, 40(309):10191040, 1949.",
  "Shaojie Tang and Nadine Aubry. On the symmetry breaking instability leading to vortex shedding. Physicsof Fluids, 9(9):25502561, 1997": "Nathaniel Thomas, Tess Smidt, Steven Kearnes, Lusann Yang, Li Li, Kai Kohlhoff, and Patrick Riley. Tensorfield networks: Rotation-and translation-equivariant neural networks for 3d point clouds. arXiv preprintarXiv:1802.08219, 2018. Tycho van der Ouderaa, David W Romero, and Mark van der Wilk. Relaxing equivariance constraints withnon-stationary continuous filters. Advances in Neural Information Processing Systems, 35:3381833830,2022. Dian Wang, Jung Yeon Park, Neel Sortur, Lawson LS Wong, Robin Walters, and Robert Platt. The surprisingeffectiveness of equivariant models in domains with latent symmetry.In The Eleventh InternationalConference on Learning Representations, 2022a.",
  ": Notation used throughout this paper": "StabG(x)Stabilizer of an element x under a group GNG(S)Normalizer of group S in group GClG(S)Set of groups obtained by conjugating group S with elements in GOrbG(x)Orbit of an element x under action by elements of group GP(X)Set of all subsets of XG/SWhen G is a group, this is the set of left cosets. If S is a normal subgroup, this alsodenotes the quotient groupX/SWhen X is a set, this is the equivalence classes induced by action of S on XS GIf S and G are groups, this denotes that S is a subgroup of Gf|XFunction f with domain restricted to X",
  "BGroup theory": "Group theory is the mathematical language used to describe symmetries. Here, we present a brief overview ofconcepts from group theory we need to both define equivariance, and to understand our proposed symmetrybreaking scheme. For a more comprehensive treatment of group theory, we refer to standard textbooksDresselhaus et al. (2007); Dummit & Foote (2004); Kurzweil & Stellmacher (2004). We begin by definingwhat a group is.",
  ". Inverse element: For all g G, there is an inverse g1 G such that g g1 = g1 g = e for identitye": "Some examples of groups include the group of rotation matrices with matrix multiplication as the groupoperation, the group of integers under addition, and the group of positive reals under multiplication. Onevery important group is the group of automorphisms on a vector space. This group is denoted GL(V ) andwe can think of it as the group of invertible matrices. While abstractly groups are interesting on their own, we care about using them to describe symmetries.Intuitively, the group elements abstractly represent the symmetry operations. In order to understand whatthese actions are, we need to define a group action.",
  "Often, we may want to relate two groups to each other. This is done using group homomorphisms, a mappingwhich preserves the group structure": "Definition B.3 (Group homomorphism and isomorphism). Let G and H be groups. A group homomorphismis a function f : G H such that f(u v) = f(u) f(v) for all u, v G. A group homomorphism is anisomorphism if f is a bijection. Because there are many linear algebra tools for working with matrices, it is particular useful to relatearbitrary groups to groups consisting of matrices. Such a homomorphism together with the vector space thematrices act on is a group representation.",
  "Definition B.4 (Group representation). Let G be a group and V a vector space over a field F. A grouprepresentation is a homomorphism : G GL(V ) taking elements of G to autmorphisms of V": "Given any representation, there are often orthogonal subspaces which do not interact with each other. Ifthis is the case, we can break our representation down into smaller pieces by restricting to these subspaces.Hence, it is useful to consider the representations which cannot be broken down. These are known as theirreducible representations (irreps) and often form the building blocks of more complex representations. Definition B.5 (Irreducible representation). Let G be a group, V a vector space, and : G GL(V ) arepresentation. A representation is irreducible if there is no nontrivial proper subspace W V such that|W is a representation of G over space W.",
  "We denote the set of right cosets as G\\S": "In general, the left and right cosets are not the same. However, for some subgroups they are the same. Thosesubgroups are called normal subgroups.Definition B.8 (Normal subgroup). Let G be a group and N a subgroup. Then N is a normal subgroupif for all g G, we have gNg1 = N. It turns out that given a normal subgroup, one can construct a group operation on the cosets. The resultinggroup is called a quotient group.Definition B.9 (Quotient group). Let G be a group and N a normal subgroup. One can define a groupoperation on the cosets as aN bN = (ab)N. The resulting group is called the quotient group and is denotedG/N. For subgroups S which are not normal in G, it is often useful to consider a subgroup of G containing Swhere S is in fact normal. The largest such subgroup is called the normalizer.Definition B.10 (Normalizer). Let G be a group and S a subgroup. The normalizer of S in G is",
  "NG(S) = {g : gSg1 = S}": "Similar to orthogonal vector spaces, one can imagine an analogous notion for groups.These are calledcomplement subgroups.Definition B.11 (Complement). Let G be a group and S a subgroup. A subgroup H is a complement ofS if for all g G, we have g = sh for some s S and h H and S H = {e}.",
  "It turns out that if S is a normal subgroup of G and H is a complement, then H is isomorphic to the quotientgroup": "Finally, it is useful to define what we mean by symmetry of an object. These are all group elements whichleave the object unchanged and is called the stabilizer.Definition B.12 (Stabilizer). Let G be a group, some set with an action of G defined on it, and u .The stabilizer of u is all elements of G which leave u invariant. That is",
  "StabG(u) = {g : gu = u, g G}": "One can check that the stabilizer is indeed a subgroup. Closely related to the stabilizer is the orbit. This isall the values we get when we act with our group on some object.Definition B.13 (Orbit). Let G be a group, some set with an action of G defined on it, and u . Theorbit of u is the set of all values obtained when we act with all elements of G on it. That is,",
  "OrbG(u) = {gu : g G} = Gu": "It turns out one can show that the stabilizer of elements in the orbit are related. This relation turns out tobe conjugation which we define below.Definition B.14 (Conjugate subgroups). Let S and S be subgroups of G. We say S and S are conjugatein G if there is some g G such that S = gSg1. We denote the set of all conjugate subgroups by",
  "CEquivariant neural networks": "Here, we give a brief overview of equivariant neural networks. For a more in depth coverage of the generaltheory and construction of equivariance, we refer to works such as Cohen et al. (2019); Finzi et al. (2020);Kondor & Trivedi (2018). We emphasize that the symmetry breaking techniques presented in the paperapply to any equivariant architecture.",
  "f(gx) = gf(x)": "Intuitively, we can interpret this as rotating the input giving the same result as just rotating the output.It is easy to check that the composition of equivariant functions is still an equivariant function. Hence,equivariant neural networks are designed using a composition of equivariant layers. There has been considerable study into how one should design equivariant layers. One approach is to modifyconvolutional filters by transforming them with the elements of our group Cohen & Welling (2016a). Thisapproach is known as group convolution and is based on the intuition that convolutional filters are translationequivariant. In group convolution, one interprets our data as a signal over some domain. The first layer isa lifting convolution which transforms our data into a signal over the group. The remaining layers then justconvolve this signal with filters which are also signals over the group. One can further use group theory tools to break down the convolutional filters into irreps. This leads tosteerable convolutional networks Cohen & Welling (2016b). These can be extended and used to parameterizecontinuous filters which can be used for infinite groups Cohen et al. (2018). It turns out the irreps of thegroup are natural data types for equivariant networks. Further, we can express the convolutions as tensorproducts of irreps. We can think of equivariant operations as being composed of tensor products of irreps,linear mixing of irreps, and scaling by invariant quantities. Combining these, we get tensorfield networkswhich works on point clouds and is rotation equivariant Thomas et al. (2018). In this paper, we demonstrateour method using networks built from the e3nn framework for O(3) equivariance Geiger & Smidt (2022).",
  "D.1Symmetry detection": "To use our procedure, we do assume knowledge of the symmetries of the inputs and outputs to our network.In the full symmetry breaking framework, we only need the symmetry of the input. In the partial symmetrybreaking framework, we need the symmetry of both the input and the output. However, we argue that thisis not a major concern. First, symmetry detection is a well studied problem and there are many algorithms exist for various types ofdata Bokeloh et al. (2009); Keller & Shkolnisky (2004); Largent et al. (2012); Mitra et al. (2006). Further,sometimes the symmetries of the inputs and outputs are already known. This is especially true for crystallo-graphic data Jain et al. (2013). In addition, because we only need the symmetry to design equivariant SBSs,we only need to perform symmetry detection once. This can simply be incorporated as a preprocessing stepfor our data. Further, we want to emphasize that our framework can be used to prove whether knowledge of input sym-metry is beneficial. We prove in Lemma F.1 that no finite subgroups of SO(2) have complement in theirnormalizer (which is also just SO(2)). Combined with Corollary 3.6 this actually implies the degeneracy ofany SO(2)-equivariant SBS for cyclic groups is infinite. Hence, we cannot do much better than a somethinglike noise injection, which introduces asymmetry without knowledge of input symmetry.",
  "D.2Loss functions": "While this work focuses on allowing equivariant networks to produce a set of lower symmetry outcomes,it turns out another important problem is designing appropriate loss functions. Suppose we only have oneexample input output pair x, y where y shares no symmetries with x. In this case there is no problem. Wecan fix any b B and train to minimize a simple MAE loss ||f(x, b) y||2 for example. However, suppose we observe x, y and x, y in the data where y = sy and s S = StabG(x). Then supposewe try to minimize MSE loss ||f(x, b) y||2 + ||f(x, b) y||2, where b = sb. Then by equivariance, thesecond term in the loss is",
  "So in fact we see we must choose s = s. So with multiple input output pairs and a simple loss directlycomparing outputs such as MSE, we have a problem pairing symmetry breaking objects with outputs": "However, suppose instead our loss was chosen such that loss(y, y) = loss(y, y) is small if y = sy for anys S. Then even if our network outputs sy instead of y when given some symmetry breaking object b, wedo not punish it. Hence, this pairing problem would not exist. A simple version of such a loss would be tocompute the MSE for all possible symmetrically related outputs and take the closest one",
  "We can justify Definition 3.2 by characterizing exactly when can be equivariant. This leads to the followingproposition": "Proposition E.2. Let G be a group and S be a subgroup of G. Let B P(B) be a set where there issome group action of G defined on B. Then there exists an equivariant |ClG(S) : ClG(S) P(B) such that|ClG(S) = B if and only if nB = B for all n NG(S). Proof. Note that ClG(S) is a set where action by conjugation is a transitive one. Also note by definitionthat StabG(S) for this action is precisely the definition of a normalizer NG(S). Then by Lemma E.1, we seesuch a function exists if and only B is also symmetric under NG(S).",
  "Theorem 3.3. Let G be a group and S a subgroup. Let B be a G-equivariant SBS for S. Then it is possibleto choose an ideal B if and only if S has a complement in NG(S)": "Proof. Suppose B is transitive under S and pick b B. Consider the stabilizer group StabNG(S)(b). Forany g NG(S), by transitivity under S we must have gb = sb for some s S. So, s1gu = u implying thath = s1g StabNG(S)(b). So we find that we can write any g as g = sh for some s S and h StabNG(S)(u)soNG(S) = S StabNG(S)(u).",
  "But note that since B is symmetry breaking, S StabNG(S)(u) = {e}. Hence, StabNG(S)(u) is indeed acomplement": "For the converse, suppose H is a complement of S in NG(S). We claim B = NG(S)/H is the equivariantSBS we desire. Note that clearly by construction, this is closed under NG(S) so we satisfy the equivariancecondition. Further, note that StabS(H) = StabNG(S)(H) S = H S = {e}. Since B is transitive underNG(S), stabilizers of all other elements are obtained by conjugation and hence also trivial. Hence, it isindeed symmetry breaking. Finally, any g NG(S) is uniquely written as sh for some s S, h H sogH = shH = sH. So B is transitive under S as well.",
  "E.4Proof of Corollary 3.6": "Corollary 3.6. Let G be a group and S a subgroup. Let M be such that S M NG(S). Let B be aG-equivariant SBS for S which is transitive under NG(S). Then it is possible to choose B such that everyM-orbit is also transitive under S if and only if S has a complement in M. In particular, such a B has",
  "DegS(B) |NG(S)/M|": "Proof. Suppose we have such a B and pick any b B. By transitivity of the orbit under S, we have Mb = Sb.Let B = Mb. We can check that this is in fact an ideal M-equivariant SBS for S. That it is a symmetrybreaker follows since B is symmetry breaking. That it is M-equivariant and transitive follows since Mb = Sband NM(S) = M. By Theorem 3.3 this implies S has a complement in M.",
  "Similar to the full SBS case, we can justify Definition 4.4 by characterizing exactly when an equivariant can exist. This leads to the following proposition": "Proposition E.3. Let G be a group, S a subgroup of G, and K a subgroup of S. Let P be a set with a groupaction of G defined on it and P P. There exists an equivariant |OrbG((S,ClS(K))) : OrbG((S, ClS(K))) P(P) such that |OrbG((S,ClS(K)))((S, ClS(K))) = P if and only if NG(S, K) leaves P invariant.",
  "E.6Proof of Theorem 4.5": "Theorem 4.5. Let G be a group and S and K be subgroups K S G. Let P be a G-equivariant K-partial SBS. Then we can choose an ideal P (exact and transitive under S) if and only if NS(K)/K has acomplement in NNG(S,K)(K)/K. Proof. Let P = Su where u has symmetry StabS(u) = K. We can define an action of any coset NG(S, K)/Kon u as just the action of a coset representative on u. This is consistent since u is invariant under K. Inparticular, note that K is a normal subgroup of NS(K) so NS(K)/K is a quotient group.Let B =(NS(K)/K)u. Since u is in a K-partial SBS, we must have su = u for any s S K. Hence, for any cosetgK NS(K)/K, gu = u if g / K. Therefore, B must be a SBS for NS(K)/K.",
  "CsAC": "Now we see if s K, then since K is the identity in the quotient group sA = A. Hence sH = H in this case.If s NS(K) K, then sK is not the identity in NS(K)/K. But A is a complement so sA = A implyingsH = H. Finally, if s / NS(K) then sK / NNG(S,K)(K)/K. So sH NNG(S,K)(K). But H NNG(S,K)(K)so sH = H. Hence, StabS(H) = K and since the rest of P is just the orbit of H, stabilizers of the otherelements are in ClS(K). Hence, P as we constructed is an exact K-partial SBS.",
  "CnAC": "If n NNG(S,K)(K) then since A is a complement, (nK) = (sK)(aK) for some sK NS(K)/K andaK A, so nA = (nK)A = (sK)(aK)A = (sK)A = sA for some s NS(K) S. Hence, nH = sH forsome s S. If n / NNG(S,K)(K), then there is some s so that nKn1 = sKs1. Therefore, s1nKn1s = Kso s1n NNG(S,K). But we saw before that this means there is some s such that s1nH = sH. Thus,nH = ssH and ss S. So nH P so P is indeed closed under action by NG(S, K).",
  "E.7Proof of Corollary 4.7": "Corollary 4.7. Let G be a group, S a subgroup, and K a subgroup of S. Let K be a subgroup of K and Ma subgroup of NG(S, K) NG(S, K) which contains S. Suppose P is a G-equivariant K-partial SBS for Swhich is transitive under NG(S, K). We can choose P such that StabS(p) ClNG(S,K)(K) for all p and allM-orbits in P are transitive under S if and only if NS(K)/K has a complement in NM(K)/K. Further,such a P hasDegS,K(P) |K/K| |NG(S, K)/M|. Proof. Suppose we had such a P. Pick some p P such that StabS(p) = K. Since M-orbits are transitiveunder S, we have Mp = Sp. Let P = Mp. We can check then that this is a M-equivariant set. Further,since M NG(S, K), we see that this is an exact K-partial symmetry breaking set. Hence, it is an idealM-equivariant K-partial SBS. Also note that since M NG(S, K), we have M = NM(S, K). So byTheorem 4.5, NS(K)/K must have a complement in NM(K)/K. Conversely, suppose NS(K)/K has a complement in NM(K)/K. Again, we note M = NM(S, K) so byTheorem 4.5 we have an ideal M-equivariant K-partial SBS for S. We can lift this to G-equivariance bytaking the orbit under NG(S, K). To see the order of such a P, we consider the S-orbits. Let T be a transversal of S/K. For each S-orbit,we can pick some p in that orbit so that StabS(p) K. We put the elements of Kp in our Pt. Within",
  "OhD2, D2h, T, Td, Th, O, Oh": "In the following subsections we do casework by normalizers. For each, subgroup with a given normalizer, wegive a valid complement by name if it exists. In some normalizers, the name of a subgroup is not sufficientto identify it. This is because there are multiple copies of subgroups with that name in the normalizer. Insuch cases, we must identify which copy of the subgroup we care about. To do so, we give the normalizersin terms of a group presentation found with the help of GAP. Group presentations are essentially a set ofgenerators and relations among the generators. We can then specify any specific subgroups of the normalizerusing the generators of the normalizer.",
  "F.1Normalizer: Kh": "All the groups with this normalizer do have complements. Note that in Schnflies notation, Kh is just theentire group O(3). The only subgroups with O(3) as normalizer are the trivial group C1 and inversion Ci.Clearly for the trivial group the complement is O(3). For inversion, the complement is just SO(3).",
  "We can now extend the lemma above to there being no complement of any cyclic group in D (which isO(2) in Schnflies notation)": "Lemma F.2. Let Cn be a cyclic group of order n 2 which is embedded in D such that the rotationaxis aligns with the infinite rotation axis in D. Note that it is a normal subgroup since all groups here areabelian. Then Cn does not have a complement in D.",
  "Proof. First, note that Kh is the direct product of K and inversion Ci. Suppose A had a complement H": "We can split A = Ae Ai where Ae = A K is the subgroup of pure rotations and Ai is a coset consistingof elements with an inversion. Similarly, we can split H = He Hi and Dh = D Di into subgroups ofpure rotations and coset of elements with inversions. We claim the elements of G = AeHe form a group. Consider any a, a Ae and h, h He. Since A is anormal subgroup of Dh = AH, we have hA = Ah so ha = ah for some a A. But since h, a K, wehave ah K so a K. Hence a Ae. Therefore,",
  "Next, since H is a complement of A, clearly Ae He = {e}. Since G AH = Dh, any g = ah for uniquea A and h H which by construction of G are a Ae and h He. So He is certainly a complement ofAe in G": "Now, we claim either G = D or G = C. For any g D, since H is a complement, there is a uniquea A and h H such that g = ah. In particular, we note we must either have a Ae and h He ora Ai and h Hi to have the right inversion parity. One possibility is G = AeHe = D. For the otherpossibility, suppose D G is nonempty. Fix g D G and consider any g D G. Then g = ahand g = ah where a, a Ai and hh Hi. Now, note that a1a is the combination of 2 elements withodd parity in i so a1a Ae. Next, since A is a normal subgroup, we have h1A = Ah1 and in particular,",
  "g1g = (ah)1(ah) = h1a1ah = a(h1h)": "Since h, h both have odd parity, h = h1h has even parity so in fact g1g = ah where a Ae andh He. Therefore, g1g G so D G = gG is just a G-coset of D. We can similarly also show thatD G = Gg. Now, we claim gG C = . Suppose not. Then there is some c gG C. Since Cis a divisible group, there is some c where c = (c)2. But we must have (c)2 G, a contradiction. HencegG C = so G C = C. To conclude, we must have g D C and it is clear gC wouldgenerate the remaining elements in D. So G = C in this case. From , we can see that Ae must in fact be a nontrivial cyclic group. But then the above implies thatHe is a complement of this cyclic group in either G = D or G = C, which contradict Lemma F.2 andLemma F.1 respectively. So A cannot have a complement in Dh.",
  "a, b, m|a2n, b2, m2, (ab)2, (am)2, (bm)2": "depicts an example of a D10h object. The element a correspond to a 2/10 rotation about theblue vertical axis, b corresponds to a rotation about the red axis, and m corresponds to a reflection acrossthe mirror plane shown in orange. : Object with symmetryD10h. We can identify generator a as the 10-fold rotation about the blueaxis, generator b as the 2-fold rotation about the red axis, and m as the reflection over the plane shown inorange.",
  "We provide an outline of the construction of the counterexample. It is easiest to explain this by introducingthe concept of a wreath product on groups": "Definition G.1 (Wreath product). Let H be a group with a group action on some set . Let A be anothergroup. We can define a direct product group indexed by as the set of sequences (a) where a A.The action of H on induces a semidirect product by reindexing. In particular, for all h H and sequencesin A we defineh (a) = (ah1).",
  "Note that the direct sum and direct product are the same for finite so the restricted and unrestrictedwreath products also coincide in those cases": "Consider the space = {1, 1} and an action of D4 on corresponding to the A2 representation. Intuitively,if we think of D4 as the rotational symmetries of a square in the xy-plane, this corresponds to how the zcoordinate transforms by flipping signs. Define a group G as G = C2 wr D4. This is a group of order 32and is SmallGroup(32,28) in the Small Groups library GAP. One presentation of this group is",
  "In this presentation, we can interpret a, b as generators of D4 and c as the generator one copy of C2": "Consider the group G = G G defined using the direct product.We can write generators of G asa1, b1, c1, a2, b2, c2 corresponding to two copies of those in the presentation given in equation 1 where gener-ators with different indices commute. Define S as the subgroup generated by a1, b21, c1, a2, b22, c2 and K asthe subgroup generated by c1c2. We can check that NG(S) = NG(S, K) = G. It is also not hard to check that a1b1, a2b2 generate a complementfor S in G. Hence, by Theorem 3.3, we know that an ideal G-equivariant SBS is possible for S. Hence, weknow the size of the equivariant full SBS is |S| = 256. Next, suppose we wanted a G-equivariant exact partial SBS. We can always generate this partial SBS bytaking the orbit of some element p under action by NG(S, K) = G where StabS(p) = K. We claim we mustalso have StabG(p) = K. Suppose not, then there must be some g StabG(p) such that g / S. However,we can check through casework or brute force that for all such g, either gKg1 = K or g2 S K. Butwould mean that there are elements not in K which stabilize p so StabS(p) = K, a contradiction. Hence, nosuch g can exist so StabG(p) = K. Finally, by Orbit-Stabilizer theorem, this means the set must have size|P| = |OrbG(p)| = |G|/|StabG(p)| = (82 24)/2 = 512. This is larger than the equivariant full SBS. In our supplementary material, we provide a script in GAP which verifies our claims above. In particularit performs a brute force check that StabS(p) = K implies StabG(p) = K for the group G, S, K describedabove.",
  "H.1.2Nonequivariant SBS": "In addition to using an equivariant SBS as presented in the main paper, we also tried training with thenon-equivariant SBS described in .2. Recall that the symmetry breaking objects here are a vectorpointing to one of the vertices of the triangle projected in the xy plane and a vector pointing up or downcorresponding to which triangle we pick from. We fix one pair of vectors as our symmetry breaking objectand train our equivariant model to match it with a vertex. As shown in a, our model is able to complete this. However, rotating the prism by 180 and feedingthis rotated prism along with our symmetry breaking object, we find that our model outputs a vector whichdoes not point to any vertex.This is shown in b.Contrast this with the equivariant case inFigures 16c and 16d where our model still produces a vector which points to a vertex of the prism.",
  "H.1.3Nonideal SBS": "We can modify the nonequivariant SBS into an equivariant one by adding the additional objects needed forclosure under the normalizer. Doing so we see there are 2 S-orbits in this nonideal equivariant SBS shownin . This corresponds to a degeneracy of 2 as defined in Section H.1.3. From the discussion in .4, we expect this SBS to be less efficient than an ideal one. We first trainusing only a symmetry breaking object from one of the S-orbits. We see that when given objects from thatorbit, the network correctly outputs vectors pointing to vertices of the prism but fails when given objectsfrom the other S-orbit. However, if we use objects from both orbits in training, the output vectors point tovertices when given objects from either S-orbit. Hence, we need to use at minimum 2 symmetry breakingobjects during training to guarantee correct behavior for all objects in the SBS compared to only needingone example to train for an ideal SBS.",
  "(d)": ": (a) Output (red) generated by our model and symmetry breaking object (blue) given that ischosen from a non-equivariant SBS (b) Output (red) generated by our model and symmetry breaking object(blue) given when our prism is rotated by 180 (c) Output (red) generated by our model and symmetrybreaking object (blue) given that is chosen from an equivariant SBS (d) Output (red) generated by ourmodel and symmetry breaking object (blue) given when our prism is rotated by 180",
  "We can check that the group consisting of these elements is in fact generated by a2, b, m which is (e, D2h).Hence(h, (H)) = (e, D2h)": "If an object has this symmetry then it can generate an idea partial SBS. In this case a simple choice is al = 2 object of even parity. This is depicted in b. If we align it to the x axis, this would correspondto (0, 0, 1, 0, 0) using real spherical harmonic conventions. Applying Algorithm 2 we would obtain the set ofl = 2 objects parallel to an edge of the octagon.",
  "H.3.1Atom matching algorithm": "We would like to predict atom distortions. However, our data consists of atom coordinates in the initial andtarget structures not necessarily in the same order. Hence, we need an algorithm to match similar atomstogether so we know how much they are distorted. This process is complicated by the fact that we haveperiodic boundary conditions with periodicity determined by lattice vectors and that our atoms may betranslated within the lattice. We assume our structures are given in the same rotational orientation. For our algorithm, we use the insight that the distorted atom should still have similar vectors to neighboringatoms. Hence, we can compute a signature for an atom a by taking the difference of the positions of thatatom and all other atoms in the lattice. We call the set of position differences for atom a from all otheratoms the signature a of a. Note in our implementation, we also separate out the atom types in additionto the position differences.",
  "H.3.2Translation invariant loss": "In the previous experiments, we could simply use a MSE loss of the vector differences. However, for crystalswe wanted to have a loss which is invariant under translation. We realize that our matching algorithm infact produces such a loss. By storing the matching information, we can effectively compute the same losswithout having to run the matching algorithm every time. This is what we use to evaluate our model."
}
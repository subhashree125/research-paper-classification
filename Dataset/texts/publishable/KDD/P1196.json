{
  "ABSTRACT": "Session-based recommendation techniques aim to capture dynamicuser behavior by analyzing past interactions. However, existingmethods heavily rely on historical item ID sequences to extractuser preferences, leading to challenges such as popular bias andcold-start problems. In this paper, we propose a hybrid multimodalapproach for session-based recommendation to address these chal-lenges. Our approach combines different modalities, including tex-tual content and item IDs, leveraging the complementary nature ofthese modalities using CatBoost. To learn universal item represen-tations, we design a language representation-based item retrievalarchitecture that extracts features from the textual content uti-lizing pre-trained language models. Furthermore, we introducea novel Decoupled Contrastive Learning method to enhance theeffectiveness of the language representation. This technique decou-ples the sequence representation and item representation space,facilitating bidirectional alignment through dual-queue contrastivelearning. Simultaneously, the momentum queue provides a largenumber of negative samples, effectively enhancing the effectivenessof contrastive learning. Our approach yielded competitive results,securing a 5th place ranking in KDD CUP 2023 Task 1. We havereleased the source code and pre-trained models associated withthis work1.",
  "The first four authors contributed equally to this work. Corresponding Author": "Permission to make digital or hard copies of part or all of this work for personal orclassroom use is granted without fee provided that copies are not made or distributedfor profit or commercial advantage and that copies bear this notice and the full citationon the first page. Copyrights for third-party components of this work must be honored.For all other uses, contact the owner/author(s).KDDCup 23, August 9, 2023, Long Beach, CA, USA 2023 Copyright held by the owner/author(s). ACM Reference Format:Zhipeng Zhang, Piao Tong, Qiao Liu, Yingwei Ma, Xujiang Liu, Xu Luo.2023. Language-Enhanced Session-Based Recommendation with DecoupledContrastive Learning. In KDD Cup 2023 Workshop: Multilingual SessionRecommendation Challenge, August 9, 2023, Long Beach, CA, USA. ACM,New York, NY, USA, 4 pages.",
  "INTRODUCTION": "With the progress of data mining and machine learning, session-based recommendation, which employs customer session data toforecast their next click, is gaining momentum. Sequential recom-mender has garnered popularity owing to its capability ofcapturing users transient and enduring preferences, rendering itwidely applicable across diverse recommendation contexts.Numerous methodologies have been proposed to model sequen-tial recommendation scenarios, spanning from early matrix factor-ization approaches (e.g., FPMC ) to more recent sequence neuralnetworks (such as GRU4Rec , STAMP , and Transformer ).While they may differ, their underlying principles are akin: captur-ing behavioral patterns that mirror user preferences based on thesequential access structure and establishing a mapping betweenuser preferences and specific items grounded in their interactionrelationships. However, the dependence on item interaction re-lationships curtails their efficacy when faced with the cold-startpredicament of insufficient user interactions with certain items.Recent research has explored the use of natural language text,such as item titles and descriptions, to gain domain knowledgeand address the challenges mentioned earlier . This approachinvolves utilizing pre-trained language models like BERT to obtaintext representations and learning how to transform these represen-tations into item representations. While previous attempts haveshown promise, there are still unresolved challenges that need tobe addressed: (1)Insufficient integration of multi-modal information:Existing methods combine the text representation of an itemwith its corresponding item representation, but this approach canintroduce interference between modalities. For example, if an itemhas dense interaction data and the item embeddings representationcapability surpasses that of the text representation, incorporatingthe text representation may negatively impact the expressive power",
  ": The Holistic Framework of the Proposed AdaptiveHybrid Multimodal Approach": "of the item representation. (2)Partial Semantic Synchronization: Cur-rent approaches often treat candidate items as targets, resulting inparameter updates that only align the sequential representationwith item representations that match sequence preferences. As aresult, the alignment between item representations and sequentialrepresentations is considered, while the alignment in the reversedirection is overlooked.In order to address the aforementioned challenges, we proposean adaptive hybrid multimodal framework for session-based rec-ommendation. provides an illustrative overview of theframework. This innovative framework employs multiple distinctmodels to encode autonomous representations of item IDs and theircorresponding text sequences derived from a users historical items.These representations are then leveraged to generate separate pre-dictions for the subsequent click. To achieve dynamic fusion of thepredictions, we employ the CatBoost algorithm, leveraging its capa-bility to compute the conditional probability distribution of a classbased on specific feature conditions. Additionally, we introduceDecoupled Contrastive Learning to enhance the representation ca-pability of item text. This method separates the negative samplespace into two independent subspaces: sequential representationand item representation. By decoupling these two spaces and utiliz-ing a dual-momentum queue , a substantial number of negativesamples are updated and stored. Two types of contrastive learninglosses are then computed. This process ultimately enables bidirec-tional deep alignment between sequential representations and itemrepresentations. Furthermore, our team actively participated in theKDD CUP 2023, where we conducted extensive evaluations of ourproposed solution using the Amazon-M2 dataset . Through ourrigorous experiments, we achieved competitive results, securing a5th place ranking in task 1.",
  "METHODOLOGY2.1Multimodal Approach to Item Retrieval": "2.1.1ItemCF. Despite the remarkable success of deep-learning-based approaches in recommender systems, traditional methods likecollaborative filtering (CF) continue to find extensive applicationson online platforms, owing to their irreplaceable strengths. Thesestrengths include interpretability, minimal reliance on hardware,and high efficacy in both training and deployment.In this competition, we incorporated several crucial factors intothe construction of the item similarity matrix, including position",
  ": The customized GRU architecture": "During the phase of shared embedding lookup on the users lastN clicked items, we utilize mean pooling on the embeddings of theitems as well as their associated side information (such as price andbrand) to derive fused embeddings. Subsequently, these embeddingsare fed into a GRU layer for the extraction of sequential features.To address the challenge of vanishing gradients, we introduce asequence-level residual connection block. This block conducts meanpooling on the initial fused embeddings prior to the GRU layer. Itis then added to the output of the GRU layer to generate the finalsequential representation. Differing from the approach adopted inprevious studies , which involves mean-pooling the GRU layeroutputs at each time step, our method preserves the original fusedembeddings, ensuring facilitating smoother gradient propagation.",
  ": Visualization of Language Embedding Generation and Training Flow of Decoupled Contrastive Learning": "2.1.3Language Embedding. Contrastive learning has found wideapplications in information retrieval problems . Recently, itspotential has also been explored in the field of session-based rec-ommendation . Motivated by these studies, this paper proposesa vector-based approach for item representation. The model ar-chitecture is shown in .We segment the attribute texts ofitems using [SEP] and encode them using a pre-trained BERT model.This encoding process includes both previously browsed items andthe target item. Finally, we perform average pooling on the out-puts of the first layer and apply L2 normalization to obtain therepresentation vector for each item.Each BERT encoder has a momentum encoder, whose param-eters are updated by exponential moving average of the baseencoder as follows: 1 + (1 )base . In each iterationstep t, we maintain two memory queues: one for sequence represen-tations and the other for target item representations. These queuesstore vectors, which are encoded by the momentum encoderfrom the most recent batches. With each optimization step, theoldest vectors in the memory queues are replaced by the vectorsfrom the current batch. The momentum coefficient , usu-ally set close to 1 (e.g., 0.999), ensures consistency across batches.Additionally, setting to a large value (>10000) ensures an abun-dant supply of negative samples, thereby promoting the learningof robust representations.To train the encoder, we employ the ArcCon Loss , a lossfunction that introduces a hyperparameter to add a decisionboundary, promoting compactness among sentence representationswith the same semantics and increasing the dissimilarity betweenrepresentations of sentences with different semantics:",
  "cos(, +) + cos,(5)": "In Equation 5, the variable denotes the temperature hyperparame-ter. In essence, Equation 5 can be perceived as a (K+1)-way softmaxclassification, where = represents the positive sample, and theitems stored in the queue {} represent the negative samples.It is important to note that gradients do not propagate through themomentum encoder or the storage queue during backpropagation.An important contribution in our study is the introduction ofthe training method called Decoupled Contrastive Learning. Wedivide the set of negative samples into two separate subsets, each",
  "Multimodal Fusion Rerank": "In this section, we retrieve items for each session using three re-trieval methods, resulting in three sets of retrieved items. To com-bine the scores from the retrieval methods, we multiply them to-gether, represented as = 3=1 , where is the score for eachretrieval method. From the fused scores, we select the top 120 itemsas the preliminary retrieval results. Next, we integrate the scoring ofretrieval results from different modalities and perform fine-grainedfeature engineering. We employ the CatBoost algorithm, whichis based on decision trees and can effectively merge the retrievalresults from different modalities by adaptively combining features. 2.2.1Item Hot Features. The fundamental characteristics of itemview frequencies in the dataset are considered. We have also incor-porated the sort orders feature to enhance the models ability tolearn the ranking task with greater precision. 2.2.2Session Features. In harmony with item features, we conductcomposite statistics based on the item characteristics that users en-gage with within each session. This includes computing aggregatemetrics such as the mean popularity and average price of all itemswithin a session. 2.2.3Graph Features. This study constructs a co-occurrence graphbased on itemcfs co-occurrence relationship matrix. Each item isa node in the graph, and the weights between items serve as edgeweights. By examining the degree relationships between items andtheir neighboring nodes, these features describe the importanceand connectivity of candidate items within the co-occurrence graph.Our analysis includes node importance measures like PageRank,centrality features including betweenness centrality, Katz centrality,and degree centrality, as well as neighbor node relationship char-acteristics such as mean, count, maximum, and standard deviation",
  "EXPERIMENTS3.1Datasets": "We applied data augmentation techniques referenced in the litera-ture to enhance the Amazon-M2 dataset across the UK, DE,and JP regions. Through a five-fold cross-validation method, thedata was partitioned into training and validation sets. Notably, thevalidation set exclusively comprised sessions without data augmen-tation, with the final item serving as the label. The validation setnot only served for evaluating the models performance but alsofacilitated training set generation during the reranking stage. Toensure efficiency, the validation was conducted exclusively on theUK regions data.",
  ": The influence of Decoupled Contrastive Learning": "We observed that by decoupling within the negative samplespace and employing symmetric contrastive loss, the models per-formance can be enhanced by 0.011. Additionally, adjusting theweight ratios of each loss function also influences the models ef-fectiveness.As illustrated in , we evaluated the performance of theMultimodal Fusion Rerank methodology. Initially, we presented theperformance metrics of various standalone models for comparativepurposes against Multimodal Fusion. The experimental findingsdemonstrate that incorporating the catboost algorithm and conduct-ing meticulous feature engineering both contribute significantly toelevating the performance of Multimodal Fusion.",
  "CONCLUSION AND FUTURE WORK": "This paper introduces a hybrid multimodal recommendation systemthat combines itemID and language modalities for item retrieval. Weincorporate the catboost algorithm and employ fine-grained featureengineering to merge the retrieval results from both modalities. Ourfuture work includes investigating the applicability of our algorithmin real-world e-commerce scenarios at a large scale. This work is jointly supported by the National Natural ScienceFoundation of China (U19B2028), the National Science and Tech-nology Major Project of the Ministry of Science and Technologyof China (2022YFB4300603), the Sichuan Science and TechnologyProgram (2023YFG0151) and the Development of a Big Data-basedPlatform for Analyzing the Coupling Relationship of Strip Produc-tion Processes Project.",
  "Balzs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk.2015. Session-based recommendations with recurrent neural networks. arXivpreprint arXiv:1511.06939 (2015)": "Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-RongWen. 2022. Towards universal sequence representation learning for recommendersystems. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge Dis-covery and Data Mining. 585593. Wei Jin, Haitao Mao, Zheng Li, Haoming Jiang, Chen Luo, Hongzhi Wen, HaoyuHan, Hanqing Lu, Zhengyang Wang, Ruirui Li, Zhen Li, Monica Xiao Cheng,Rahul Goutam, Haiyang Zhang, Karthik Subbian, Suhang Wang, Yizhou Sun,Jiliang Tang, Bing Yin, and Xianfeng Tang. 2023. Amazon-M2: A MultilingualMulti-locale Shopping Session Dataset for Recommendation and Text Generation.(2023). Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and JulianMcAuley. 2023. Text Is All You Need: Learning Language Representations forSequential Recommendation. arXiv preprint arXiv:2305.13731 (2023). Qiao Liu, Yifu Zeng, Refuoe Mokhosi, and Haibin Zhang. 2018. STAMP: short-term attention/memory priority model for session-based recommendation. InProceedings of the 24th ACM SIGKDD international conference on knowledge dis-covery & data mining. 18311839. Yingwei Ma, Yue Yu, Shanshan Li, Zhouyang Jia, Jun Ma, Rulin Xu, Wei Dong,and Xiangke Liao. 2023. MulCS: Towards a Unified Deep Representation forMultilingual Code Search. In 2023 IEEE International Conference on SoftwareAnalysis, Evolution and Reengineering (SANER). IEEE, 120131. Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010. Factor-izing personalized markov chains for next-basket recommendation. In Proceedingsof the 19th international conference on World wide web. 811820. Benedikt Schifferer, Jiwei Liu, Sara Rabhi, Gilberto Titericz, Chris Deotte, GabrielDe Souza P. Moreira, Ronay Ak, and Kazuki Onodera. 2022. A Diverse ModelsEnsemble for Fashion Session-Based Recommendation. In Proceedings of theRecommender Systems Challenge 2022. 1017. Yuhao Zhang, Hongji Zhu, Yongliang Wang, Nan Xu, Xiaobo Li, and BinqiangZhao. 2022. A contrastive framework for learning sentence representations frompairwise and triple-wise perspective in angular space. In Proceedings of the 60thAnnual Meeting of the Association for Computational Linguistics (Volume 1: LongPapers). 48924903."
}
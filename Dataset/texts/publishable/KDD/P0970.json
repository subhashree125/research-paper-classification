{
  "ABSTRACT": "The rapid decline in groundwater around the world poses a sig-nificant challenge to sustainable agriculture. To address this issue,agricultural managed aquifer recharge (Ag-MAR) is proposed torecharge the aquifer by artificially flooding agricultural lands us-ing surface water. Ag-MAR requires a carefully selected floodingschedule to avoid affecting the oxygen absorption of crop roots.However, current Ag-MAR scheduling does not take into accountcomplex environmental factors such as weather and soil oxygen,resulting in crop damage and insufficient recharging amounts. Thispaper proposes MARLP, the first end-to-end data-driven controlsystem for Ag-MAR. We first formulate Ag-MAR as an optimiza-tion problem. To that end, we analyze four-year in-field datasets,which reveal the multi-periodicity feature of the soil oxygen leveltrends and the opportunity to use external weather forecasts andflooding proposals as exogenous clues for soil oxygen prediction.Then, we design a two-stage forecasting framework. In the firststage, it extracts both the cross-variate dependency and the periodicpatterns from historical data to conduct preliminary forecasting. Inthe second stage, it uses weather-soil and flooding-soil causality tofacilitate an accurate prediction of soil oxygen levels. Finally, weconduct model predictive control (MPC) for Ag-MAR flooding. Toaddress the challenge of large action spaces, we devise a heuristicplanning module to reduce the number of flooding proposals toenable the search for optimal solutions. Real-world experimentsshow that MARLP reduces the oxygen deficit ratio by 86.8% whileimproving the recharging amount in unit time by 35.8%, comparedwith the previous four years.",
  "Wan Du is the corresponding author": "Permission to make digital or hard copies of all or part of this work for personal orclassroom use is granted without fee provided that copies are not made or distributedfor profit or commercial advantage and that copies bear this notice and the full citationon the first page. Copyrights for components of this work owned by others than theauthor(s) must be honored. Abstracting with credit is permitted. To copy otherwise, orrepublish, to post on servers or to redistribute to lists, requires prior specific permissionand/or a fee. Request permissions from 24, August 2529, 2024, Barcelona, Spain 2024 Copyright held by the owner/author(s). Publication rights licensed to ACM.ACM ISBN 979-8-4007-0490-1/24/08",
  "Model Predictive Control, Time Series, Forecasting, Causal Learn-ing, Agriculture": "ACM Reference Format:Yuning Chen, Kang Yang, Zhiyu An, Brady Holder, Luke Paloutzian, KhaledM. Bali, and Wan Du . 2024. MARLP: Time-series Forecasting Control forAgricultural Managed Aquifer Recharge. In Proceedings of the 30th ACMSIGKDD Conference on Knowledge Discovery and Data Mining (KDD 24),August 2529, 2024, Barcelona, Spain. ACM, New York, NY, USA, 11 pages.",
  "INTRODUCTION": "Groundwater is an important resource for agricultural stability, forexample, providing up to 60% of the water supply in dry years forCalifornia . Due to recurring global droughts in recent years,groundwater pumping has increased significantly, exceeding thenatural recharge rate and leading to insufficient water supply in un-derground aquifers . This poses a threat to the food security ofmany regions . Therefore, careful management and conser-vation of groundwater resources are highlighted in many regionsworldwide. In California, the Sustainable Groundwater Manage-ment Act (SGMA) has been introduced, aiming to achieve a balancebetween extraction and recharge within the next 20 years .",
  ": The illustration of oxygen fluctuation in continuous flooding, regular irrigation, and intermittent flooding": "Managed Aquifer Recharge (MAR) is a technique used to redi-rect excess surface water into underground aquifers during rainingseasons, helping to replenish groundwater sources and reduce theimpacts of excessive water withdrawal. This method is particularlyadopted in areas close to rivers where the land is primarily usedfor farming, known as Agricultural Managed Aquifer Recharge(Ag-MAR). Ag-MAR has been recognized as an effective methodfor restoring water levels in depleted aquifers, enhancing the sus-tainability of crop yield, as well as for other advantages such asconditioning the soil before planting seasons and enhancing habi-tats for bird populations , as illustrated in .The effective implementation of Ag-MAR remains a challengingproblem. Flooding farmland reduces the soils oxygen content, aswater hinders the dissolution of oxygen, limiting its availabilityto crop roots. Crops have specific tolerance thresholds for the soiloxygen level; if the level drops below the threshold, the crop rootstarts to decay, significantly damaging the crops. Consequently,Ag-MAR needs to optimize two objectives at the same time, i.e.,maximizing the amount of water recharged to the undergroundaquifer while keeping the soil oxygen level above a predefinedthreshold. We show examples of the soil oxygen level trends underthree different scenarios in . From left to right of the figure:first, if the flooding continues for an continuous long period, the soiloxygen level continuously drops over the tolerance threshold for theplant root, resulting in root rot and future yield reduction. Second,if the water amount is slight, like sprinkler irrigation or light rain, itmay only achieve a balance with evapotranspiration (ET) (water lostto air from soil surface and plants), resulting in insufficient aquiferrecharge. Finally, the optimized solution is to flood on intermittentcycles, alternating between substantial flooding and drying periodsso that the oxygen can diffuse into the soil.Ideally, such a schedule should take into account multiple piecesof information, e.g., current soil oxygen level, future weather, andsoil type. Given that the water permeation through soil is a continu-ous and long-lasting process, the effect of flooding actions can not beevaluated immediately, but will result in a delayed, long-term effect.Therefore, it is crucial to model and predict each flooding events long-term impact, along with potential environmental dynamics,to determine the optimal flooding schedule. However, building anaccurate prediction and control method that considers all of theabove information remains an open challenge.Analyzing our four-year real-world dataset in alfalfa fields1 re-vealed two key observations that motivate our design, which wewill describe in detail in . In short, we found out that: Soil oxygen exhibits a multi-periodicity pattern, modulated byenvironmental factors and flooding actions. Due to the strong causality between weather-soil and flooding-soil, exogenous clues such as weather forecasts and floodingproposals can boost oxygen prediction.In light of these observations, we devise MARLP, a model pre-dictive control (MPC) system for Ag-MAR. The core is a causality-aware long-term forecasting model that features a two-stage learn-ing scheme. First, it integrates cross-variate and periodicity learning,generating a preliminary self-consistent multi-variate forecasting.In this step, environment-related periodicity is handled by segment-ing the 1D data and reshaping them into a 2D format to facilitatelearning interperiod-variation, while the action-triggered periodic-ity is filtered out. The exogenous clues are then used to calibratethe oxygen prediction via a causality-aware projection module. Bycombining them, the final oxygen prediction adapts well to thefluctuating rhythms of environmental factors.This predictive capability sets the stage for the subsequent MPCworkflow, which provides predictive outputs to any flooding pro-posals for days in the future. The optimizer can accordingly choosethe best flooding strategy that both mitigates oxygen-deficit risksand maximizes the recharging to the underground aquifer. How-ever, due to the long forecast window, the total number of flood-ing proposals is exponentially huge, which cannot be searched bybrute-force or approximation algorithms. To this end, we proposea domain-specific heuristic planning module that filters the invalidflooding proposals in advance. The number of proposals has been 1Alfalfa is a classical crop for Ag-MAR as it does not require any nitrogen fertilizerafter establishment, gaining all necessary nitrogen from biological 2 fixation androot uptake. This characteristic significantly minimizes the risk of nitrate leakage .",
  ": The rationale of soil oxygen and water contentvariation during flooding": "reduced to thousands, making it practical for the system to iterateall proposals and find the best in real-time.To demonstrate the effectiveness of MARLP in predicting oxy-gen variations and scheduling flood actions, we perform statisticalcomparisons on past datasets, real-world control trials, and large-scale simulations. The experimental results show that the proposedalgorithm and scheme outperform the state-of-the-art models andcan provide practical and trustworthy decisions.Our contributions are summarized as follows: We formulate the Ag-MAR optimization as a long-term modelpredictive control problem and design a customized time-seriesforecasting model that utilizes the external predictive input andextracts the periodicity features of data traces.",
  "BACKGROUND2.1Ag-MAR Optimization": "Ag-MAR is the most applied MAR scheme for two primary reasons:1) The nearby river areas are usually fully plotted with fields, andapplying water to these fields enables minimal water transportation;2) the riverside fields typically represent the lowest points in thearea, ensuring minimal lift work. For the area of resource-demandmismatch, Ag-MAR is carried out during the off-season when thesurface water flow is adequate , and crops are not in their activegrowth phase.Ideally, we should flood as much as possible into the field, butexcessive ponding will cause oxygen deficiency and root rot.To coordinate these contradictory objectives, water use must beintermittent, so that the soil can dry out and the oxygen level cantake time to recover, as shown in . The control objectiveis to maximize the amount of water recharged while maintaininga healthy oxygen level for the root zone. So this problem could",
  "(1)": "where is a Boolean variable that indicates if the flooding isconducted in the -th time step, is the flooding gain (mm) pertime step, is the precipitation gain (mm), and is the evapo-transpiration loss (ET) in unit time. is the change in soil storage(mm) (dependent on the available water capacity (AWC) of the soil).Surface runoff is not considered due to the flat field. Note that is the combination of surface evaporation and plant transpiration.The oxygen level at any time is the accumulated results of pastenvironmental factors:",
  "= F(, , , , for )(2)": "shows the principle of how soil water content ( (3/3))and oxygen percentage change within a flooding event. In the be-ginning, the water saturates the soil and exceeds the surface, theoxygen level drops because the water has squeezed the gas in thesoil (1 to 2). This period continues after the valve is turned off. 3represents the turning point of the oxygen level, whichIn our experimental field, after 10 minutes of turning on thevalve, the entire field surface would be flooded, i.e., the soil watercontent reaches the peak value and the oxygen starts to drop sinceno gas exchange may occur. The flooding lasts for in total, whichcan be controlled by our strategy.Why predicting for a long-term? To choose the best floodingstrategy that maximizes the water amount while reducing the risksof oxygen-deficit situations, the consequences of applying watershould be accurately predicted, until the next time that the oxygenlevel recovers to the dry level. Given that this recovery processmay be slowed by high atmosphere humidity or interrupted byprecipitation, the forecasting window should be long enough tocover the entire recovery process.",
  "Observation 1. Soil oxygen exhibits a multi-periodicity pattern,caused by different sources": "Daily periodicity: This dynamic is subject to the impact ofmicro-biofunctions, whose behavior is modulated by environmentalconditions and our strategic flooding interventions, e.g., elevatedtemperatures invigorate microbial activities. This leads to a morerapid consumption of oxygen, especially during the day when thetemperature is at its zenith and microbial metabolic activities peak.Overall, the multi-periodicity pattern makes the prediction task farfrom interpretable and straightforward.Action-triggered periodicity: Post saturation, the oxygen levelforms periodic V-curves after saturation, first drops, and then grad-ually recovers, as shown in .",
  "Observation 2. There is a strong causality between flooding,weather, and soil oxygen": "Precipitation affects soil oxygen levels by saturating the soil,displacing air from pore spaces, and reducing aeration, leading toanaerobic conditions that affect plant and microbial respiration.Thus, predicting soil oxygen levels benefits from considering thecausality between weather and soil oxygen levels. Fortunately, mod-ern weather forecasting reports that synthesize global atmosphericmodeling are becoming more and more reliable, especially in sce-narios with sudden and severe rainfall events . They can beused as external clues to facilitate oxygen level inference.",
  "Model Overview": "The model architecture is shown in , consisting of three ma-jor components: dependency extraction backbone, multi-periodicityblock, and causal projection. The iTransformer dependency learn-ing backbone extracts the cross-variate and temporal dependencies.The latent space representation is then passed towards the multi-periodicity block to learn the inter- and intra-periodicity features.To this end, a forecasting result would be produced, which is self-consistent among all variates. Then the partially observable futureclues, i.e., future flooding and external weather forecasts, are uti-lized to calibrate the oxygen prediction.The historical records can be represented as X = {1, . . . , } R , with time steps and variates. They are soil oxygenconcentration, soil water content, flooding history, and weatherrecords, i.e., air temperature, precipitation, humidity, and windspeed. Besides, some partially observable future clues are included,specifically the flooding plan and weather forecasts for future timesteps Y = {+1, . . . , +} R . With both inputs, we predictthe oxygen in future time steps z = {+1, . . . ,+} R .",
  "Multi-Periodicity Block": "Periodicity lies inherently in real-world time series . Due tothe lack of application contexts, existing works assume that theperiodicity would be kept. However, this is not always the case. Theaction-triggered periodic patterns would change when the actionpatterns are changed. Therefore, we identify the action-triggered periodicity in Fast Fourier Transform (FFT) analysis and filter it outin advance.To harness the full potential of periodicity within other peri-odic patterns, we adopt a structured approach, TimesBlock, to firstperform data segmentation and reorganization . The data issegmented according to the daily frequency bin in FFT results toisolate periodic components, which are then reorganized into a 2Dformat that aligns their intra-period indexes. In this reorganizedstructure, each column of the tensor represents a discrete timepoint within a single period, and each row correlates to the samephase across different periods. This configuration allows the modelto differentiate and learn from both intra-period and inter-periodvariations. This transformation overcomes the inherent limitationsof 1D time-series data representation, enhancing the learning oftemporal patterns in microbial activities. Inception blocks are thenimplemented to extract and learn the periodicity from a specifictime segment period/frequency.",
  "Causal Projection with Exogenous Clues": "Trustworthy weather forecasts and flooding plans are partially ob-servable factors of the future. To combine their insights with history-inferred results, we compare them with preliminary weather andflooding forecasting outputs from history-based prediction mod-ules. Considering the temporal self-consistency of + +with all other + +, if an external clue + is trustworthy,+ = + + can be leveraged to fill the confidence gapbetween + and the groundtruth if causality holds between them.The causality between temperature, precipitation, soil water,and oxygen holds intuitively and empirically. Discovering causalrelationships within dozens of sequential variates is relatively easy,especially when their physical interpretations are specified. How-ever, the challenge remains in leveraging this causality to enhancetime-series forecasting. We categorize the variables into three tiersbased on their causal relationships, where upper-tier variables causethe subsequent lower-tier ones, which cant be reversed. Floodingand weather factors are in the top layer, followed by soil moisture inthe second layer, and soil oxygen in the bottom layer. After settingthe causal layers between variates, we apply Granger causality learning for each pair of variates to learn the parameters:",
  "+ ()(3)": "where () is the residual, and are linear parameters, weonly model the first-derivative causality since the context is clear,e.g., increased soil water to reduce the oxygen diffusion speed,higher temperature leads to faster soil water emission, etc. Duringinference, we iterate through layers, up to bottom, to calculate for all without external clues, i.e., soil water and soil oxygen.These values are utilized to calibrate raw outputs to achieve a newconsistency between soil oxygen forecasting and external clues.",
  ": The illustration of long-term soil oxygen prediction architecture and how it facilitates control": "variables. To this end, inversed transformer (iTransformer) isadopted as the backbone to learn the dependencies among variablesvia inversed layer normalization and attention mechanism.The layer normalization is applied across time steps rather thanfeatures, which preserves the distinct temporal dynamics of eachvariable, ensuring the learning of the patterns inherent to the data.The feed-forward networks serve to distill complex temporal fea-tures from each variate, allowing the attention module to workeffectively. The attention mechanism of iTransformer is carefullycalibrated to work with the tokenized series of variates. It avoids thetraditional composite token format to enhance the models abilityto map out the dependencies among multiple variables. We modifythe decoder to be combined with the multi-periodicity block and tobe trained end-to-end.In-situ Model Update. Considering distribution shifts betweenregions, fields, and other environmental dynamics, we use the newlycollected data to adapt the forecasting model, which enhances thescalability for wide adoption.",
  "Workflow": "The workflow of MARLP is shown in . The heuristic plan-ning generates flooding traces with predefined rules and constraintsto propose potential flooding schedules. The long-term oxygenforecasting module then incorporates historical data and weatherforecasts to simulate the consequential oxygen trace of all floodingtraces. These flooding proposals and the oxygen level predictionsare then analyzed by the optimizer according to the optimizationobjective specified by Eq.1. Once the best flooding plan is identified,the optimizer sends the actions to the actuator. The workflow canbe conducted again anytime, not necessarily after the plan is fullyexecuted.To handle the errors in external clues like weather forecasts, wehave the decisions updated every 10 minutes to recalibrate themtimely, significantly reducing the impact of unexpected dynam-ics. This scheduling interval can be adjusted to balance the timeli-ness and the computation overhead. Note that agile re-schedulingdoesnt conflict with the necessity of long-term forecasting becauseflooding actions can never be revoked.",
  "Heuristic Planning": "The essential part of MPC is to estimate the optimal flooding traceamong all flooding proposals, while not consuming an intolerableamount of computation. Traditionally, this is done by adoptingstochastic searching methods such as shooting-based methodsor cross-entropy methods. Considering a planning period thatmay extend beyond 120 hours, with a decision required every 10minutes, the number of potential action sequences can reach 2720,which is too large for a stochastic searching method to be effective.To address this, we propose schemes based on an understanding ofsaturating actions in the system. These schemes are derived fromtwo key principles:(1) Flooding Duration Constraint: To ensure the effectivenessof groundwater recharging, once flooding begins, it must continuefor at least a minimum duration before ceasing. This constraint canbe represented as:",
  "( [, + max_flood), () = 0)(5)": "Here, () is a binary indicator function where () = 1, ifflooding is occurring at time,, is the total observation time period,and min_flood is the minimum required duration for continuousflooding.(2) Idle Period Duration Constraint: Between two floodings,the idle interval must be long enough that the oxygen can effectivelydiffuse, otherwise it should not take the interval, but should graspthe chance to flood more. This constraint ensures an adequatedrying period for the soil oxygen recovery:",
  "( [, + min_idle), () = 0)(6)": "In this case, () = 0 indicates an idle (non-flooding) period attime , and min_idle represents the minimum required durationfor the idle period to allow for soil aeration.By implementing these constraints, we can mathematically de-fine and enforce the necessary spacing between flooding and idleperiods within the MPC framework. By filtering out suboptimalaction traces, we significantly reduced the size of the search space",
  "IN-FIELD EXPERIMENT SETUP": "As shown in Figures 6 and 13, we build a real experimental testbed toverify the effectiveness of MARLP in practical scenarios. It includessensory data collection, transmission and decision making modules.These components function as a comprehensive in-field experimentsystem that enables online evaluation of MARLP, offering moreprecise and realistic insights than those obtained from simulationsor offline evaluations.Sensor Data Collection: The oxygen and moisture sensorsare placed at critical points throughout the facility. These sensorscontinuously measure real-time oxygen and moisture data, enablingprompt adjustments to maintain optimal oxygen levels.Sensor Data Transmission: The collected oxygen and moisturedata are transmitted to a central server through LoRa networks,ensuring long-range, low-power wireless communication . The implementation details are in Appendix A. We configuredthe transmission parameters to ensure that all measured sensorydata are accurately received by our central server .Inference Server. This server is configured on the cloud with an Intel(R) Core(TM) i9-11900KF CPU and an NVIDIA GEFORCERTX 3080 Ti GPU. It executes the MPC algorithm and forecastingneural networks with continuously aggregated sensor data andqueried weather forecast data from open-source web API inreal time.System Overhead. The power consumption of each sensornode for sensing and communicating is 64 mW, which can be easilycovered by a solar panel, mitigating the need to change batteries.The gateway and server could be purchased as a service duringflooding seasons. Overall, the system requires less than $400 toimplement and $50/year to maintain, ensuring easy adoption, evenfor small farms.",
  "Predictive Capability": "We choose four recent, representative and highly performed time-series forecasting models as baselines: TimesNet , PatchTST ,DLinear , and iTransformer , covering convolutional, lin-ear, and transformer-based methodologies. We evaluate all baselineforecasting models on five datasets from five years within threefields. The prediction sequence length is set as 720, which repre-sents five days. Given the sensor reading interval of 10 minutes, theforecasting window is 120 hours, which can fully observe oxygenrecovery in most cases. shows dataset statistics, includingthe collection area, period, flooding strategy, and sequence length.Ag-MAR actions lie between growing seasons, which is roughlyfrom January to April for alfalfa in California, US. From 2020 to2023, the field is flooded with constant intervals, e.g., once a week.Trials in 2024 are controlled by MARLP. reports the MSE, MAE, as well as the mean absolute errorof the peak time (PTE) and peak value (PVE) among all forecastingmodels. The unit of peak time error is an hour. In , it isevident that MARLP consistently achieves the highest performance(highlighted with red values) when incorporating weather fore-cast data. This underscores the effectiveness of our long-term soiloxygen prediction algorithm, which is vital for the MPC.",
  "In-field Control Experiments": "We perform the first in-field deployment of the Ag-MAR controlscheme, as illustrated in . The quality of control is evalu-ated under two factors: oxygen deficit ratio (ODR) and recharg-ing amount. ODR calculates the ratio of time that the soil oxygenlevel is below the safety threshold, which should be zero in idealcases. The best recharging amount may vary according to weatherconditions, so the optimal recharging amount can not be asserted,instead, we can only compare the schemes with each other. Allin-field experiments are conducted in alfalfa fields, with the safetythreshold of oxygen concentration as 10%. compares the control performance of MARLP with theweekly flooded scheme in 2020-2023 as the baseline. The weeklyflooded scheme resulted in an average oxygen deficit ratio of 2.72%,while controlling with MARLP yields an ODR of 0.36%. At the same",
  "time, MARLP increased the recharging amount (inch per week)from 7.64 to 10.371, with a 35.8% improvement": "provides an example of comparison between the weeklyflooding scheme and MARLP to show the reason behind the higheffectiveness of MARLP. The red and purple bars represent theamount of precipitation and flooding, respectively. Each bar is 10minutes wide, so the visual areas indicate the total amount of waterinput. In (a), the weekly-based approach ignores the heavyrain forecast after flooding, resulting in the unexpected oxygendeficit below 10% on day 1 and day 8. At the same time, it missesthe opportunity to flood during days 3-6, when there is no rainfall. (b) shows the performance of MARLP. On day 1 and day2, when the rainfall is negligible, it conducts a 14-hour rechargefor 3.1 mm. The oxygen low peak is 10.16%, without exceeding thesafety threshold, as depicted by the red dashed line. Knowing theheavy rain on day 4 of the forecast, it discarded aggressive proposalsand stopped flooding for 5 days to avoid danger. This shows thatMARLP can foresee the consequences of each proposal and avoidrisky flooding while making full use of flooding opportunities.",
  "Large-scale Simulation": "To evaluate the generalization capability of all prediction models,we utilize a simulator to replicate a diverse array of factors, includ-ing soil types, crop species, and regional climate.2 Specifically, wesimulate the water content transition in the soil using HYDRUS ,a classical simulator for soil flux . Then we model the oxygendiffusion process, root respiration, and microbial respiration basedon empirical equations . The evaluation targets the oxygendeficit ratio and recharging amount in the simulation.",
  ": Control performance for crop species": "6.3.1Impact of Soil Types. To check the generalizability of MARLPon different soil, we mimic three representative soil types: sand,loam, and silt according to the soil texture triangle defined byUSDA . We simulate each soil texture as a testbed, where allmodels are evaluated with MPC architecture the same as MARLP.The crops and weather remain the same as in the 2023 in-fieldexperiment. (a) shows that MARLP achieves the lowest oxy-gen deficit ratio than the baselines for all three soil textures, and(b) shows that MARLP achieves a high recharging amountat the same time. Although DLinear achieves a higher recharg-ing amount on loam and slit, it performs significantly worse thanMARLP in terms of oxygen deficit ratio. The superior robustnessbased on the causality-aware forecasting of MARLP holds on othersoil types. Note that the soil texture has a significant impact onthe general trend of the potential recharging amount because soilwith relatively high percolation rates can accelerate the atmosphereexchange process. 6.3.2Impact of Crop Species. We choose walnut trees, grapes andalmond trees, with distinct root densities, depths and oxygen-deficittolerances , to assess how the crop diversity influences the con-trol performance. Walnuts and almonds are less tolerant to floodingthan alfalfa, hence they are more susceptible to high oxygen-deficitratio. (a) shows that MARLP achieves the lowest oxygen-deficit ratio than the baselines for all three crop species, and Fig-ure 10(b) shows that MARLP achieves a high recharging amountat the same time. Therefore, MARLP has the best generalizationcapability among all methods. 6.3.3Impact of Regional Climatic. Although California is at theforefront of Ag-MAR adoption, this practice is becoming increas-ingly popular in other parts of the world that face similar hydrologi-cal challenges, particularly those with a Mediterranean climate. We",
  ": Ablation study for modules and input variables": "broaden its scope to include the High-Atlas region in Morocco and the Algarve region in Portugal , incorporating soil andweather data from these diverse global regions that are activelyexploring Ag-MAR. The experimental periods for the simulationsare both Feb. 28th - Apr. 6th, 2023, aligning with our real-worldexperiments in California. We use HYDRUS to simulate thesoil dynamics of these two sites and use five models to conductflooding control separately, with the same goal settings. The resultsare shown in . The control performance of all modelsexhibits drops since the High-Atlas encounters a few sharp precip-itations due to high altitude, while Algarve is located by the sea,with stronger daily periodicity. MARLP keeps achieving the bestcontrol performance. It underscores the generalizability of MARLPand its potential to be adapted worldwide.",
  "Ablation Study": "In this section, we systematically tested the performance of MARLPby excluding each design module to evaluate their individual ef-fectiveness. Additionally, we examined how each input variablecontributes to the system. These tests revealed the necessity ofinvolving these clues and casual strength between the soil oxygenand each of them. We plot the mean and standard deviation of MSEacross all datasets.Design module ablations. We construct ablated versions of themodel by substituting the iTransformer with a vanilla Transformer,removing the periodicity block and the causal module. (a)illustrates that the performance of each ablated version diminishes,with the version lacking the causal module experiencing the mostsignificant reduction. This decline is because of the pronouncedcausality inherent in Ag-MAR data.",
  "MARLP: Time-series Forecasting Control for Agricultural Managed Aquifer RechargeKDD 24, August 2529, 2024, Barcelona, Spain": "Impact of Input Features. (b) shows the influence ofvarious inputs on the MSE of oxygen forecasting. The abbreviationsFH, SW, WH, WF, and FF represent flooding history, soil watercontent, weather history, weather forecast, and future flooding,respectively. All inputs play a pivotal role in enhancing the finalperformance, with weather forecasts and future flooding making themost significant contributions. Consequently, optimal forecastingnecessitates a synergistic integration of historical data.Overall, this ablation study affirms the importance of each factorin improving oxygen forecasting and underscores the significanceof causal-aware forecasting that incorporates external indicators.",
  "DISCUSSIONS AND FUTURE WORKS": "Ag-MAR studies. Ag-MAR has been studied in terms of environ-mental benefits and potential risks, the fitness of differentsoil types, crops, and geological regions. The preliminary resultsare positive and bring it towards global adoption . However, itscurrent implementation is empirical , lacking a standardizedand automatic workflow to achieve the best flooding. Based on theoxygen pattern analysis, MARLP provides a systematical solutionthat can work seamlessly with sensor systems, without the need forexpert knowledge. Recent studies also illustrate that the oxygen-deficit tolerance level is temperature dependent . Future workscan integrate this feature to enhance the practicality of MARLP.Multi-variate time-series prediction algorithms. The evo-lution of multivariate time series prediction algorithms has beenmarked by significant milestones, starting with the development ofthe autoregressive integrated moving average (ARIMA) model ,progressing through the use of recurring neural networks (RNN) , and further evolving with the introduction of Transformer .NS-Transformer proposes series stationarization and de-stationaryattention to handle the distribution shift and boost the performanceof the Transformer on time-series prediction. Dish-TS proposesa general paradigm to alleviate distribution shifts in time series.ESG integrates learning pairwise correlations and temporaldependency in one framework. iTransformer optimizes the ex-traction of temporal and cross-variate dependency by swapping twomodules. Instead of conducting universal forecasting, other worksfocus on different objectives. TimesNet and DEPTS aims tolearn periodic patterns in time series. TSMixer utilizes the MLParchitecture to reduce computing overhead. IPOC innovateswith ensemble learning, offering real-time adaptable confidenceinterval predictions. MARLP distinguishes itself with a two-stagemethod that first predicts based on historical patterns, then utilizesexternal clues for causality-aware calibration.Causal discovery and inference for time-series data. Causalrelationship widely exists in sequence data, e.g., the classical causal-ity between milk price and butter price . Granger causality isproposed to handle the delay of the causal impact . proposesBayesian forecasting with time-varying causal models, but it onlyworks for short terms. CASTOR introduces time-lagged linksinto GNN to enhance Granger causality modeling. REASON utilizes graph neural networks to extract layered causal relation-ships. CORAL is a framework that automatically updates theroot cause analysis model. Instead of discovering and quantifyingcausality, our solution focuses on applying causality to long-termtime-series forecasting with external clues. Time-series forecasting for real applications. Time-seriesforecasting is not only a critical question in agricultural practices,but also vital in other industries such as electricity, weather, finance,traffic, and human-computer interaction . Forexample, RAPT performs a prediction on medical data for thediagnosis of pregnancy complications. ClimODE uses physics-informed neural ODE to simulate global atmosphere dynamics forclimate forecasting. We will upgrade the sensor systems to enableneural ODE on Ag-MAR oxygen modeling in future works.MPC based on long-term forecasting. MPC has been usedfor application scenarios from the microsecond-level horizon (e.g.,embedded system voltage control ) to the hour-level horizon(e.g., building control , grid control ). Existing works utilizeMPC for irrigation, but the planning horizon and forecast windoware less than one day . Reinforcement learning based control can achieve effective control, but lacks reliability andrequires a large amount of data to converge, making it unsuitablefor Ag-MAR. To the best of our knowledge, this work is the firstMPC work to consider a planning horizon of several days.Robustness and Efficiency. Robustness is a major concern forapplied machine learning . The predicted state trajectorygenerated as part of the MPC planning process allows the safetycheck of the trajectory, which offers a higher level of reliability .In future works, we may apply safe guarantee mechanisms like aGaussian-based uncertainty check, to achieve better tradeoffsbetween reliability and efficiency. Furthermore, given the typicallyextensive search spaces involved in real-world, long-term forecast-ing control, efficiency becomes a pivotal aspect. Unlike RL, whichcan separate agent models from environmental models to improveefficiency , time series modeling offers limited scopeto balance performance with efficiency. However, recent advancesin state space models (SSM) have significantly mitigated computa-tional burdens . Future research could explore the applicationof SSMs in scenarios where real-time requirements are critical.",
  "CONCLUSION": "This paper introduces MARLP, a model predictive control systemfor Ag-MAR, employing heuristic planning and a long-term oxy-gen forecasting module to optimize groundwater recharge and soiloxygen levels. Benefiting from a causality-aware forecasting model,MARLP effectively manages environmental variables in real-time,enhancing water use efficiency in agriculture. The successful de-ployment of MARLP, which reduces the oxygen deficit ratio andimproves the total amount of applied water, showcases the sys-tems potential in precision agriculture and sustainable resourcemanagement. This work was supported in part by a UC Merced Fall 2023 ClimateAction Seed Competition grant, and a UC Merced Spring 2023 Cli-mate Action Seed Competition grant. Kang Yang was supported bya financial assistance award approved by the Economic Develop-ment Administrations Farms Food Future program. Any opinions,findings, and conclusions expressed in this material are those ofthe authors and do not necessarily reflect the views of the fundingagencies.",
  "Zhiyu An, Xianzhong Ding, Arya Rathee, and Wan Du. 2023.CLUE: SafeModel-Based RL HVAC Control Using Epistemic Uncertainty Estimation. InACM BuildSys": "Titus O Awokuse and Xiaohong Wang. 2009. Threshold effects and asymmet-ric price adjustments in US dairy markets. Canadian Journal of AgriculturalEconomics/Revue canadienne dagroeconomie 57, 2 (2009), 269286. Khaled M Bali, Abdelmoneim Zakaria Mohamed, Sultan Begna, Dong Wang,Daniel Putnam, Helen E Dahlke, and Mohamed Galal Eltarabily. 2023. The use ofHYDRUS-2D to simulate intermittent Agricultural Managed Aquifer Recharge(Ag-MAR) in Alfalfa in the San Joaquin Valley. Agricultural Water Management282 (2023), 108296.",
  "California Department of Water Resources. 2014. Sustainable Groundwater Man-agement Act (SGMA)": "Jiadong Chen, Yang Luo, Xiuqi Huang, Fuxin Jiang, Yangguang Shi, TieyingZhang, and Xiaofeng Gao. 2023. IPOC: An Adaptive Interval Prediction Modelbased on Online Chasing and Conformal Inference for Large-Scale Systems. InProceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery andData Mining. 202212. Kyunghyun Cho, Bart Van Merrinboer, Caglar Gulcehre, Dzmitry Bahdanau,Fethi Bougares, Holger Schwenk, and Yoshua Bengio. 2014. Learning phraserepresentations using RNN encoder-decoder for statistical machine translation.arXiv preprint arXiv:1406.1078 (2014).",
  "Xianzhong Ding and Wan Du. 2023. Optimizing irrigation efficiency using deepreinforcement learning in the field. ACM Transactions on Sensor Networks (2023)": "Vijay Ekambaram, Arindam Jati, Nam Nguyen, Phanwadee Sinthong, and JayantKalagnanam. 2023. TSMixer: Lightweight MLP-Mixer Model for MultivariateTime Series Forecasting. In Proceedings of the 29th ACM SIGKDD Conference onKnowledge Discovery and Data Mining (KDD 23). 459469. Alvar Escriva-Bou, Brian Gray, Sarge Green, Thomas Harter, Richard Howitt,Duncan MacEwan, and N Seavy. 2017.Water Stress and a ChangingSan Joaquin Valley.Public Policy Institute of California. ppic.org/content/pubs/report/R_0317EHR. pdf (2017). Wei Fan, Pengyang Wang, Dongkun Wang, Dongjie Wang, Yuanchun Zhou, andYanjie Fu. 2023. Dish-ts: a general paradigm for alleviating distribution shiftin time series forecasting. In Proceedings of the AAAI Conference on ArtificialIntelligence. Wei Fan, Shun Zheng, Xiaohan Yi, Wei Cao, Yanjie Fu, Jiang Bian, and Tie-YanLiu. 2021. DEPTS: Deep Expansion Learning for Periodic Time Series Forecasting.In International Conference on Learning Representations.",
  "Sepp Hochreiter and Jrgen Schmidhuber. 1997. Long short-term memory. Neuralcomputation 9, 8 (1997), 17351780": "Biwei Huang, Kun Zhang, Mingming Gong, and Clark Glymour. 2019. Causaldiscovery and forecasting in nonstationary environments with state-space models.In International conference on machine learning. PMLR, 29012910. Scott Jasechko, Hansjrg Seybold, Debra Perrone, Ying Fan, Mohammad Sham-sudduha, Richard G Taylor, Othman Fallatah, and James W Kirchner. 2024. Rapidgroundwater decline and some cases of recovery in aquifers globally. Nature 625,7996 (2024), 715721. George Kourakos, Helen E Dahlke, and Thomas Harter. 2019. Increasing ground-water availability and seasonal base flow through agricultural managed aquiferrecharge in an irrigated basin. Water Resources Research 55, 9 (2019), 74647492. Nathaniel Lahn, Sharath Raghvendra, and Kaiyi Zhang. 2024. A CombinatorialAlgorithm for Approximating the Optimal Transport in the Parallel and MPCSettings. Advances in Neural Information Processing Systems 36 (2024). Remi Lam, Alvaro Sanchez-Gonzalez, Matthew Willson, Peter Wirnsberger, MeireFortunato, Ferran Alet, Suman Ravuri, Timo Ewalds, Zach Eaton-Rosen, WeihuaHu, et al. 2023. Learning skillful medium-range global weather forecasting.Science (2023), eadi2336. Guangchen Lan, Dong-Jun Han, Abolfazl Hashemi, Vaneet Aggarwal, and Christo-pher G Brinton. 2024. Asynchronous federated reinforcement learning with policygradient updates: Algorithm design and convergence analysis. arXiv preprintarXiv:2404.08003 (2024). Guangchen Lan, Han Wang, James Anderson, Christopher Brinton, and VaneetAggarwal. 2024. Improved Communication Efficiency in Federated Natural PolicyGradient via ADMM-based Gradient Updates. Advances in Neural InformationProcessing Systems 36 (2024). Elad Levintal, Maribeth L Kniffin, Yonatan Ganot, Nisha Marwaha, Nicholas PMurphy, and Helen E Dahlke. 2023. Agricultural managed aquifer recharge (Ag-MAR)a method for sustainable groundwater management: A review. CriticalReviews in Environmental Science and Technology 53, 3 (2023), 291314. Eyke Liegmann, Petros Karamanakos, and Ralph Kennel. 2021. Real-time im-plementation of long-horizon direct model predictive control on an embeddedsystem. IEEE Open Journal of Industry Applications 3 (2021), 112. Shun Liu, Kexin Wu, Chufeng Jiang, Bin Huang, and Danqing Ma. 2023. Financialtime-series forecasting: Towards synergizing performance and interpretabilitywithin a hybrid machine learning approach. arXiv preprint arXiv:2401.00534(2023). Yong Liu, Tengge Hu, Haoran Zhang, Haixu Wu, Shiyu Wang, Lintao Ma, andMingsheng Long. 2023. iTransformer: Inverted Transformers Are Effective forTime Series Forecasting. arXiv preprint arXiv:2310.06625 (2023).",
  "Yong Liu, Haixu Wu, Jianmin Wang, and Mingsheng Long. 2022. Non-stationaryTransformers: Exploring the Stationarity in Time Series Forecasting. (2022)": "Yilin Liu, Shijia Zhang, and Mahanth Gowda. 2021. When video meets inertialsensors: Zero-shot domain adaptation for finger motion analytics with inertialsensors. In Proceedings of the International Conference on Internet-of-Things Designand Implementation. 182194. Yilin Liu, Shijia Zhang, Mahanth Gowda, and Srihari Nelakuditi. 2022. Leveragingthe properties of mmwave signals for 3d finger motion tracking for interactive iotapplications. Proceedings of the ACM on Measurement and Analysis of ComputingSystems 6, 3 (2022), 128. Nisha Marwaha, George Kourakos, Elad Levintal, and Helen E Dahlke. 2021.Identifying agricultural managed aquifer recharge locations to benefit drink-ing water supply in rural communities. Water Resources Research 57, 3 (2021),e2020WR028811. Nicholas Paul Murphy. 2022. Examining Nitrate Leaching Potential and NitrogenCycle Dynamics under Agricultural Managed Aquifer Recharge in the CentralValley of California. University of California, Davis.",
  "James R Nelson and Nathan G Johnson. 2020. Model predictive control of mi-crogrids for real-time ancillary service market participation. Applied Energy 269(2020), 114963": "Yuqi Nie, Nam H Nguyen, Phanwadee Sinthong, and Jayant Kalagnanam. 2022.A Time Series is Worth 64 Words: Long-term Forecasting with Transformers. InThe Eleventh International Conference on Learning Representations. Richard G Niswonger, Eric D Morway, Enrique Triana, and Justin L Huntington.2017. Managed aquifer recharge through off-season irrigation in agriculturalregions. Water Resources Research 53, 8 (2017), 69706992. AT OGeen, Matthew BB Saal, Helen E Dahlke, David A Doll, Rachel B Elkins,Allan Fulton, Graham E Fogg, Thomas Harter, Jan W Hopmans, Chuck Ingels, et al.2015. Soil suitability index identifies potential areas for groundwater banking onagricultural lands. California Agriculture 69, 2 (2015).",
  "Abdellah Rahmani and Pascal Frossard. 2023. Castor: Causal Temporal RegimeStructure Learning. arXiv preprint arXiv:2311.01412 (2023)": "Houxing Ren, Jingyuan Wang, Wayne Xin Zhao, and Ning Wu. 2021. Rapt: Pre-training of time-aware transformer for learning robust healthcare representation.In Proceedings of the 27th ACM SIGKDD conference on knowledge discovery & datamining. 35033511. Anil Seth. 2007. Granger causality. Scholarpedia 2, 7 (2007), 1667. Zhihao Shen, Kang Yang, Wan Du, Xi Zhao, and Jianhua Zou. 2019. DeepAPP: ADeep Reinforcement Learning Framework for Mobile Application Usage Predic-tion. In ACM SenSys. J Simnek, M Sejna, and M Th Van Genuchten. 1999. The HYDRUS-2D softwarepackage for simulating the two-dimensional movement of water, heat, and mul-tiple solutes in variably-saturated media: Version 2.0. US Salinity Laboratory,Agricultural Research Service.",
  "Yogesh Verma, Markus Heinonen, and Vikas Garg. 2023. ClimODE: ClimateForecasting With Physics-informed Neural ODEs. In The Twelfth InternationalConference on Learning Representations": "Dongjie Wang, Zhengzhang Chen, Yanjie Fu, Yanchi Liu, and Haifeng Chen. 2023.Incremental causal graph learning for online root cause analysis. In Proceedingsof the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining.22692278. Dongjie Wang, Zhengzhang Chen, Jingchao Ni, Liang Tong, Zheng Wang, YanjieFu, and Haifeng Chen. 2023. Interdependent Causal Networks for Root CauseLocalization. In Proceedings of the 29th ACM SIGKDD Conference on KnowledgeDiscovery and Data Mining. 50515060. Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang, and MingshengLong. 2023. TimesNet: Temporal 2D-Variation Modeling for General Time SeriesAnalysis. In International Conference on Learning Representations(ICLR). Xianjin Xia, Qianwu Chen, Ningning Hou, Yuanqing Zheng, and Mo Li. 2023.XCopy: Boosting Weak Links for Reliable LoRa Communication. In Proceedingsof the 29th Annual International Conference on Mobile Computing and Networking.115. Yifei Xu, Yuning Chen, Xumiao Zhang, Xianshang Lin, Pan Hu, Yunfei Ma,Songwu Lu, Wan Du, Zhuoqing Mao, Ennan Zhai, et al. 2024. CloudEval-YAML:A Practical Benchmark for Cloud Configuration Generation. Proceedings ofMachine Learning and Systems 6 (2024), 173195. Kang Yang, Yuning Chen, Xuanren Chen, and Wan Du. 2023. Link qualitymodeling for lora networks in orchards. In Proceedings of the 22nd InternationalConference on Information Processing in Sensor Networks. 2739.",
  ": The illustration of the solar-powered sensor node": "The sensor node is powered by solar energy. As shown in Fig-ure 13, it consists of several key components. The Arduino Unoserves as the central controller, managing the operations of sen-sor readings and LoRa signal modulation. It is connected to KE-25oxygen sensors and IRROMETER Watermark 200SS soil moisturesensors, which are deployed in the soil. The InAir9B LoRa radiois connected to the Arduino Uno via a relay board, which enableslow-power long-range communication. The rechargeable batteryalong with the solar charger ensures minimum maintenance efforts.Key components are hosted in the waterproof box to protect themfrom damage and fast aging caused by environmental factors. Thespreading factor (SF) of the LoRa transmission is 8."
}
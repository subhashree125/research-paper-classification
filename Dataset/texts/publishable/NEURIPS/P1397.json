{
  "Abstract": "With the approach of the High Luminosity Large Hadron Collider (HL-LHC) eraset to begin particle collisions by the end of this decade, it is evident that thecomputational demands of traditional collision simulation methods are becom-ing increasingly unsustainable. Existing approaches, which rely heavily on first-principles Monte Carlo simulations for modeling event showers in calorimeters,are projected to require millions of CPU-years annuallyfar exceeding currentcomputational capacities. This bottleneck presents an exciting opportunity foradvancements in computational physics by integrating deep generative models withquantum simulations. We propose a quantum-assisted hierarchical deep generativesurrogate founded on a variational autoencoder (VAE) in combination with anenergy conditioned restricted Boltzmann machine (RBM) embedded in the modelslatent space as a prior. By mapping the topology of D-Waves Zephyr quantum an-nealer (QA) into the nodes and couplings of a 4-partite RBM, we leverage quantumsimulation to accelerate our shower generation times significantly. To evaluate ourframework, we use Dataset 2 of the CaloChallenge 2022. Through the integrationof classical computation and quantum simulation, this hybrid framework paves wayfor utilizing large-scale quantum simulations as priors in deep generative models.",
  "Introduction": "The High-Luminosity Large Hadron Collider (HL-LHC), expected to be operational by the end ofthis decade, will offer unprecedented opportunities to measure the Higgs boson properties, explorethe Standard Model in greater depth, while also searching for physics beyond the Standard Model A critical component of this endeavor is the vast amount of data obtained from numerical simulations,which play a crucial role in both the design of future experiments and in the analysis of current ones.These simulations, done with Geant4 , accurately describe the collisions at the Large HadronCollider (LHC). But this comes at the price of being computationally intensive. These simulationsdescribe the interactions between detectors and primary particles, but also account for the interactionwith secondary particles produced as the primary particles interact with the detector material. Such isthe case with calorimeters, which measure energy deposition from showers of secondary particles.Current projection for the HL-LHC run estimate millions of CPU-years per year . Simulating onesingle event with Geant4 in an LHC experiment requires approximately 1000 CPU seconds, withthe calorimeter simulation being the most resource-intensive module . Through the generationof these showers, non-negligible computational resources are being employed in keeping track ofthese particles. Deep generative surrogates are being developed to model the particle-calorimeterinteractions in the simulation pipeline, potentially reducing the overall time to simulate single eventsby several orders of magnitude. Examples of these are Generative Adversarial Networks , whichare now an integral part of the simulation pipeline . Similarly VAEs , NormalizingFlows , Transformers , Diffusion models and combinations thereof ,where the last reference combines a VAE with a two-partite quantum annealer (QA). The frameworkcombining VAE with QAs has also been used in different contexts .",
  "Methods": "We illustrate our framework by using Dataset 2 of the CaloChallange-2022 . This dataset consistsof 100k Geant4-simulated electron showers ranging from 1 GeV to 1 TeV incident particle energy,sampled from a log-uniform distribution. The voxelized detector is in the form of a concentric cylinderwith 45 layers in the axial direction of which each layer is made up of an alternating collider-absorber,active (silicon) and passive (tungsten), material. Each layer consists of 144 voxels (volumetric pixels),9 radially and 16 in the angular direction to yield a total of 45 x 16 x 9 = 6480 voxels in one event asshown in . Each event has its corresponding incident particle energy as its label. We preprocessthe data similar to , except we omit the last step where the new variable is standardized. Instead",
  "Machine Learning and the Physical Sciences Workshop, NeurIPS 2024": ": (a) Calochallenge dataset showers are voxelized using cylindrical coordinates (r, , z). Forany given event, each voxel value corresponds to the energy (MeV) in that vicinity. Each layer has144 voxels composed of 16 angular bins and 9 radial bins. The data set is parsed onto a 1D vectorwith 6480 voxels per each event. (b) Visualization of the voxels in an event in the dataset.",
  "we apply a shift to the logits to preserve the sparsity of the shower in the new variables, i.e., the newvariable is zero whenever the voxel energy is zero": ": (a) Overview of Calo4pQVAE training architecture. Preprocessed voxels of a shower, xand their corresponding incident energies, e are inputted to the encoder. The encoder compressesthe energy-conditioned shower into 4 partitions, of which 3 are generated from the hierarchies ofthe encoders and 1 is an encoded conditioning of the incident energy. The conditioned RBM istrained to learn these representations, then the concatenation of the 4 partitions is the latent vector thatgets passed through the hierarchical decoder, generating a hits and activations vector to reconstructthe shower. (b) Once the model finishes training classically, the states of the trained RBM withan incidence energy conditioning is loaded onto D-Waves Zephyr quantum annealer to sample alatent vector that is then passed through the hierarchical decoder to generate a shower. (c) Thehierarchical decoder consists of 9 sub-decoders, each generating 5 layers to make up a total of 45layers and conditions subsequent layers of the shower based on previous layers to simulate thephysical propagation of particle scattering in the calorimeter through the evolution of the shower. Our model is a variational autoencoder with a 4-partite conditioned restricted Boltzmann machine as the prior, as illustrated in (a) . We used a hierarchical encoder composed of three sub-encoders. These hierarchy levels enforce couplings among latent units by introducing conditioningamong latent nodes. In addition, these hierarchy levels introduce skip connections akin to residualnetworks . We feed the encoded sample from each of the three sub-encoder outputs to threeof the partitions in the RBM, while the fourth partition is used to condition the RBM. The RBMcondition parameter is the binarized incident particle energy of the event. The prior is the 4-partiterestricted Boltzmann machine, where the connections between nodes mimic the Zephyr topology ofD-waves QA . The encoded sample is then fed to the hierarchical decoder, as shown in (c) where n sub-decoders are allocated to generate 45/n layers per sub-decoder. The hierarchicaldecoder conditions subsequent layers of the shower based on previous layers through hierarchiesof auto regressive sub-decoders to simulate the physical propagation of particle scattering in thecalorimeter during the evolution of a shower. The hierarchical decoder in Calo4pQVAE consists of 9subdecoders, each generating 5 layers, making up the entire 45-layer voxelized shower. The decoder outputs a mask vector and an activation vector, and their Hadamard product yields the generatedshower. We use the Gumbel trick in our framework to generate both the encoded shower as wellas to generate the output mask. Our code is publicly available and can be found here . : (a) Saturation of RBM log-likelihood vs epochs. Yellow star - freezing of encoder anddecoder, Red star - completion of model training. (b) QA inverse temperature estimation vs iterations.(c) RBM energy histogram for classical and QA samples.",
  "Results": "We trained our model classically for 100 epochs via the evidence lower bound (ELBO) functionsimilar to , set the number of Gibbs sampling steps for the RBM to 3000 and used contrastivedivergence . During the first 45 epochs we linearly annealed the activation function slope usedin the Gumbel trick, from 5 to 500. Afterwards, we continued the training for another 45 epochs,afterwards we froze the encoder and decoder parameters and continued training the prior up to 150epochs in total. The model was trained using NVIDIA RTX A6000. We validate our model usingD-waves Advantage2_prototype2.3 for inference. It has been well documented how QAs can reacha freeze-out state , akin to glass-forming melts under a fast quench . Despite this, it hasbeen shown that the distribution in this freeze-out state can be approximated with a Boltzmanndistribution . We estimate the effective inverse temperature of the QA by means of a mappingwith an attractive fix point at the QAs effective inverse temperature. This mapping is robust andconverges faster than the method used in . In we show, (a), RBM log-likelihood vs epochsestimated via (reverse) annealed importance sampling , (b), a set of iterations to estimatethe QA effective inverse temperature and, (c), the RBM energy histograms obtained from classicalMonte Carlo and QA sampling. : Normalized histograms comparing Geant4 simulated data (ground truth) and Calo4pQVAEsreconstruction, classically sampled synthetic data, and quantum annealed (Zeyphr) synthetic datafor 10k events in: (a) sparsity index, ratio of non-hit voxels over all voxels in a shower, (b) energyper event, sum of all voxel energies in a shower, and (c) granularity, randomly shifted differences invoxel energies along angular and radial bins in a shower. In we show the histograms for sparsity index (defined as the ratio between zero-energy voxelsand total number of voxels), the energy per event and the shower standard deviation of the showerangular fluctuation, for ground truth, reconstruction, classical samples and QA samples. In wecompare the mean energy along the radial, angular and axial axis between the ground truth and ourmodel. In we present the Frchet physics distance (FPD) and the Kernel physics distance(KPD) scores between our synthetic data and the Geant4 data, using the JetNet package . Thesevalues are within the limits of the models analyzed in the CaloChallenge . There are additionalmetrics as part of the CaloChallenge that we will consider as an immediate continuation of this work. : Solid vs dotted line plots comparing Geant4 simulated data and classical Calo4pQVAEsclassically sampled synthetic data for 100k events. (a) Mean energy deposit per layer, (b) angularand (c) radial bin. Relative and absolute errors for each parameter are shown underneath each plot,respectively.",
  "Conclusion": "In this paper we presented our 4-partite quantum-assisted deep generative model for calorimetersynthetic data generation. This framework provides competitive performance for simulating particleshowers at the LHC experiments while running extremely quickly on D-wave quantum annealers.The quality of the synthetic data is average compared to other approaches . This may be duein part to the sparse connectivity of the RBM, which mimics the QA connectivity. In addition toRBM connectivity, our framework could benefit from using attention layers similar to , which weleave for future work. Furthermore, Ref. presents an improved model that reaches KPD andFPD values of the order of 0.9 103 and 450 103, making our framework competitive comparedto the frameworks analyzed in the CaloChallenge . The generation time using GPU is dominated by the block Gibbs sampling steps to reach equilibrium.However, the number of steps to reach equilibrium is strongly dependent on training . In ourframework, we used 3000 steps, which is more than typically used. Under these conditions, thegeneration time per event using GPU is roughly 500 times faster than Geant4. Although the annealingtime per sample using QPU is 20 s, there is technical overhead. Under the previous conditions,the generation time per event using QPU is roughly one order of magnitude faster than using GPU.A more rigorous analysis is required in this comparison, due to the nuances involved in estimatingthe generation time using QPU and using GPU, and since our preliminary results indicate that theydiffer by one order of magnitude. We leave this for future work and reiterate that our framework issignificantly faster than Geant4. In conclusion, our work on Calo4pQVAE demonstrates the utilityof hybrid classical and quantum frameworks in generative AI. This hybrid framework opens newopportunities for leveraging large-scale quantum simulations as priors within deep generative modelsfor high-energy physics and potentially beyond.",
  "and Disclosure of Funding": "We gratefully acknowledge Jack Raymond, Mohammad Amin, Trevor Lanting and Mark Johnsonfor their feedback and discussions. We gratefully acknowledge funding from the National ResearchCouncil (Canada) via Agreement AQC-002, Natural Sciences and Engineering Research Council(Canada), in particular, via Grants SAPPJ-2020-00032 and SAPPJ-2022-00020. This research wassupported in part by Perimeter Institute for Theoretical Physics. Research at Perimeter Instituteis supported by the Government of Canada through the Department of Innovation, Science andEconomic Development and by the Province of Ontario through the Ministry of Research, Innovationand Science. The University of Virginia acknowledges support from NSF 2212550 OAC Core: Smart Surrogates for High Performance Scientific Simulations and DE-SC0023452: FAIR Surrogate Bench-marks Supporting AI and Simulation Research. JQTM acknowledges a Mitacs Elevate PostdoctoralFellowship (IT39533) with Perimeter Institute for Theoretical Physics.",
  "David Rousseau. Experimental particle physics and artificial intelligence. In Artificial Intelli-gence for Science: A Deep Learning Revolution, pages 447464. World Scientific, 2023": "Luke de Oliveira, Michela Paganini, and Benjamin Nachman. Learning particle physics byexample: location-aware generative adversarial networks for physics synthesis. Computing andSoftware for Big Science, 1(1):4, 2017. Michela Paganini, Luke de Oliveira, and Benjamin Nachman. Accelerating science withgenerative adversarial networks: an application to 3d particle showers in multilayer calorimeters.Physical review letters, 120(4):042003, 2018. Michela Paganini, Luke de Oliveira, and Benjamin Nachman. Calogan: Simulating 3d highenergy particle showers in multilayer electromagnetic calorimeters with generative adversarialnetworks. Physical Review D, 97(1):014021, 2018.",
  "ATLAS collaboration et al. Fast simulation of the ATLAS calorimeter system with generativeadversarial networks. ATLAS PUB Note, CERN, Geneva, 2020": "Georges Aad, Brad Abbott, Dale C Abbott, A Abed Abud, Kira Abeling, Deshan KavishkaAbhayasinghe, Syed Haider Abidi, Asmaa Aboulhorma, Halina Abramowicz, Henso Abreu,et al. Atlfast3: the next generation of fast simulation in ATLAS. Computing and software forbig science, 6(1):7, 2022. Erik Buhmann, Sascha Diefenbacher, Engin Eren, Frank Gaede, Gregor Kasieczka, AnatoliiKorol, and Katja Krger. Decoding photons: Physics in the latent space of a bib-ae generativenetwork. In EPJ Web of Conferences, volume 251, page 03003. EDP Sciences, 2021.",
  "Thandikire Madula and Vinicius M Mikuni. Calolatent: Score-based generative modelling inthe latent space for calorimeter shower generation. Neurips ML4PhysicalSciences, 2023": "Sehmimul Hoque, Hao Jia, Abhishek Abhishek, Mojde Fadaie, J Quetzalcoatl Toledo-Marn,Tiago Vale, Roger G Melko, Maximilian Swiatlowski, and Wojciech T Fedorko. Caloqvae: Sim-ulating high-energy particle-calorimeter interactions using hybrid quantum-classical generativemodels. arXiv preprint arXiv:2312.03179, 2023. J Quetzalcoatl Toledo-Marin, Sebastian Gonzalez, Hao Jia, Ian Lu, Deniz Sogutlu, Ab-hishek Abhishek, Colin Gay, Eric Paquet, Roger Melko, Geoffrey C Fox, et al. Conditionedquantum-assisted deep generative surrogate for particle-calorimeter interactions. arXiv preprintarXiv:2410.22870, 2024. Walter Winci, Lorenzo Buffoni, Hossein Sadeghi, Amir Khoshaman, Evgeny Andriyash, andMohammad H Amin. A path towards quantum advantage in training deep generative modelswith quantum annealers. Machine Learning: Science and Technology, 1(4):045028, 2020.",
  "Vivek Dixit, Raja Selvarajan, Muhammad A Alam, Travis S Humble, and Sabre Kais. Trainingrestricted boltzmann machines with a d-wave quantum annealer. Frontiers in Physics, 9:589626,2021": "Michele Faucci Giannelli, Gregor Kasieczka, Claudius Krause, Ben Nachman, Dalila Salamani,David Shih, Anna Zaborowska. Fast calorimeter simulation challenge 2022 - dataset 1,2 and 3[data set]. zenodo. 2022. Online; ac-cessed TO FILL. Andrew D King, Alberto Nocera, Marek M Rams, Jacek Dziarmaga, Roeland Wiersema,William Bernoudy, Jack Raymond, Nitin Kaushal, Niclas Heinsdorf, Richard Harris, et al.Computational supremacy in quantum simulation. arXiv preprint arXiv:2403.00910, 2024.",
  "Raghav Kansal, Javier Duarte1, Carlos Pareja, Lint Action, Zichun Hao, mova. jet-net/jetnet:v0.2.3.post3. 2023. Online; accessed July2024": "Claudius Krause, Michele Faucci Giannelli, Gregor Kasieczka, Benjamin Nachman, DalilaSalamani, David Shih, Anna Zaborowska, Oz Amram, Kerstin Borras, Matthew R Buckley, et al.Calochallenge 2022: A community challenge for fast calorimeter simulation. arXiv preprintarXiv:2410.21611, 2024. Aurlien Decelle, Cyril Furtlehner, and Beatriz Seoane. Equilibrium and non-equilibriumregimes in the learning of restricted boltzmann machines. Advances in Neural InformationProcessing Systems, 34:53455359, 2021."
}
{
  "Abstract": "Automated benthic image annotation is crucial to efficiently monitor and protectcoral reefs against climate change. Current machine learning approaches failto capture the hierarchical nature of benthic organisms covering reef substrata,i.e., coral taxonomic levels and health condition. To address this limitation, wepropose to annotate benthic images using hierarchical classification. Experimentson a custom dataset from a Northeast Brazilian coral reef show that our approachoutperforms flat classifiers, improving both F1 and hierarchical F1 scores byapproximately 2% across varying amounts of training data. In addition, thishierarchical method aligns more closely with ecological objectives.",
  "Introduction": "Coral reefs host around 25% of global marine species and provide vital ecosystem servicesfor coastal populations, including maintaining fish stocks, protecting shorelines from waves, andfostering tourism . Despite their importance, these ecosystems are facing unprecedented threatsfrom climate change as illustrated by the increasing frequency of coral bleaching events .In response to these challenges, comprehensive coral reef surveying and monitoring have becomeessential for implementing appropriate and timely conservation actions . Benthic monitoring focuses on measuring seafloor coverage by various organisms, especiallycorals . Over the past decades, monitoring programs have shifted from direct underwater measure-ments to photographic methods , creating lasting records and significantly reducing underwatertime. Traditionally, collected images were annotated manually using specialized software, involvingsampling random points and labeling them with their benthic categories (). These annotationsserve to calculate cover proportions, which are essential for coral monitoring. However, manual annotation is time-consuming, which can delay the availability of survey results, andcan introduce bias due to differences between analysts . To address this, platforms like CoralNet use deep learning for automatic annotation . Small pixel patches (typically 224x224) are extractedaround each point and the problem of point annotation is addressed as an image classification task(). This way, ecologists only need to manually annotate a small subset of images, which areused to train a neural network capable of automatically annotating the remaining images. During our collaboration between data scientists and marine ecologists, we identified a misalignmentbetween Machine Learning (ML) approaches and ecological needs. Current models use detailedlabels encompassing various taxonomic levels and coral health status. For instance, a point labeledas Bleached Palythoa\" simultaneously conveys information about coral type, genus, and healthstatus (). However, in practice, ecologists often need to aggregate these labels differently tocompute cover proportions of macro groups, e.g., grouping all corals regardless of species or health.",
  "arXiv:2412.08228v1 [cs.CV] 11 Dec 2024": ": Benthic image annotation process A predetermined number of random points aresampled within a fixed area and annotated with the corresponding organism or substrate. The relativefrequencies are used as proxies for cover proportions of benthic categories within the sampled area. investigate the application of Hierarchical Classification (HC) to benthic image annotation,a novel approach in this field. This multi-level prediction strategy has the potential to improveperformance by allowing partially correct predictions. Furthermore, we argue that evaluating modelperformance with hierarchical metrics would more accurately reflect real-world ecologicalpractices. By aligning our approach with the inherent hierarchical structure of benthic organisms, weaim to enhance both the performance and ecological relevance of automated coral reef monitoring.",
  "Methodology": "Hierarchical Classification (HC) consists in organizing classes into a hierarchy, represented as atree (). This structure reflects the natural relationships between classes, with generalcategories at higher levels and specific subcategories at lower levels. Two main approaches exist:local approaches, often called top-down\", train separate classifiers for each node of the hierarchy,while global approaches build a single, comprehensive model considering the entire hierarchysimultaneously. In this paper, we evaluate the potential of top-down HC for benthic image annotation.",
  "Building the Hierachy": "Implementing HC for coral images requires a paradigm shift in how the label set is designed. Marineecologists must establish a classification tree representing the taxonomic hierarchy, rather than a flatset of labels. Building an HC tree requires answering several design questions: Can a predictionbe composed of multiple labels? Can multiple path lead to the same label? Can predictions stop atintermediate nodes? As the goal of this work is to validate the relevance of HC for benthic imageannotation, we choose the most simple tree design possible where the final prediction is always asingle leaf node, and there is only one path to each label. The tree (Appendix A) was designed in acollaboration between an ML expert and a marine ecologist to ensure both computational constraintsand biological relevance are respected. While this initial step represents an additional effort, it helpsaligning the annotation process with biological classification principles and facilitates subsequentecological analyses involving grouping labels at various taxonomic levels.",
  "Hierarchical Classifier": "The first step to annotate an image is to extract 224x224 patches around the annotation points. Eachpatch is passed through the CoralNet backbone, an EfficientNet B0 pre-trained on 16 million benthicimages , to extract features. Then, a top-down hierarchical classifier is implemented. We use thehiclass library and train a Local Classifier per Parent Node approach. This approach consist ofusing an independent classifier for each non-leaf node. In our case, we use MLPs with two hiddenlayers (200 and 100 neurons) as the individual node classifiers.",
  "Dataset": "For the experiments, we used a custom dataset, collected and annotated by the Marine EcologyLaboratory/UFRN, at Rio do Fogo, Northeast Brazil. Between 2017 and 2022, 100 images werecollected from 2 sites every 3 months. We utilized a subset of 1,549 images, each annotated with 25random points, resulting in 38,725 annotations. The dataset contains 54 distinct labels, which arehighly imbalanced 11 labels account for 95% of the annotations, while 24 classes count less than20 annotations. The distribution of annotate patches is detailed in Appendix B. We created a test setby randomly selecting 10% of the dataset, maintaining the overall class distribution. Test patcheswere chosen independently, without considering image-level coherence.",
  "Baseline": "Current approaches typically train a flat classifier with a large set of labels corresponding to all leafnodes . Ecologists can subsequently group these labels to calculate the cover of super-classes,such as all corals\" . This post-hoc grouping task can be viewed as bottom-up\" hierarchicalclassification. In this work, we compare a traditional bottom-up approach MLP with 2 hidden layers(200, 100) against the proposed top-down approach, which considers the hierarchy during training.",
  "Evaluation Metrics": "Traditional benthic image annotation approaches employ standard classification metrics (e.g., ac-curacy, precision, recall, F1-score), evaluating a models ability to make perfect predictions acrossall taxonomic levels. However, considering the hierarchical nature of benthic classifications, notall misclassifications have equal ecological significance. For instance, misclassifying a BleachedPalythoa as a non-bleached Palythoa has less impact on derived ecological metrics than misclassifyingit as Algae. The former error affects only leaf-node accuracy, while the latter affects cover estimatesat all levels. To address this nuance, we use Hierarchical Classification (HC) metrics , whichaccount for the varying severity of classification errors based on their position in the hierarchy. Inour study, we compare top-down and bottom-up approaches using both the traditional F1-score(F1) and the hierarchical F1-score (hF1). This dual evaluation allows us to assess the impact ofincorporating hierarchical information during training on both perfect label prediction and partiallyaccurate predictions. By doing so, we aim to provide a more comprehensive evaluation that alignswith the hierarchical nature of benthic classification and its ecological implications.",
  "Results": "Our experimental results are displayed in , where we compare the F1-score and hierarchicalF1-score for the flat and hierarchical classifiers when the number of training patches increases. Itshows that the hierarchical classifier always outperforms the flat classifier, with performance gainsranging from 1% (for small training sets) to 2% (for larger sets). Interestingly, the performance gap between the two approaches remains similar for the hierarchicalF1-score, contrary to our expectation that this metric would more severely penalize errors early in thetree structure for the flat classifier. This suggests that the flat classifier may implicitly capture some ofthe hierarchical relationships between classes. If the flat classifier were making largely implausibleerrors, we would expect a more substantial difference in the hierarchical F1-score.",
  "Conclusion": "In this work, we investigated the potential benefits of using hierarchical classification for benthicimage annotation. Our experimental results indicate that HC outperforms traditional flat classifiersacross both flat and hierarchical metrics. However, the flat classifier is more robust than anticipatedto hierarchical F1-score, possibly due to its ability to learn some inherent class relationships. Furtherinvestigation into the specific types of errors made by each classifier could provide additional insightsinto their respective strengths and limitations. To gain a deeper understanding of the performance of HC for benthic image annotation, we plan toapply this methodology to other datasets to contextualize these results and assess their significance.For instance, the Moorea Labeled Corals dataset contains a larger number of annotations and asimpler hierarchical structure, which could provide additional insights. Although building the tree represents an additional effort, it enables better consideration of the labelsused, avoids overlapping categories or unnecessary labels, and facilitates subsequent ecologicalanalyses, which often involve grouping labels at various taxonomic levels. To alleviate the workloadof tree construction, a promising research direction to improve our approach is to investigate howthis process can be automated and refined to enhance class discrimination . Additionally,exploring alternative hierarchical classification methods, such as global HC, could represent avaluable contribution. Finally, while our results demonstrate the potential of HC, the modest performance gains ( 2%) neces-sitate careful consideration of the trade-off between improved accuracy and increased computationalcosts associated with training and inferring with multiple classifiers in a hierarchical setups. Thisbalance will be crucial in determining the applicability of HC in benthic image annotation tasks.",
  "P. L. Jokiel, K. S. Rodgers, E. K. Brown, J. C. Kenyon, G. Aeby, W. R. Smith, and F. Farrell, Comparisonof methods used to estimate coral cover in the hawaiian islands, PeerJ, vol. 3, p. e954, 2015": "O. Beijbom, P. J. Edmunds, C. Roelfsema, J. Smith, D. I. Kline, B. P. Neal, M. J. Dunlap, V. Moriarty,T.-Y. Fan, C.-J. Tan et al., Towards automated annotation of benthic survey images: Variability of humanexperts and operational modes of automation, PloS one, vol. 10, no. 7, p. e0130312, 2015. I. D. Williams, C. S. Couch, O. Beijbom, T. A. Oliver, B. Vargas-Angel, B. D. Schumacher, and R. E.Brainard, Leveraging automated image analysis tools to transform our capacity to assess status and trendsof coral reefs, Frontiers in Marine Science, vol. 6, p. 222, 2019.",
  "J. Wehrmann, R. Cerri, and R. Barros, Hierarchical multi-label classification networks, in Internationalconference on machine learning.PMLR, 2018, pp. 50755084": "F. M. Miranda, N. Khnecke, and B. Y. Renard, HiClass: a Python Library for Local HierarchicalClassification Compatible with Scikit-learn, Journal of Machine Learning Research, vol. 24, no. 29, pp.117, 2023. [Online]. Available: A. W. Aued, F. Smith, J. P. Quimbayo, D. V. Candido, G. O. Longo, C. E. Ferreira, J. D. Witman, S. R.Floeter, and B. Segal, Large-scale patterns of benthic marine communities in the brazilian province, PloSone, vol. 13, no. 6, p. e0198452, 2018."
}
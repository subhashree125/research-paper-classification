{
  "Abstract": "Deep learning still struggles with certain kinds of scien-tific data. Notably, pretraining data may not provide cov-erage of relevant distribution shifts (e.g., shifts induced viathe use of different measurement instruments). We considerdeep learning models trained to classify the synthesis con-ditions of uranium ore concentrates (UOCs) and show thatmodel editing is particularly effective for improving gener-alization to distribution shifts common in this domain. Inparticular, model editing outperforms finetuning on two cu-rated datasets comprising of micrographs taken of U3O8aged in humidity chambers and micrographs acquired withdifferent scanning electron microscopes, respectively.",
  ". Introduction": "The morphological features of nuclear materials can pro-vide information about the processing conditions used toproduce the materials and the history of the materials aftertheir production . For uranium ore concentrates (UOCs)the precipitation chemistry and calcination conditions havebeen shown to impart certain morphological features thatallow particles observed by scanning electron microscopy(SEM) to be correlated back to the synthesis conditions. Aging studies have looked at how UOC propertiesand particle morphologies change over time during expo-sure to different storage conditions, particularly humidityand temperature .A number of analytical methods have been developedfor morphological analysis of nuclear materials, includingqualitative descriptions , quantitative measurement ofparticles by image segmentation or other particle siz-ing methods, texture analysis , and machine learning.Deep learning models for morphological analysis have beentrained in supervised , self-supervised , and unsu-pervised settings . The robustness of these models toout-of-distribution (OOD) data has been investigated ,",
  "*Equal contribution": "along with methods for uncertainty quantification (UQ) orcalibration of prediction confidence and source-free do-main adaptation (SFDA) for covariate shifts .Computer vision models for predicting the provenanceof nuclear materials must be robust to statistic-level vari-ations (i.e., the appearance of images taken with variousmicroscopes and in varying settings), and to some extent,feature-level variations (i.e., changes to the actual mor-phological characteristics). Whereas SFDA has only beendemonstrated for the former, model editing methods could potentially be used for both types of distribution shiftsand can be applied to existing validated models incremen-tally as new kinds of distribution shifts are discovered withlower computational needs than other methods.",
  ". Description of data": "The training and validation datasets consist of scanningelectron microscope (SEM) images collected of UOCs rep-resenting five precipitation pathways ammonium diu-ranate (ADU), ammonium uranyl carbonate (AUC), magne-sium diurante (MDU), sodium diuranate (SDU), and uranylperoxide (UO4H2O) that have been converted to threeuranium oxides uranium trioxide (UO3), triuranium oc-toxide (U3O8), and uranium dioxide (UO2). The micro-graphs were collected using an FEI Nova NanoSEM 630scanning electron microscope with the through lens detec-tor (TLD) operating in secondary electron (SE) mode. Morecomplete descriptions of the material synthesis and data col-lection can be found elsewhere . Previouswork has shown that classification models trained on earlier",
  "arXiv:2407.15756v1 [cs.LG] 22 Jul 2024": "versions of this dataset fail to generalize to new data thatdiffers by process history and/or imaging parameters .We consider two different concept distribution shifts, anaging shift and a detector shift: The dataset for the aging editing task uses micrographs ofmaterials that were initially U3O8 produced by calciningeither AUC or UO42H2O. The starting U3O8 was thenaged under conditions that cycled between high temper-ature/humidity and low temperature/humidity followinga 24-hour daily cycle; samples were pulled at time stepsof {0, 14, 36, 43, 54, 60} days to collect morphology databy SEM and measure crystallographic changes by X-raydiffraction (XRD) . We provide examples in . The detector editing task uses micrographs of the samematerials as the train and validation sets but collected ona different SEM, a FEI Teneo SEM with the T2 SE de-tector . Example images in .Tab. 1 provides the number of images in our train and val-idation splits for the base dataset (for training our model)and the concept datasets (for the editing task).",
  ". Methods for model updating": "Model editing makes tweaks to model weights to incorpo-rate new facts , semantics , and behaviors. Such methods have been used to patch model errorsin the form of spurious correlations and confusion with only a single input example. We focus on the setting ofnatural distribution shifts, where we want to adapt modelsto inherent variations in the data largely in the form ofinput/statistical-level variations (the detector editing task)and feature-level variations (the aging editing task).Let f be a neural network defined as a composition oflayers f = fL fL1 f2 f1, where fl(x) = (Wlx)and Wl is an nl nl1 matrix for each l = 1, . . . , L with anactivation function . For any layer, let fl denote the com-position of the first l layers: flfl1 f2f1. In contrastwith other work, e.g. , we do not use exemplarpairs (x, x, y) of transformed images x with a fixed labely to update a model so that fl(x) fl (x). Instead, weupdate our model on new pairs of datapoints x and labelsy from either the aging shift or the detector shift and usestochastic gradient descent (SGD) so that f(x) y. Thisis a fairly significant difference from some of the editingmethods discussed above, however we keep the editing ter-minology because our methods modify single-layers withconstrained updates and/or a limited number of examples.We next describe the two model update methods weuse in this work.We compare these update methodsto a baseline of full finetuning, where all model weightsW1, . . . , WL, are updated with stochastic gradient descent(SGD) to minimize the mean squared error (MSE) of f(x)and y.Low-rank model editing: the edit is an update Wl 0d14d24d36d43d54d60d Evaluation on D day Aging 0d 14d 24d 36d 43d 54d 60d Editing model for D day Aging 100% 51%36%48%59%34%27% 96%83%58%65%73%49%30% 96%85%89%94%89%74%33% 96%91%86%97%84%69%33% 96%71%68%71%81%53%20% 85%77%62%67%75%49%30% 100% 65%42%52%75%35%73% 0.0 0.2 0.4 0.6 0.8 1.0",
  "(c) Baseline model (unedited) accuracy": ". Comparison of how well models finetuned on an ag-ing dataset D generalize to other ages. Both surgical finetuning((a)) and low-rank editing ((b)) generalize to earlier ages. Also,all edited models outperform the baseline accuracy in (c)). Notethat because we drop runs that incur an accuracy drop on the base-line validation set of > 1.5%, there are no succesful full-modelfinetuning runs. See for a more permissive threshold. Wl + UV T where U and V are low-rank matrices learnedvia SGD to minimize the MSE of f(x) and y; in our ex-periments we fix the rank to r = 2. The model weightsW1, . . . , WL, are kept frozen. We use the implementation described in where U and V are 11 convolutions whenapplied to the weights of convolutional layers.Surgical finetuning: we largely follow , updating onlya subset of layers with SGD to minimize the MSE of f(x)and y. In order to make a more precise comparison withlow-rank model editing, we deviate from and optimizeonly a single layer, Wl, rather than blocks of layers. This isalso called local finetuning in .",
  ". Experiments": "For both datasets, our goal is to adapt the model for the newdomain while maintaining the models performance on theoriginal dataset. On the aging dataset, this means updating amodel to be accurate on the set of images and labels (x, y)that have undergone the D 24-hour cycles of aging, whilemaintaining performance on the original unaged datapoints(x, y). Similarly, for the detector dataset the model is up-dated to be accurate on datapoints taken from both the T2SE detector and the original detector.We use a ConvNeXt-Small model trained with SGDon the original SEM image dataset with a validation accu-racy of 97.9%. For each of the model updating methods,we perform a coarse grid search over learning rates for eachconvolutional layer, and then a finer-grained grid searchover the two best performing layers for each method. Tochoose the best performing hyperparameters for an update,we employ the hyperparameter selection strategy from ,where we select 50% of the dataset examples (for a givenage D for the aging dataset or for the images taken from theT2 SE detector) to learn the update and to select the best hy-perparameters and the remaining 50% to test performance.A hyperparameter run is dropped if it causes the model per-formance on the original SEM validation set to drop below agiven threshold (e.g., a threshold of 1.5% drop for anda substantially more permissive 7% threshold for ).",
  ". Aging Experiments": "The aging editing task comprises seven different materialaging time steps. We use this dataset structure to evalu-ate how well models edited with images of age D general-ize to other durations of particle aging. In other words, weask how well a model update captures the relevant morphol-ogy of aging as opposed to the particulars of the collecteddataset/aging timing. For example, we examine how wella material aged for D = 43 days performs on unaged con-trol samples (0 days), earlier ages (aging for 14, 24, and 36days, respectively) and later ages (54 and 60 days). summarizes the results of the aging experiments.The diagonal elements capture the performance of a modelon the targeted aging duration whereas off-diagonal ele-ments capture the generalization of those models to otheraging durations. The performance of the original model (without any updates) is plotted in c. Because all full-model finetuning runs incurred substantial accuracy dropson the base (non-aged) validation set, we also plot perfor-mance for a more permissive threshold in . Note thatall of the model update methods surgical finetuning, low-rank editing, and even the baseline full-model finetuning forthe permissive threshold exhibit partial generalizationacross different ages. The generalization to shorter agingdurations is stronger than for longer ones.Comparing rows of a to those of b, we seethat low-rank editing outperforms surgical finetuning on thetargeted aging duration (e.g., editing a model on 43-day ag-ing examples and testing on held-out 43-day aging exam-ples) as well as on other aging datasets (e.g., editing a modelon 43-day aging examples and testing on hold-out data forD = 43). For example, in the aging tasks for 43 days and54 days, low-rank editing has better editing performancefor the target editing task by 15% for 43 days and 44% for54 days of aging. For the off-target editing generalizationto other aging sets, low-rank editing outperforms surgicalfine-tuning as much as 27%. Both update methods increasemodel aging accuracy over the baseline model in cand over full finetuning in , and are targeted, i.e., donot pay substantial performance costs on the original SEMdataset. We expect that the better targeting of editing is dueto regularization, where we update only a single-layer forsurgical finetuning and single-layer with a low-rank restric-tion for low-rank editing.Finally, we note that all update methods have worse gen-eralization on the 60-day aging data. While the updates onthe 60-day aging duration achieve reasonable performanceon the held-out 60-day set, they do not generalize well toD = 60. Likewise, updating a model for D = 60 leadsto relatively minimal increases in accuracy for D = 60.We hypothesize that this poor performance is due to slightlydifferent collection conditions for the 60-day micrographs,where a different scientist collected the SEM samples. Thissuggests that the success of model updates is sensitive tothe image collection parameters; rather than editing for thechanges in surface morphology seen in D = 60 materials,edits were made on the style (e.g., brightness, contrast) ofthe image. We expect that editing performance will increasewhen using editing prototypes that better reflect the diver-sity in SEM images, however we leave this to future work.",
  ". SEM Detector Experiments": "The detector editing task captures input-level and statisti-cal changes in the distribution of SEM images due to us-ing a different scanning electron microscope. In general,this task is more challenging for the editing methods underconsideration. While editing does provide performance im-provement over the baseline unedited model, the accuracyincreases are modest. Box plots of model accuracy across 0d14d24d36d43d54d60d Evaluation on D day Aging 0d 14d 24d 36d 43d 54d 60d Editing model for D day Aging 100% 51%32%48%59%29%13% 100% 97%86%94%88%71%50% 96%93%96% 100% 95%76%40% 96%93%85%97%85%69%37% 100% 95%93%97%99%94%53% 100% 95%92%94%97%99%60% 100% 81%66%64%83%47%80% 0.0 0.2 0.4 0.6 0.8 1.0",
  "(c) Full finetuning accuracy": ". Comparison for how well models updated for an aging dataset D generalize to other ages, allowing up to a 7% drop in accuracyon the original validation set. Even for this more aggressive editing setting (as opposed to , which used a threshold of 1.5%), surgicalfinetuning and low-rank editing tend to outperform full finetuning. The aging accuracies for the unedited model are given in c.",
  ". Conclusions and Future Work": "We find that we can update models trained to predict theprocessing conditions of uranium ore concentrates to bet-ter handle a common domain-specific distribution shifts.Model editing methods perform particularly well on the setof aging distribution shifts, representing feature-level mor-phological changes in the SEM images. This has the po-tential to be particularly useful for designing future agingstudies and incorporating their data, where model edits for aduration D can be reliably expected to generalize to shorterdurations (and to a lesser but still notable extent, longerones).The detector distribution shift, reflecting lower-levelvariation in the statistics of input samples, proved more dif-ficult. We are particularly optimistic about two directionsfor future work. First, we think that more targeted mixturesof image examples used for editing may better capture rel-evant directions of variation. For example, using exemplarsfrom multiple detectors may allow for better generalizationon a held-out detectors. Second, strong results in this do- Low-rank editing Surgical finetuningFull finetuning 30% 35% 40% 45% 50% 55% 60% 65% 70% Performance on detector data Baseline detector accuray",
  ".Model editing performance on the T2 SE detectordataset": "main have been achieved by using generative models to aidedomain adaptation . Related to domain adaptation, re-cent work has leveraged generative models to automaticallydiscover failure modes and debug them . Such ap-proaches may find a favorable balance between the domaincoverage of generative methods with the fine-grained tar-geting of model editing.",
  ". Acknowledgements": "This research was supported by the Mathematics for Ar-tificial Reasoning in Science (MARS) initiative at PacificNorthwest National Laboratory.It was conducted un-der the Laboratory Directed Research and Development(LDRD) Program at at Pacific Northwest National Labo-ratory (PNNL), a multiprogram National Laboratory oper-ated by Battelle Memorial Institute for the U.S. Departmentof Energy under Contract DE-AC05-76RL01830. Erik C Abbott, Hiram E OConnor, Cody A Nizinski, Lo-gan D Gibb, Elijah W Allen, and Luther W McDonald IV.Thermodynamic evaluation of the uranyl peroxide syntheticroute on morphology. Journal of Nuclear Materials, 561:153533, 2022. 1 David Bau, Steven Liu, Tongzhou Wang, Jun-Yan Zhu, andAntonio Torralba. Rewriting a deep generative model. InComputer VisionECCV 2020: 16th European Conference,Glasgow, UK, August 2328, 2020, Proceedings, Part I 16,pages 351369. Springer, 2020. 1, 2, 3",
  "Atoosa Chegini and Soheil Feizi. Identifying and mitigatingmodel failures through few-shot clip-aided diffusion genera-tion. arXiv preprint arXiv:2312.05464, 2023. 5": "Lorenzo Fongaro, Doris Mer Lin Ho, Knut Kvaal, KlausMayer, and Vincenzo V Rondinella. Application of the anglemeasure technique as image texture analysis method for theidentification of uranium ore concentrate samples: New per-spective in nuclear forensics. Talanta, 152:463474, 2016.1 L Fongaro, M Marchetti, IB Lande, M Wallenius, and KMayer. Development of a new approach for a rapid identi-fication and classification of uranium powders using colour,image texture and spectroscopy signatures. Publications Of-fice of the European Union, Luxembourg, 2021. 1 M Girard, A Hagen, I Schwerdt, M Gaumer, L McDonald,N Hodas, and E Jurrus. Uranium oxide synthetic pathwaydiscernment through unsupervised morphological analysis.Journal of Nuclear Materials, 552:152983, 2021. 1",
  "ysis of -u3o8. ACS omega, 6(28):1842618433, 2021. 1,2": "Alexa B Hanson, Ian J Schwerdt, Cody A Nizinski,Rachel Nicholls Lee, Nicholas J Mecham, Erik C Abbott,Sean Heffernan, Adam Olsen, Michael R Klosterman, SeanMartinson, et al. Impact of controlled storage conditions onthe hydrolysis and surface morphology of amorphous-uo3.ACS omega, 6(12):86058615, 2021. 1 Peter Hase, Mona Diab, Asli Celikyilmaz, Xian Li, ZornitsaKozareva, Veselin Stoyanov, Mohit Bansal, and SrinivasanIyer. Methods for measuring, updating, and visualizing fac-tual beliefs in language models. In Proceedings of the 17thConference of the European Chapter of the Association forComputational Linguistics, pages 27142731, Dubrovnik,Croatia, 2023. Association for Computational Linguistics. 2 Sean T Heffernan, Nhat-Cuong Ly, Brock J Mower, ClementVachet, Ian J Schwerdt, Tolga Tasdizen, and Luther W Mc-Donald IV. Identifying surface morphological characteris-tics to differentiate between mixtures of u3o8 synthesizedfrom ammonium diuranate and uranyl peroxide. Radiochim-ica Acta, 108(1):2936, 2019. 1 Gabriel Ilharco, Marco Tulio Ribeiro, Mitchell Wortsman,Suchin Gururangan, Ludwig Schmidt, Hannaneh Hajishirzi,and Ali Farhadi. Editing models with task arithmetic. In-ternational Conference on Learning Representations, 2022.2 Jakob Johnson, Luther McDonald, and Tolga Tasdizen. Im-proving uranium oxide pathway discernment and generaliz-ability using contrastive self-supervised learning. Computa-tional Materials Science, 233:112748, 2024. 1 Yoonho Lee, Annie S Chen, Fahim Tajwar, Ananya Kumar,Huaxiu Yao, Percy Liang, and Chelsea Finn. Surgical fine-tuning improves adaptation to distribution shifts. In NeurIPS2022 Workshop on Distribution Shifts: Connecting Methodsand Applications, 2022. 3",
  "Zhuang Liu, Hanzi Mao, Chao-Yuan Wu, Christoph Feicht-enhofer, Trevor Darrell, and Saining Xie. A convnet for the2020s. CVPR, 2022. 3": "Cuong Ly, Cody Nizinski, Alex Hagen, Luther McDon-ald IV, and Tolga Tasdizen. Improving robustness for modeldiscerning synthesis process of uranium oxide with unsuper-vised domain adaptation. Frontiers in Nuclear Engineering,2:1230052. 1, 2, 5 Cuong Ly, Clement Vachet, Ian Schwerdt, Erik Abbott,Alexandria Brenkmann, Luther W McDonald, and TolgaTasdizen. Determining uranium ore concentrates and theircalcination products via image classification of multiplemagnifications. Journal of Nuclear Materials, 533:152082,2020. 1 Luther W McDonald IV, Kari Sentz, Alex Hagen, Bran-don W Chung, Cody A Nizinski, Ian J Schwerdt, AlexaHanson, Scott Donald, Richard Clark, Glenn Sjoden, et al.Review of multi-faceted morphologic signatures of actinideprocess materials for nuclear forensic science. Journal ofNuclear Materials, page 154779, 2023. 1",
  "Eric Mitchell, Charles Lin, Antoine Bosselut, Chelsea Finn,and Christopher D. Manning. Fast model editing at scale.ICLR, 2022. 1, 2": "Cody A Nizinski, Cuong Ly, Clement Vachet, Alex Hagen,Tolga Tasdizen, and Luther W McDonald IV. Characteriza-tion of uncertainties and model generalizability for convolu-tional neural network predictions of uranium ore concentratemorphology. Chemometrics and Intelligent Laboratory Sys-tems, 225:104556, 2022. 1, 2 Adam M Olsen, Bryony Richards, Ian Schwerdt, SeanHeffernan, Robert Lusk, Braxton Smith, Elizabeth Jurrus,Christy Ruggiero, and Luther W McDonald IV. Quantifyingmorphological features of -u3o8 with image analysis fornuclear forensics. Analytical chemistry, 89(5):31773183,2017. 1",
  "Adam M Olsen, Ian J Schwerdt, Bryony Richards, andLuther W McDonald IV. Quantification of high temperatureoxidation of u3o8 and uo2. Journal of Nuclear Materials,508:574582, 2018. 1": "Indu Panigrahi, Ryan Manzuk, Adam Maloof, and RuthFong.Improving data-efficient fossil segmentation viamodel editing. In Proceedings of the IEEE/CVF Conferenceon Computer Vision and Pattern Recognition (CVPR) Work-shops, pages 48294838, 2023. 2 Kevin J Pastoor, Shane L Robinson, R Allan Greenwell,Camila V Quintero Hilsaca, Jenifer C Shafer, and Mark PJensen. Understanding uranium oxide hardening during pro-longed storage. Radiochimica Acta, 108(12):943953, 2020.1 Shibani Santurkar, Dimitris Tsipras, Mahalaxmi Elango,David Bau, Antonio Torralba, and Aleksander Madry. Edit-ing a classifier by rewriting its prediction rules. In Advancesin Neural Information Processing Systems, pages 2335923373. Curran Associates, Inc., 2021. 2 Ian J Schwerdt, Casey G Hawkins, Bryan Taylor, AlexandriaBrenkmann, Sean Martinson, and Luther W McDonald IV.Uranium oxide synthetic pathway discernment through ther-mal decomposition and morphological analysis. Radiochim-ica Acta, 107(3):193205, 2019. 1 Lucas E Sweet, Thomas A Blake, Charles H Henager,Shenyang Hu, Timothy J Johnson, David E Meier, Shane MPeper, and Jon M Schwantes.Investigation of the poly-morphs and hydrolysis of uranium trioxide. Journal of Ra-dioanalytical and Nuclear Chemistry, 296:105110, 2013. 1 Alison L Tamasi, Kevin S Boland, Kenneth Czerwinski, Ja-son K Ellis, Stosh A Kozimor, Richard L Martin, Alison LPugmire, Dallas Reilly, Brian L Scott, Andrew D Sutton,et al. Oxidation and hydration of u3o8 materials followingcontrolled exposure to temperature and humidity. Analyticalchemistry, 87(8):42104217, 2015. 1 Alison L Tamasi, Leigh J Cash, Christopher Eley, Reid BPorter, David L Pugmire, Amy R Ross, Christy E Ruggiero,Lav Tandon, Gregory L Wagner, Justin R Walensky, et al.A lexicon for consistent description of material images fornuclear forensics. Journal of Radioanalytical and NuclearChemistry, 307:16111619, 2016. 1 Alison L Tamasi, Leigh J Cash, William Tyler Mullen, Ali-son L Pugmire, Amy R Ross, Christy E Ruggiero, Brian LScott, Gregory L Wagner, Justin R Walensky, and Mari-anne P Wilkerson. Morphology of u 3 o 8 materials follow-ing storage under controlled conditions of temperature andrelative humidity. Journal of Radioanalytical and NuclearChemistry, 311:3542, 2017. 1"
}
{
  "Abstract": "We revisit certain problems of pose estimation based on3D2D correspondences between features which may bepoints or lines. Specifically, we address the two previously-studied minimal problems of estimating camera extrinsicsfrom p {1, 2} pointpoint correspondences and l = 3plineline correspondences. To the best of our knowledge, allof the previously-known practical solutions to these prob-lems required computing the roots of degree 4 (univari-ate) polynomials when p = 2, or degree 8 polynomi-als when p = 1. We describe and implement two elemen-tary solutions which reduce the degrees of the needed poly-nomials from 4 to 2 and from 8 to 4, respectively.Weshow experimentally that the resulting solvers are numer-ically stable and fast: when compared to the previous state-of-the art, we may obtain nearly an order of magnitudespeedup. The code is available at",
  ". Motivation": "The problem of registering images to a known 3D coordi-nate system plays a crucial role in applications such as vi-sual localization , autonomous driving , and aug-mented reality , as well as in general paradigms likeSLAM and SfM .Robust estimators based onRANSAC , or one of its many refinements , areamong the most successful tools for solving these prob-lems. Such an estimator traditionally relies on a minimalP3P solver to efficiently hypothesize posesfrom putative matches between 3D and 2D points.The literature on P3P and other purely point-based meth-ods for absolute pose estimation is vast. Absolute pose esti-mation from non-point features such as lines , point-line incidences , and affine correspon-dences , has received comparatively less attention, butremains an active research area. In particular, solutions re-lying on both points and lines are of increasing importance,due to the prevalence of both types of feature in man-madeenvironments, as well as several recent advances in the com-",
  ". Contribution": "In this paper, we revisit the two minimal problems of ab-solute pose estimation that combine both points and lines:the Perspective-2-Point-1-Line Problem (or P2P1L, Sec-tion 2.1), and the Perspective-1-Point-2-Line Problem(P1P2L, .2.) See for illustrations.In contrast to the purely point or line based minimalproblems P3P and P3L, we observe that the existing solu-tions for the mixed cases considered here are suboptimalfrom both a theoretical and practical point of view. Con-sequently, we develop novel solutions to both problems,which optimally exploit their underlying algebraic struc-ture, and exhibit comparable or better performance than thestate of the art on simulated and real datasee .On the other hand, these solvers are simple to implement,and no knowledge of mathematics beyond elementary alge-bra is needed to understand them.To provide further context for our work, we include thefollowing quotation from : Although we do not theo-retically prove that our solutions are of the lowest possibledegrees, we believe so because of the following argument.The best existing solutions for pose estimation using three",
  "arXiv:2404.16552v1 [cs.CV] 25 Apr 2024": "points and three lines use 4th and 8th degree solutions re-spectively. Since mixed cases are in the middle, our solu-tions for (2 points, 1 line) and (1 point, 2 lines) cases use4th and 8th degree solutions respectively. Recently, it wasshown using Galois theory that the solutions that use thelowest possible degrees are the optimal ones [].Contrary to the informal reasoning presented above, weclaim that the existing solutions to the mixed pointlinecases are not optimal. As far as we know, the only supportfor this claim appearing in the literature prior to our workoccurs in . This previous work showed, on the ba-sis of Galois group computation, that the P2P1L and P1P2Lproblems decompose into simpler subproblems. However,this theoretical observation was not accompanied by a prac-tical solution method for either problem. In this paper, werectify the situation by devising practical solvers for bothproblems that incorporate these recent insights.To complete our discussion of what makes a solution al-gebraically optimal, we recall one proposal of such a no-tion from work of Nister et al. . In this work, a re-stricted class of algorithms Pn is considered for each natu-ral number n 1: an algorithm in Pn consists of a finitesequence of steps, each of which extracts the roots of somepolynomial equation p(x) = 0, with either p(x) = xm a(where a Q and deg(p) = m can be arbitrary), or withdeg(p) n and the coefficients of p belonging to a fieldcontaining Q and any previously-computed roots. In thissetting, a solution is optimal if it leads to solving a poly-nomial system of the lowest possible degree. Our proposedsolutions immediately establish that P2P1L is P2-solvableand P1P2L is P4-solvable. It should be of little surprise thatP2P1L is not P1-solvable; therefore, we may say that oursolution to P2P1L is algebraically optimal. On the otherhand, the problem P1P2L is also P3-solvable. This is be-cause any quartic equation can be solved by the standardmethod which reduces the problem to computing the rootsof the associated resolvent cubic. Thus, our solution, whichcomputes the roots of a quartic with this same method, isalso algebraically optimal in the sense of . The sameobservation, of course, holds for the classical quartic-basedmethods for solving P3P. Alternative P3P solvers that di-rectly employ a cubic , despite being superior in prac-tical terms, are not distinguished by the complexity classesPn. provides a summary of the algebraic complex-ities, based on the Galois groups computed in .",
  ". Related work": "The first solutions to P2P1L and P1P2L were presented byRamalingam et al. , reducing the problems to comput-ing the roots of polynomials of degree 4 and 8 via carefulchoices of special reference frames in the world and image.Although we obtain polynomials of lower degree, these spe-cial reference frames are also an ingredient in our approach.In work subsequent to , it was observed that both ofthese problems could be solved using the E3Q3 solver .This is a highly optimized method for computing the pointswhere three quadric surfaces in R3 intersect.Typically,there are 23 = 8 such points, by Bezouts theorem; how-ever, EQ3Q also handles degenerate cases where the num-ber of solutions may drop. In the follow-up work , a sta-bilization scheme for E3Q3 was applied to these problems,and experimentally shown to be more accurate than thesolvers in . Efficient solvers for both problems basedon this stabilized E3Q3 are implemented in PoseLib .The idea of using Galois groups to study minimal prob-lems originates from . The main takeaway from this pa-per is that a problem with n solutions whose Galois groupis the full symmetric group Sn cannot be solved by an al-gorithm in Pn1. In the other direction, the main takeawayfrom is that if the Galois group is contained in the wreathproduct Sn1 Sn2, where n = n1n2, then the problem canbe solved with an algorithm in Pmax(n1,n2). A recent workusing such an insight to guide the more efficient solution ofa relative pose estimation problem may be found in .",
  ". Minimal solvers": "In this section, we introduce our algebraically optimal so-lutions to the P2P1L and P1P2L problems. These prob-lems are depicted in . As revealed by the Galoisgroup computed in , the problem P2P1L can be re-duced to computing the roots of a quadratic equation, andthe problem P1P2L can be reduced to a quartic equation.In Sections 2.1 and 2.2, we turn these insights into explicitsolutions to the P2P1L and P12PL problems, respectively.These solutions work genericallythey are valid outside ofa measure-zero subset of the space of input point-point/line-line correspondences. In .3, we describe a methodthat stabilizes the P1P2L solver of .2 in a commonbut non-generic case. Finally, .4 for a discussionwhen the point-line configuration is coplanar.",
  ". P2P1L": "Here, we provide the algebraically optimal solution to theP2P1L problem. We mostly follow the notation of .Problem Statement: Consider P 01 , P 02 R3, two 3Dpoints, and their 2D projections under an unknown cali-brated camera. Consider also a 3D line spanned by pointsL03, L04 R3 and its projection. The goal is to recover the",
  ". Special reference frame for P2P1L. Camera frame C0is transformed to C1, world frame W0 to W1. See text for details": "unknown camera matrix, whose center we denote by C0.Our first step is to rigidly transform the input into thespecial reference frame introduced in . Transforming tothis special frame simplifies the equations and helps to re-veal the algebraically optimal solution. illustratesthe input reference frame C0 / W0 (top), and the specialframe C1 / W1 (bottom), which are related as follows: In the world frame W1, the 3D points take the form",
  "D3 =000T ,D4 =100T .(5)": "To find the transformation C0 C1, let D03 and D04 be thehomogeneous coordinates of two distinct points along thegiven line. Independently of C0, we may rigidly trans-form the rays d3 :=C0D03, and d4 :=C0D03 to CD3 andCD4, by suitable rotation and translation.Let us now write R = (Rij)1i,j3, T = (Ti)1i3 for theunknown camera pose in this special reference frame. Ourprojection constraints can then be written as",
  ". P1P2L": "Here, we provide the algebraically optimal solution to theP1P2L problem. We mostly follow the notation of .Problem Statement: Let us consider a 3D point P 01 R3, and its homogeneous 2D projection D1 R3 underan unknown calibrated camera matrix. Let us also considertwo 3D linesthe first spanned by points L1, L2 R3, andthe second one is spanned by L3, L4 R3and both oftheir corresponding projections. Our task is to recover thecamera matrix from the given point-point correspondenceand line-line correspondences.Much like the P2P1L solver, our P1P2L solver begins bytransforming the input data into a special reference frame,as illustrated in . Specifically, In the world frame, the 3D point takes the form",
  "1v4 + 2v3 + 3v2 + 4v + 5 = 0.(41)": "After solving for v, we can solve for R21, R22 using (33),and for the other equations using (34), and (30).To summarize, we provide the outline of steps for solv-ing the P1P2L absolute pose problem in . Alge-braically, the nontrivial steps in are second andthird, which require solving a univariate quartic equationand computing square roots, respectively.",
  ". Stabilizing the P1P2L Solver": "In this section, we outline a method to increase the stabilityof the P1P2L solver (Sec. 2.2).Our proposed P1P2L solution faces a degeneracy whenZ1 Z2 = 0, since this leads to a division by zero in equa-tion (29). Furthermore, our observations indicate that theresult of the solver is unstable if the value of Z1 Z2 isclose to zero. Note, that this instability is specific to oursolver and not inherent to the P1P2L problem.This degeneracy may be interpreted geometrically as fol-lows: the values of Z1 and Z2 are the last coordinates ofthe points L1, L2, which span the first 3D line. Therefore,the vector L1 L2 represents the direction of the line, andZ1 Z2 represents the last coordinate of this direction.Since the special reference frame used in .2 isindependent of the rotation of the world frame, we can re-move the source of instability by rotating the world framesuch that the first line L1L2 aligns with the z-axis. See Fig-ure 6 for an illustration.",
  ". Resolving the coplanar case": "In this section, we discuss the performance of the P2P1L(Sec. 2.1) and P1P2L (Sec. 2.2) solvers in the case, whereall 3D points and 3D lines are coplanar.P2P1L. The P2P1L solver presented in Sec. 2.1 (P2P1L nofix) is degenerate in coplanar situations, since then Z4 = 0(2), causing a division by zero issue in equation (11). To re-solve this issue, we propose a modified solver (P2P1L fix),which handles the coplanar case. See SM A for a descrip-tion of this modified solver.P1P2L. The original version of the P1P2L solver (P1P2Lno fix, Sec. 2.2) is able to handle the coplanar case. How-ever, the stabilized P1P2L solver (P1P2L fix, Sec. 2.3) failsdue to a degeneracy for coplanar input.We conducted a synthetic experiment to evaluate the im-pact of the proposed stablization scheme. In this experi-ment, we used the same setting as in .1. The re-",
  ". Runtime The mean, median and max values of the run-time. In nanoseconds. Best values for each problem are bold": "sults, presented in demonstrate that solvers P2P1Lno fix and P1P2L fix achieve superior numerical stability inthe generic case, while solvers P2P1L fix and P1P2L no fixhandle the coplanar case. Since it is simple to detect thecoplanar case, we recommend to use solvers P2P1L fix andP1P2L no fix in the coplanar case and solvers P2P1L no fixand P1P2L fix in the generic case.",
  ". Experiments": "In this section, we experimentally compare the proposedsolvers with the state-of-the-art methods, specifically 3Q3 and Ramalingam . For 3Q3, we employ the pub-licly available implementation from Poselib. As the im-plementation of Ramalingam is not publicly accessible, wehave created our own implementation. Since it is not explic-itly specified which method should be used for solving thelinear equations, we compare with two variants: SVD andLU decomposition. All the solvers have been implementedin C++, and the experiments are conducted on a desktopcomputer with an AMD Ryzen 9 CPU with 3.9 GHz.In Sec. 3.1, we provide an analysis of the numerical sta-bility and runtime performance of the solvers on syntheticdata. Subsequently, in .2, we present an evaluationof the solvers within the RANSAC scheme.",
  ". Synthetic experiments": "In this section, we present an analysis of the numerical sta-bility and runtime performance of the minimal solvers onsynthetic data.We generate instances of each minimal problem (eitherP2P1L or P1P2L), according to the following procedure: Rotation Matrix (R): An axis v R3 is sampled fromthe uniform distribution on the unit sphere, and an angle is sampled from the normal distribution N(0, 1). Therotation matrix R is then constructed using the angle-axisformula, R = I + sin()[v] + (1 cos())[v]2.",
  "Translation (T): The camera center C is sampled uni-formly at random from the unit sphere. The translationvector T is computed as T = RC": "Point correspondence: A 3D point Xi is sampled fromthe trivariate normal distribution with mean vector =T and standard deviation = 1 in each compo-nent. The corresponding 2D point Di is obtained by pro-jecting Xi onto a pinhole camera with the pose (R, T). Line correspondence: Two 3D points, Li and Li+1, aresampled as described in the previous bullet-point. Thesepoints define the 3D line L. Two 2D points, Di and Di+1,are obtained by sampling two points on the 3D line L andprojecting them onto the camera with the pose (R, T).In the case of P2P1L, two points and one line are sam-pled, while in the case of P1P2L, one point and two linesare sampled. Let (Rest, Test) be the pose obtained by theminimal solver. We measure the rotation error as the an-gle R = arccos((1 + trace(RTestR))/2). We calculate thetranslation error T as T = |TestT | |T |. The histograms ofrotation errors (R) and translation errors (T ) for all con-sidered solvers are depicted in . Furthermore, sum-mary statistics including the median, mean, and maximumerrors are provided in . The results indicate thatall minimal solvers are stable. Our algebraically optimalsolvers demonstrate superior stability compared to the pre-vious solvers.The runtime evaluation for all considered solvers isshown in Table. 3. Our P2P1L solver requires 313.8ns onaverage, which is about 6x faster than the 3Q3 solver .Similarly, our P1P2L solver requires on average 504.0ns,which is about 4x faster than the 3Q3 solver. These resultsshow a significant speedup achieved by our solvers in com-parison to the previous methods.",
  ". Example images of University Library (top) and MertonCollege III (bottom), from": "We utilize the Poselib implementation of LO-RANSAC . In this implementation, local optimizationis applied both when the new solution surpasses the cur-rently best one and at the end of the entire procedure. TheRANSAC parameters used include a maximum number ofiterations set to 100000, a minimum number of iterationsset to 1000, a success probability of 0.9999, and an inlierthreshold of 1 pixel. To ensure a fair comparison betweenthe solvers, we use a fixed random seed.Since all the solvers are stable, we do not expect any sig-nificant difference in the estimated pose when using differ-ent solvers. Therefore, our primary focus is on comparingthe runtime of the RANSAC scheme. The runtime com-parison is presented in , which displays the averageruntime for each scene in the Oxford multiview dataset and for each considered solver. Additionally, the table includesa speedup value compared to the 3Q3 solver of . Theresults show that our solvers consistently outperform the3Q3 and Ramalingam solvers in terms of runtime.However, there is a notable variation in the speed-up amongthe scenes, which ranges from 0.85 to 0.98 for the P2P1Lproblem and from 0.28 to 0.90 for the P1P2L solver. Thisvariation can be attributed to the fact that different scenesrequire varying proportions of time spent by RANSAC onscoring hypothesized models and local optimization. Themore time is dedicated to these tasks, the less significantspeedup can be reached. In cases with fewer matches or alower inlier ratio, more substantial speedups are possible.The final pose estimation errors in RANSAC are shownin the Supplementary. As expected, the errors are the samefor all solvers. This demonstrates that we can achieve im-proved runtimes without sacrificing any accuracy.",
  ". Conclusion": "In revisiting absolute pose from mixed point-line correso-pondences, we have developed new solvers, which have themerit of being both algebraically optimal and elementary innature. Moreover, our solvers outperform the state-of-the-art in terms of both runtime and numerical stability. Despitethe simplicity of many minimal absolute pose problems, ourfindings suggest that their continued investigation remainsworthwhile. The code is available at",
  "Homer H. Chen. Pose determination from line-to-plane cor-respondences: Existence condition and closed-form solu-tions. IEEE Trans. Pattern Anal. Mach. Intell., 13(6):530541, 1991. 1": "Ondrej Chum, Jiri Matas, and Josef Kittler. Locally opti-mized RANSAC. In Pattern Recognition, 25th DAGM Sym-posium, Magdeburg, Germany, September 10-12, 2003, Pro-ceedings, pages 236243. Springer, 2003. 8 Michel Dhome, Marc Richetin, Jean-Thierry Lapreste, andGerard Rives. Determination of the attitude of 3d objectsfrom a single perspective view. IEEE Trans. Pattern Anal.Mach. Intell., 11(12):12651278, 1989. 1 Yaqing Ding, Jian Yang, Viktor Larsson, Carl Olsson, andKalle Astrom. Revisiting the P3P problem. In IEEE/CVFConference on Computer Vision and Pattern Recognition,CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023,pages 48724880. IEEE, 2023. 1, 2 Timothy Duff, Viktor Korotynskiy, Tomas Pajdla, and Mar-garet H. Regan. Galois/monodromy groups for decomposingminimal problems in 3d reconstruction. SIAM Journal onApplied Algebra and Geometry, 6(4):740772, 2022. 2",
  "Martin A. Fischler and Robert C. Bolles. Random sampleconsensus: A paradigm for model fitting with applications toimage analysis and automated cartography. Commun. ACM,24(6):381395, 1981. 1": "Christian Hane, Lionel Heng, Gim Hee Lee, Friedrich Fraun-dorfer, Paul Furgale, Torsten Sattler, and Marc Pollefeys. 3dvisual perception for self-driving cars using a multi-camerasystem: Calibration, mapping, localization, and obstacle de-tection. Image Vis. Comput., 68:1427, 2017. 1 Robert M. Haralick, Chung-Nan Lee, Karsten Ottenberg, andMichael Nolle. Review and analysis of solutions of the threepoint perspective pose estimation problem. Int. J. Comput.Vis., 13(3):331356, 1994. 1 Petr Hruby, Viktor Korotynskiy, Timothy Duff, Luke Oed-ing, Marc Pollefeys, Tomas Pajdla, and Viktor Larsson.Four-view geometry with unknown radial distortion.InIEEE/CVF Conference on Computer Vision and PatternRecognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023, pages 89909000. IEEE, 2023. 2",
  "Xiaomei Hu, Luying Zhu, Ping Wang, Haili Yang, and XuanLi. Improved ORB-SLAM2 mobile robot vision algorithmbased on multiple feature fusion. IEEE Access, 11:100659100671, 2023. 1": "Laurent Kneip, Davide Scaramuzza, and Roland Siegwart. Anovel parametrization of the perspective-three-point problemfor a direct computation of absolute camera position and ori-entation. In The 24th IEEE Conference on Computer Visionand Pattern Recognition, CVPR 2011, Colorado Springs,CO, USA, 20-25 June 2011, pages 29692976. IEEE Com-puter Society, 2011. 1 Zuzana Kukelova, Jan Heller, and Andrew W. Fitzgibbon.Efficient intersection of three quadrics and applications incomputer vision. In 2016 IEEE Conference on ComputerVision and Pattern Recognition, CVPR 2016, Las Vegas, NV,USA, June 27-30, 2016, pages 17991808. IEEE ComputerSociety, 2016. 2, 7, 8",
  "Viktor Larsson and contributors. PoseLib - Minimal Solversfor Camera Pose Estimation, 2020. 2, 8": "Shaohui Liu, Yifan Yu, Remi Pautrat, Marc Pollefeys, andViktor Larsson. 3d line mapping revisited. In IEEE/CVFConference on Computer Vision and Pattern Recognition,CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023,pages 2144521455. IEEE, 2023. 1 David Nister, Richard I. Hartley, and Henrik Stewenius. Us-ing galois theory to prove structure from motion algorithmsare optimal.In 2007 IEEE Computer Society Conferenceon Computer Vision and Pattern Recognition (CVPR 2007),18-23 June 2007, Minneapolis, Minnesota, USA. IEEE Com-puter Society, 2007. 2 Remi Pautrat, Daniel Barath, Viktor Larsson, Martin R. Os-wald, and Marc Pollefeys. Deeplsd: Line segment detectionand refinement with deep image gradients.In IEEE/CVFConference on Computer Vision and Pattern Recognition,CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023,pages 1732717336. IEEE, 2023. 1 Remi Pautrat, Iago Suarez, Yifan Yu, Marc Pollefeys, andViktor Larsson.Gluestick:Robust image matching bysticking points and lines together.In Proceedings of theIEEE/CVF International Conference on Computer Vision,pages 97069716, 2023. 1 Mikael Persson and Klas Nordberg. Lambda twist: An ac-curate fast robust perspective three point (P3P) solver. InComputer Vision - ECCV 2018 - 15th European Conference,Munich, Germany, September 8-14, 2018, Proceedings, PartIV, pages 334349. Springer, 2018. 1, 2",
  "Jonathan Ventura, Clemens Arth, Gerhard Reitmayr, andDieter Schmalstieg.Global localization from monocularSLAM on a mobile phone. IEEE Trans. Vis. Comput. Graph.,20(4):531539, 2014. 1": "Chi Xu, Lilian Zhang, Li Cheng, and Reinhard Koch. Poseestimation from line correspondences: A complete analysisand a series of solutions. IEEE Trans. Pattern Anal. Mach.Intell., 39(6):12091222, 2017. 1 Lipu Zhou, Jiamin Ye, and Michael Kaess. A stable alge-braic camera pose estimation for minimal configurations of2d/3d point and line correspondences. In Computer Vision- ACCV 2018 - 14th Asian Conference on Computer Vision,Perth, Australia, December 2-6, 2018, Revised Selected Pa-pers, Part IV, pages 273288. Springer, 2018. 1, 2",
  "A. P2P1L in the coplanar case": "Here, we describe the modified version of the P2P1L solver(Sec. 2.1) capable of handling the coplanar case. The inputand output to this solver are the same as those of the originalP2P1L solver.The solver is identical to the original P2P1L solver untilEquation (12). Then, we express values R11, R31, R22 interms of R21, R23 as"
}
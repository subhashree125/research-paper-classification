{
  "Abstract": "This paper presents a novel non-rigid point set regis-tration method that is inspired by unsupervised clusteringanalysis. Unlike previous approaches that treat the sourceand target point sets as separate entities, we develop aholistic framework where they are formulated as cluster-ing centroids and clustering members, separately. We thenadopt Tikhonov regularization with an 1-induced Lapla-cian kernel instead of the commonly used Gaussian ker-nel to ensure smooth and more robust displacement fields.Our formulation delivers closed-form solutions, theoreticalguarantees, independence from dimensions, and the abilityto handle large deformations. Subsequently, we introducea clustering-improved Nystrom method to effectively reducethe computational complexity and storage of the Gram ma-trix to linear, while providing a rigorous bound for the low-rank approximation. Our method achieves high accuracyresults across various scenarios and surpasses competitorsby a significant margin, particularly on shapes with sub-stantial deformations.Additionally, we demonstrate theversatility of our method in challenging tasks such as shapetransfer and medical registration. [Code release]",
  ". Introduction": "Non-rigid point set registration is to optimize a non-lineardisplacement field that accurately aligns one geometricshape with another.Due to its fundamental importance,non-rigid registration plays a dominant role in a wide rangeof applications, such as scene reconstruction ,pose tracking , animation , deformable shape ma-nipulation and editing , and so on.However, given two point sets, one acting as the sourceand the other as the target, non-rigid registration presentsa highly ill-posed and much more complex challenge com-pared to the rigid counterpart. This increased complexityis primarily attributed to the additional freedom of defor-mations allowed in non-rigid registration, especially whendealing with shapes that exhibit large deformations ().To enhance the registration quality for shapes under-going large deformations, numerous pioneering methodshave been actively researched. Rather than directly opti-mizing the registration process, these methods usually em-ploy a two-step approach . First, they per-form shape matching by identifying corresponding pointsbetween the source and target shapes without consideringgeometry deformations. Then, they estimate the alignmenttransformation based on the established correspondencesvia off-the-shelf registration techniques. While there has",
  "arXiv:2406.18817v1 [cs.CV] 27 Jun 2024": "been significant attention and research dedicated to the ini-tial shape matching stage, the exploration of direct registra-tion methods for handling large deformations, without rely-ing on shape matching, is comparatively limited and posessubstantial challenges .In this work, we address the problem of non-rigid pointset registration without correspondences, with a specificemphasis on point sets exhibiting large deformations. Toovercome this challenge, we present a fresh perspective andintroduce a novel method. Our approach reformulates thenon-rigid deformation process as an unsupervised cluster-ing problem within the context of machine learning. Unlikeprevious approaches that treat the two point sets as separateentities, we consider them as integral parts of a whole.Concretely, we designate the source point set as the clus-tering centroids, while the target one as the clustering sam-ples. This holistic treatment enables us to leverage the in-terplay between these two sets.Then the dynamic opti-mization and update of the clustering centroids correspondto the underlying deformation of the source shape.Wehighlight the advantages of our novel registration function,which is built on clustering analysis, from both informationtheory and convex optimization perspectives. Furthermore,we provide closed-form solutions to our objective functionduring each iteration, which enables fast and efficient im-plementations. We introduce a sparsity-induced Laplaciankernel (1-norm) in the Tikhonov regularization to ensurethat the displacement field of clustering centroids remainsas smooth as possible. This differs from the commonly usedGaussian kernel and exhibits higher robustness, as demon-strated by experimental results. Additionally, we leverageclustering analysis to adopt the improved Nystrom low-rankapproximation , which reduces the computational com-plexity and storage requirements of the Gram matrix to lin-ear. Meanwhile, we give a rigorous proof of the approxima-tion error bound associated with the Laplacian kernel.Our method is independent of spatial dimensions, allow-ing us to evaluate and compare its performance in both 2Dand 3D settings. The experimental results demonstrate thesuperiority of our method compared to baselines by a largemargin. This is particularly evident in scenarios involvinglarge deformations, such as shape transfer and medical dataregistration.Our contributions can be summarized as follows: We propose a novel and correspondence-free method fornon-rigid point set registration, utilizing unsupervisedclustering analysis. The method achieves impressive re-sults across various settings and mitigates the challengewithout explicit correspondences.",
  "We review the work that is closely aligned with ours. Read-ers are directed to for comprehensive studies": "Non-rigid registration.Differing from shape match-ing that focuses on finding inlier correspondences, non-rigid registration aims to optimize the displacement field.Various pioneering algorithms employ an optimizationparadigm that minimizes both the data and penalty termssimultaneously. Amberg et al. extended the rigid itera-tive closest point algorithm to non-rigid settings, whileYao et al. recently improved non-rigid ICP re-garding both accuracy and efficiency through deformationgraph optimization. Coherent Point Drift (CPD) andGMM developed probabilistic frameworks by mini-mizing the negative logarithm likelihood function to en-hance the robustness for non-rigid point set registration.Ma et al. further incorporated the shape context de-scriptor to establish shape correspondences for better2D registration. Hirose recently formulated CPDin a Bayesian setting, which effectively overcomes CPDslimitations and delivers impressive results.With the advancement of deep learning, neural network-based methods have also been proposed for non-rigid pointset registration . Most of them utilize neural net-works to extract features for point correspondences and thenapply classical methods such as non-rigid ICP for registra-tion. Instead of focusing on shape matching and heavilyrely on data annotations, our method is unsupervised andreasons from a case-by-case geometric perspective. Thisallows us to achieve faithful registrations that are more gen-eralizable to unknown categories. Deformation representation.The representation of thedeformation field is a key component in non-rigid registra-tion. Several existing works are based on thin plate splinefunctions , which can be viewed as a regular-ization of the second-order derivatives of the transforma-tions . Another line of researches utilize kernel func-tions or a reproducing kernel Hilbert space to describe thedeformation field . However, many of thesemethods are limited to the Gaussian kernel due to the re-liance on fast Gauss transform . Recently, the Multi-Layer Perception (MLP) network has been employed to rep-resent the deformation field by mapping input coordinatesto signal values and the deformation degreeis controlled by frequencies. These methods have shownpromising results in dynamical reconstruction and sceneflow estimation, which are typically considered less chal-lenging tasks compared to dealing with large deformations.",
  ". Preliminaries on Clustering Analysis": "As one of the representative unsupervised learning frame-works, clustering analysis plays a fundamental role in var-ious scientific research domains .The pioneeringwork explored clustering metrics for rigid pointcloud registration. In contrast, we distinguish ourselves byaddressing a more challenging non-rigid problem, which wehave completely reformulated as a clustering process with adifferent objective function. We present a concise overviewon two commonly used clustering approaches: fuzzy clus-tering and Elkan k-means clustering analysis.",
  "j=1uij =1, uij , (1)": "where U = [uij]MC RMC is the fuzzy membershipdegree matrix, V = {vj Rn}Cj=1 is the set of clusteringcentroids consisting of C Z+ classes, and r [1, +) isthe fuzzy factor, which controls the clustering fuzziness. Toenhance the clustering performance on unbalanced datasets,Miyamoto et al. proposed the inclusion of cluster sizecontrolling variables = [1, , C] RC in Eq. (1),and thus classes with more samples may lead to higherfuzzy membership degree. Since Euclidean distance-basedclustering algorithms are primarily suitable for sphericaldata, Mahalanobis distance is latter introduced to general-ize the fuzzy clustering analysis to accommodate ellipsoidalstructures . Recently, combined the merits of previ-ous fuzzy clustering approaches and developed a novel clus-tering framework based on the 2,p norm, which achievesappealing results on a set of clustering analysis tasks:",
  "j=1j = 1, uij, j": "(2)where R+ is a regularization parameter, and j Sn++ {A Rnn|xT Ax > 0, x Rn} denotes thecovariance matrix of the j-th class, with the correspondingdeterminant equivalent to |j| R. We explore the ap-plication of this clustering analysis framework to non-rigidpoint set registration and demonstrate its superior perfor-mance over previous registration approaches.",
  ". Proposed Method": "Problem formulation.Given two point sets X = {xi Rn}Mi=1 and Y = {yj Rn}Nj=1, where X and Y arenamed as the target and the source, separately, the objec-tive of non-rigid point set registration is to find the optimaldeformation map T that minimizes the shape deviation be-tween T (Y) Y + (Y) and X, where represents thedisplacement filed acting on each source point yj.",
  ". Clustering-Induced Non-Rigid Registration": "Observations.We notice that during the clustering pro-cess, the spatial position of clustering centroids V are dy-namically updated until the distance between the centroidsand their members is minimized.This dynamic processbears resemblance to the iterative update of each sourcepoint T (yj). Inspired by this, we propose to formulate non-rigid registration as an unsupervised clustering process. Weconsider Y as the clustering centroids and X as the cluster-ing members. We customize Eq. (2) to optimize the overallclustering loss by",
  "j)H(U),": "where H(U) = Cj=1Mi=1 uij log(uij) is the entropyof U.From the perspective of information theory, thisentropy regularization term serves to push F(U, , , )towards U with a uniform distribution that makes H(U)the maximal and thus drags F(U, , , ) away from thesparse U. This not only enhances the smoothness of the fea-sible set, but also improves the computational stability dur-ing optimization, i.e., avoiding limuij0 log(uij) = . Optimization view.Alternatively, from an optimizationpoint of view, uij log(uij) is a convex function in terms ofuij with controlling the degree of convexity. Moreover,uij log(uij) acts as a barrier function that restricts uij tothe range of and prevents it from taking values outsidethis range .",
  "=1d(),(7)": "where {cj R}Cj=1 are the coefficient scalars, K(, ) isthe kernel function defined in Eq. (5), and {}N=1 repre-sent a set of basis in the N-dimensional null space of R(),which is typically composed by a set of polynomials formost choices of the stabilizer R().In contrast to previous approaches that commonly utilizea Gaussian Radial Basis Function (RBF) , we adoptthe sparsity-induced Laplacian kernel with the robust 1-norm to characterize the displacement field , i.e.,",
  "K(yi, yj) = exp(yi yj1), > 0(8)": "in which yi yj1 is the Manhattan distance between thetwo input vectors. Compared to the RBF kernel, the Lapla-cian kernel exhibits stronger robustness due to its consider-ably thicker tails, as illustrated in . We also validatethis conclusion through subsequent experiments.Since the Laplacian kernel is positive definite, we ob-tain 0 . By evaluating (y) at Y = {yj Rn}Cj=1, following , the coefficient vector c =[c1, c2, , cC]T RC is recovered from the following lin-ear system:",
  ". Improved Nystrom Low-Rank Approximation": "The matrix inverse operation in Eq. (9) leads to a computa-tional complexity of O(C3) and a memory requirement ofO(C2). Previous approaches often employ the fast Gausstransform (FGT) to reduce memory usage and accel-erate computation. However, FGT is merely limited to theGaussian kernel. To circumvent this issue, BCPD com-bined the Nystrom method and the KD tree search for acceleration.However, there are still two major is-sues that remain unresolved. (1) Due to the random sam-pling scheme used in BCPD, it is unclear how effective theNystrom approximation performs. (2) In order to addressconvergence issues when 2 becomes small, BCPD needto switch from Nystrom approximation to KD tree search.This transition may affect the optimization trajectory.To overcome these challenges, we opt to use clusteringanalysis instead of random sampling. Concretely, we firstemploy the fast Elkan k-means algorithm (Sec. 3.2) to par-tition Y into C disjoint clusters Pi Y, with the corre-sponding clustering centroids as {zi Rn}Ci=1 (C C).Then, we adopt the improved Nystrom approximation for efficient and consistent optimization:",
  "where E = [eij] RCC and W = [wij] RCC": "are the low-rank Laplacian kernel matrices, with elementseij = K(yi, zj) and wij = K(zi, zj).By incorporating clustering analysis, we achieve twokey benefits: (1) rigorously proving the error bound of theNystrom approximation for our utilized Laplacian kernel,and (2) as demonstrated through experiments, providing en-couraging results for non-rigid point set registration withoutcompromising the optimization trajectory.",
  "We perform extensive experiments to demonstrate the per-formance of the proposed method and compare it with state-of-the-art approaches from both 2D and 3D categories": "Implementation details.Given a pair of point sets, forbetter numerical stability, we first perform shape normal-ization to make them follow the standard normal distribu-tion. However, the registration evaluation is still based onthe original inputs through denormalization. The Laplaciankernel bandwidth is set to 2 by default, and the numberof clustering centroids in Elkan k-means equals to 0.3Cfor better trade-off between registration accuracy and effi-ciency. During optimization, we fix the two weight coef-ficients = 0.5 and = 0.1, which deliver impressiveperformance across various scenes. Our algorithm is im-plemented in MATLAB, on a computer running AMD CoreRyzen 5 3600XT (3.8GHz). We leverage publicly avail-able implementations of baseline approaches for assess-ment, with their parameters either fine-tuned by ourselvesor fixed by the original authors to achieve their best results. Evaluation criteria.As in , we adopt the Root MeanSquared Error (RMSE) to quantitatively assess the regis-tration accuracy. For point sets with known ground-truthcorrespondences, we compute the squared distance betweencorresponding points directly. However, for point sets with-out annotated correspondences, such as distinct types of ge-ometries, we identify the corresponding point pairs throughthe nearest neighbor search. Accordingly, the RMSE is de-fined as:",
  ". 2D Non-Rigid Point Set Registration": "For 2D non-rigid point set registration, we utilize the bench-mark IMM hand dataset for evaluation. This datasetencompasses 40 real images, showing the left hands of fourdistinct subjects, and each contains 10 images. As illus-trated in , the hand shape is described through 56 keypoints extracted from the contour of the hand. We employthe first pose from each group of hands as our target pointset, while the remaining poses of the same subject serve asthe source point sets. The quantitative comparison resultswith state-of-the-art 2D registration approaches includingMR-RPM , BCPD , GMM , and ZAC arereported in Tab. 1. We report the average RMSE for eachsubject along with the average registration timing of eachmethod. As observed, our method consistently outperformsthe comparative approaches with higher registration accu-racy and efficiency across all subjects. Although without theneed for constructing the initial point correspondences, likeshape context used in MR-RPM, our method still de-livers RMSE that is orders of magnitude lower than that ofmost competitors, highlighting its compelling advantages.The qualitative comparison results regarding the inputs inthe third row of are presented in .",
  ". Test samples from the 2D hand pose dataset with differ-ent subjects. The red and the blue indicate the source and thetarget point sets, respectively": "Robustness.We further investigate the robustness of thedesigned method against external disturbances includingnoise and occlusion. We add a set of Gaussian noise withzero mean and varying standard deviations [0.01, 0.06]to all of the source point sets defined in the above section.Additionally, we randomly erase several points, around3% 20% of the source, to construct a range of occlusiongeometries. summarizes the average RMSE valuesacross all subjects. It can be observed that our method stillachieves the highest or comparable registration accuracy onall settings, highlighting its stability and robustness. Qual-itative comparison results are presented in the Supplemen-tary Material.",
  ". 3D Non-Rigid Point Cloud Registration": "Since our method is dimension-independent, we furthersubstantiate its efficacy on 3D point clouds and com-pare it with eight state-of-the-art 3D registration or defor-mation approaches, including BCPD , GBCPD ,Fast RNRR , AMM NRR , Sinkhorn , aswell as network-based ones Nerfies , NDP , andNSFP . For efficiency, we downsample the point cloudsfrom datasets FAUST and TOSCA using voxel gridfiltering, with a point size of 3, 000 4, 000. More experi-ments are presented in the Supplementary Material. Registration for real human scans.Tab. 2 and re-port the quantitative and qualitative comparison results onthe FAUST human dataset, respectively. The evaluation isconducted using six sets of subjects in six different and chal-lenging poses for each subject. We first perform intra-classregistration, i.e., deforming the first human geometry to",
  ". Robustness comparisons against external disturbances": "match the other poses for the same subject. Then, to validatethe capability of the designed approach against large defor-mations, we further conduct an inter-class registration testby aligning the first human pose of the i-th subject to all theposes of the (i+2)-th subject (i = 1, 2, 3, 4). The statisticalresults summarized in Tab. 2 demonstrate that our methodachieves the highest registration accuracy across all subjectsand outperforms competitors by a significant margin, evenseveral orders of magnitude higher. Notably, while achiev-ing remarkable accuracy, our method also maintains effi-ciency comparable to most competitors, making it a highlypractical and effective solution. The qualitative comparisonresults in indicate that our method not only ensureshigher-quality deformations but also recovers the geomet-ric details as well as the topology of the target subject moreaccurately and faithfully. Registration for larger deformations.We further ver-ify whether the proposed method improves the registrationperformance for point cloud pairs with much larger de-formations. We evaluate four classes of animals from theTOSCA dataset and report the average RMSE for eachclass of them. As illustrated in , the source and tar-get point sets exhibit significant pose differences, making",
  ". Qualitative comparisons on the TOSCA dataset, wheremuch larger shape deformations exist": "and the random one on two randomly extracted FAUSTmodels. We vary the approximation ratio R [0.02, 0.4]with R = 0.02. It can be seen that our method obtainssignificant registration and timing performance boost anddecrease in matrix approximation error by a large margin,especially on lower ratios. Laplacian VS. Gaussian. summarizes both thequantitative and qualitative comparison results between thekernel functions of Gaussian and Laplacian. We validate themerits and robustness of the Laplacian Kernel by aligningthe source Bunny model contaminated by a set of noise( [0, 0.06]) to a randomly deformed Bunny. The kernelbandwidth is varied in . We report the RMSE and theaverage number of iterations when algorithms converge in 00.10.20.30.4 0.015 0.02 0.025 0.03 0.035 0.04 0.045",
  ". Applications": "Shape transfer.As depicted in , we apply theproposed method to transfer shapes belonging to differentcategories that require substantial deformations. We firsttransfer two geometries with the identical topology (sphereand cube) and then proceed to transfer CAD models fromShapeNet , which presents a more challenging task. Re-sults indicate the effectiveness of our method in achiev-ing accurate shape deformation while faithfully preservingthe geometric details of the source shapes. Notably, ourmethod consistently produces high-quality deformation re-sults even when the shapes possess significantly distincttopology. More results on shape transfer are presented inthe Supplementary Material. Medical registration.Deforming a standard medicaltemplate to match those captured from individual patientsis a crucial step in the field of medical data analysis. In, we demonstrate the efficacy of our method by align-ing a 3D inhale lung volume to two exhale lungs and twobrain vessels , extracted from real-world CT and MRAimages. Despite the presence of complex structures, largedeformations, and mutual interference, our method consis-tently achieves impressive results in accurately deformingthe template models to align the target shapes.",
  ". Conclusions": "We proposed an algorithm for solving non-rigid point setregistration without prescribed correspondences. The keycontribution of our method lies in reformulating non-rigidregistration as an unsupervised clustering process that en-ables holistic optimization, dimension-independent, closed-form solutions, and handling large deformations simultane-ously. Moreover, we introduce the 1-induced Laplaciankernel to achieve a more robust solution than the Gaussiankernel and provide a rigorous approximation bound for theNystrom method. Our method achieves higher-quality re-sults than traditional methods and recent network models,particularly on geometries that exhibit significant deforma-tions.We also showcase its applicability in challengingtasks such as shape transfer and medical registration. Acknowledgements.This work is partially funded bythe Strategic Priority Research Program of the ChineseAcademy of Sciences (XDB0640000), National ScienceandTechnologyMajorProject(2022ZD0116305),NationalNaturalScienceFoundationofChina(62172415,62272277,62376267), and the innoHK project.",
  "Alexander M Bronstein, Michael M Bronstein, and RonKimmel. Numerical geometry of non-rigid shapes. 2008.6": "Richard Castillo, Edward Castillo, David Fuentes, Moiz Ah-mad, Abbie M Wood, Michelle S Ludwig, and Thomas Guer-rero.A reference dataset for deformable image registra-tion spatial accuracy evaluation using the copdgene studyarchive. Phys. Med. Biol., 58(9):2861, 2013. 8 Angel X Chang, Thomas Funkhouser, Leonidas Guibas,Pat Hanrahan, Qixing Huang, Zimo Li, Silvio Savarese,Manolis Savva, Shuran Song, Hao Su, et al.Shapenet:An information-rich 3d model repository.arXiv preprintarXiv:1512.03012, 2015. 8",
  "Richard A Newcombe, Dieter Fox, and Steven M Seitz.Dynamicfusion: Reconstruction and tracking of non-rigidscenes in real-time. In Proc. IEEE Conf. Comput. Vis. Pat-tern Recog., pages 343352, 2015. 1": "Keunhong Park, Utkarsh Sinha, Jonathan T Barron, SofienBouaziz, Dan B Goldman, Steven M Seitz, and RicardoMartin-Brualla. Nerfies: Deformable neural radiance fields.In Proc. IEEE Int. Conf. Comput. Vis., pages 58655874,2021. 1, 2, 6, 7 Zheng Qin, Hao Yu, Changjian Wang, Yuxing Peng, and KaiXu. Deep graph-based spatial consistency for robust non-rigid point cloud registration. In Proc. IEEE Conf. Comput.Vis. Pattern Recog., pages 53945403, 2023. 1, 2"
}
{
  "Abstract": "The Agriculture-Vision Challenge at CVPR 2024 aims atleveraging semantic segmentation models to produce pixel-level semantic segmentation labels within regions of inter-est for multi-modality satellite images. It is one of the mostfamous and competitive challenges for global researchersto break the boundary between computer vision and agri-culture sectors. However, there is a serious class imbalanceproblem in the agriculture-vision dataset, which hinders thesemantic segmentation performance. To solve this problem,firstly, we propose a mosaic data augmentation with a rareclass sampling strategy to enrich long-tail class samples.Secondly, we employ an adaptive class weight scheme tosuppress the contribution of the common classes while in-creasing the ones of rare classes. Thirdly, we propose aprobability post-process to increase the predicted value ofthe rare classes. Our methodology achieved a mean Inter-section over Union (mIoU) score of 0.547 on the test set,securing second place in this challenge.",
  ". Introduction": "In the field of remote sensing agriculture, semantic seg-mentation plays a pivotal role in automatically classifyingand delineating areas of interest, such as crop types, dis-eased vegetation, and land cover, from satellite and aerialimagery . In recent years, semantic segmentation re-search has been in full swing. However, the effectivenessand efficiency of these methods are still not satisfactory foruse in agriculture recognition. Thus, the 4th Agriculture-Vision Prize Challenge aims to encourage research in devel-oping novel and effective algorithms for agricultural pattern",
  ". The number of pixels in each class": "recognition from aerial images.A major challenge persists due to the severe class im-balance present in the Agriculture-vision dataset used fortraining segmentation models. Typically, some classes areoverly represented while others are scarce, leading to mod-els that are biased towards more frequent categories andperform poorly on rarer ones.This imbalance hampersthe overall accuracy and applicability of segmentation tech-nologies in practical agricultural settings, where diverse andbalanced detection capabilities are crucial. To address thisissue, this paper explores novel approaches designed specif-ically to mitigate class imbalance in dataset preparation andmodel training.",
  ". This data flow of our final solution": "and 2019 with a resolution of up to 10 cm/pixel.Afterthe official preprocessing, it contains 94,986 aerial farmlandimages. Each image has 512512 pixels. A total of 8 pat-terns commonly found in farmlands- including weeds, end-rows, nutrient deficiency, and others are carefully annotatedby agronomy experts. The number of pixels in each class isshown as . It can be seen that the background categoryaccounts for a too high proportion. There is a significantclass imbalance within this dataset. This class imbalanceproblem presents a challenge as it may skew the perfor-mance of segmentation models, making them biased towardthe majority class while neglecting the minority class.",
  ". Class Balancing": "To solve this problem, we address it from the three aspectsincluding data pre-process, loss function, and probabilitypost-process.For the class-balance data pre-process, we calculate thesampling probability of each class based on the frequency ofall classes in the dataset so that the long-tail classes are sam-pled more often . However, directly adding the sampledimages to the training set is prone to overfitting problems inlong-tail categories. To alleviate this problem, we introducemosaic augmentation to diversify the rare class samples.For the class-balance loss function, we calculate theweight of each category based on the number of samplesof each class that have participated in the training . Thefewer the number of categories, the greater the weight. Thisallows rare classes to participate more in model training toalleviate the problem of sample imbalance.We propose a class-balance post-process.After themodel outputs a probability value for each class, we di-rectly multiply the probability of the rare class by 2.0 andthe probability of the background class by 0.95.Thismethod can improve the predicted probability of the rareclass and prevent it from being overwhelmed by the back-ground class.",
  "baseline0.452baseline+ACWLoss0.492baseline+ACWLoss+RCS Mosaic0.516baseline+ACWLoss+RCS Mosaic+Post0.524": "this work is illustrated in . We concatenate the RGBand NIR images as a four-channel input. The data augmen-tations are employed to enrich the training set. We chooseFPN , DeeplabV3+ , Segformer , and UperNet as the basic model architecture with MixVisionTrans-former (Mit) and EfficientNet . The test time aug-mentation (TTA) is utilized to improve the performance ofeach single model. After that, we utilize the math average asthe basic ensemble to fuse the class probabilities predictedby these single models. Finally, the post-process is intro-duced to refine the ensemble results.",
  ". Implement Details": "All the experiments are conducted with a single NVIDIARTX 4090-24GB GPU on Ubuntu 22.04 LTS OS. Theproposed method is implemented based on PyTorch-1.8.1+cu111.In this study, the Adamw is used as anoptimizer with a weight decay of 0.01.The batch sizeis set to 16.The learning rate is initialized to 6e-6,and its descent strategy is a poly policy formulated as1 iter max iterpower, power = 0.9. We use the warm-upstrategy before the learning rate descends.Additionally,the model is trained with 160000 iterations. Several widelyused data augmentation strategies, i.e., random resize andcrops, random horizontal and vertical flips, random rota-tion, and colorjitter are utilized. The cropping size is set as512 512. The mIoU is utilized as the evaluating metric.",
  ". Result and Analysis": "The results to analyze the effectiveness of the componentare listed in . It can be seen that the recognition ac-curacy is improved a lot after utilizing the data pre-process,loss function, and probability post-process. To analyze theeffect of the model architectures and backbones, we selectUperNet , DeeplabV3+ , FPN , and Segformer as the comparing architecture, and ResNet , LSKNet, Mit , and EfficientNet as the comparing back-bones. presents the results. It can be seen thatthe Mit and EfficientNet backbones can yield better perfor-mance than others. The model architecture does not havemuch impact on the results. We ensemble the models thatare signed by * and use the post-process to refine the en-semble probability resulting in the best score.",
  ". Conclusion": "In this paper,we propose our solution to the 4thAgriculture-Vision Challenge in CVPR 2024. We proposea mosaic augmentation with rare class sampling making thenumber of long-tail category samples enriched while the di-versity of the dataset has been expanded. We introduce anadaptive loss reweighting scheme. It suppresses the exces-sive participation of common classes in training, while thecontribution of long-tail classes to network optimization hasalso been improved. We design a probability post-processstrategy. The mean accuracy in all classes has been im-proved. We finally accomplished a mIoU of 0.547, achiev-ing 2nd place in this challenge.",
  "Liang-Chieh Chen, Yukun Zhu, George Papandreou,Florian Schroff, and Hartwig Adam. Encoder-decoderwith atrous separable convolution for semantic imagesegmentation. In ECCV, pages 801818, 2018. 2": "Mang Tik Chiu, Xingqian Xu, Yunchao Wei, ZilongHuang, Alexander Schwing, Robert Brunner, HrantKhachatrian, Hovnatan Karapetyan, Ivan Dozier, GregRose, et al.Agriculture-vision: A large aerial im-age database for agricultural pattern analysis. arXive-prints, 2020. 1 Mang Tik Chiu, Xingqian Xu, Yunchao Wei, Zi-long Huang, Alexander G. Schwing, Robert Brun-ner, Hrant Khachatrian, Hovnatan Karapetyan, IvanDozier, Greg Rose, David Wilson, Adrian Tudor,Naira Hovakimyan, Thomas S. Huang, and HonghuiShi. Agriculture-vision: A large aerial image databasefor agricultural pattern analysis. In CVPR, 2020. 1"
}
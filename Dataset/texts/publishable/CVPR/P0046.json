{
  "Abstract": "This work presents the INBD network proposed by Gillert et al. and studies its applicationfor delineating tree rings in RGB images of Pinus taeda cross sections captured by a smartphone(UruDendro dataset), which are images with different characteristics from the ones used to trainthe method. The INBD network operates in two stages: first, it segments the background, pith,and ring boundaries.In the second stage, the image is transformed into polar coordinatesand ring boundaries are iteratively segmented from the pith to the bark.Both stages arebased on the U-Net architecture. The method achieves an F-Score of 77.5, a mAR of 0.540,and an ARAND of 0.205 on the evaluation set. The code for the experiments is available at",
  ": Samples from UruDendro dataset": "delineation of the tree rings is tedious and sometimes very time-consuming. As seen in ,tracing the rings is perturbed by the presence of knots, geometrical irregularities, cracks, and stains.Recently, some approaches have been developed to automatize this process or at least help thepractitioners. No method works fine in general, given the particularities of the species, and thecommon approach is to manually trace the rings.In this work, we briefly study INBD, a deep neural network-based approach presented in originally developed for automatically delineating annual rings in microscope images of shrubs. Fig-ure 4 illustrates some examples of those images, part of the EH dataset . We train the networkto automatically delineate tree rings in cross-section images of Pinus taeda. As seen in ,these images are of very different resolutions, and the texture is very different due to the speciescharacteristics. This dataset is named UruDendro, and its samples are from trees planted in thenorthern part of Uruguay .Even if the INBD method was originally designed for microscopy images of shrub cross-sections,the global structure is the same: a pith surrounded by concentric annual growth rings in the diskscenter. Given this, we use the original model, trained on the EH dataset, and refine the model withthe Urudendro dataset.We make two small modifications to the authors implementation. The INBD authors originallytrained the model by applying a 4x resize factor to the images, reducing the raw resolution (between2000 and 3500 pixels wide) to a final resolution between 500 and 875 over the EH dataset. TheUrudendro dataset size images vary between 700 and 3500 pixels in width. We decide to have afixed input size of 1500 pixels in the largest dimension, regardless of the original sizes of the imagesto be treated. This is the optimal size found in to process the UruDendro dataset, consideringthe width of the rings. In this way, we dont lose resolution on the thicker rings. Secondly, wesubstitute the bilinear interpolation used by the authors with a Lanczos one, using the use Pillow3 library. Therefore, we trained the INBD model on the EH dataset (provided by the INBD authors)using the same fixed resolution of 1500 pixels in the largest dimension.We followed a specific procedure to conduct our experiments4. First, we resized the EH datasetto 1500 pixels (longest dimension) while maintaining the aspect ratio. Next, we trained the INBDmethod using the resized EH dataset. We then resized the UruDendro dataset to 1500 pixels (longestdimension) and fine-tuned the INBD network on this resized dataset using the pre-trained model withthe EH dataset. Finally, we evaluated the INBD model using the metrics provided in and .",
  "The INBD method": ": Overview of the INBD pipeline. An input image is first passed through a generic semantic segmentation networkthat detects 3 classes: background, ring boundaries, and the pith region. A polar grid is sampled starting from the borderof the detected pith region (the first ring) and passed to the main INBD network that detects the next ring. This processis repeated until the background is encountered. Image taken from . illustrate the INBD architecture. The input of the network is a cross-section of a treeimage. The input image is first segmented into the background, ring boundaries, and pith region.The cross-section image is then transformed into polar coordinates, with the piths center as theorigin. Iteratively rectangular image patches are extracted, allowing individual ring segmentationfrom the inner one (closer to the pith) to the outer rings (closer to the bark). In the second step ofthe INBD method, the segmented regions obtained in the first step are used as follows: the pithscenter is used as the origin of the polar coordinates transformation, the ring boundaries are used todetermine the width of the rectangular image patches and the background is used as a stop criterionin the iterative process. The second step can be interpreted as a refinement of the pixels assigned tothe ring boundary category in the first step, plus a transformation of these pixels to the mathematicalobject curve. Both stages utilize a U-NET network.",
  "Training": "The training of this method is made in two steps (): first, the Segmentation Network fis trained, and then the INBD Network g. The training must be done sequentially because thetraining procedure for the network g needs the network f (more details can be found in ).To train the INBD model with the UruDendro dataset, we randomly divided it into train andtest sets with 40 and 24 images, respectively. The EH dataset consists of 82 images with 949 rings.UruDendro dataset comprises 64 images and 1123 rings. For training the INBD model, each imageis divided into patches determined by successive rings in polar coordinates, ensuring that each patchincludes an entire ring. Even though the EH dataset has more images, the UruDendro dataset hasmore rings per image. Considering the total number of tree rings, both datasets are comparable.UruDendroimages annotations must be transformed to the format required by the INBDmethod, identifying four categories in a wood cross-section image: background, pith, rings, andboundary rings.The INBD method relies on an important hyperparameter: the number of iterations at eachepoch (n). We seek the best-performing INBD model by exploring a grid with n {1, 2, 3, 4}. The",
  ": Pith samples from the UruDendro dataset. In the Pinus taeda species, the characteristics of the pith presentdifferences within the species": "model that best performs on the UruDendro training set was chosen. For training, we utilized theClusterUy infrastructure, as described in ClusterUy , equipped with an Nvidia Tesla P100 GPUwith 12GB of RAM. The hyperparameter n = 3 yields the best performance on the training set usingan input image resolution of 1500 pixels in the longest dimension.The Segmentation Network f (see ) didnt learn how to segment the pith for the Pinustaeda species. As shown in the pith characteristics vary greatly within the species. Addi-tionally, the pith size, relative to the sample size, is much smaller in Pinus taeda than in Shrub (EHdataset). As seen in , the pith size for this species is much bigger than for the samples inthe UruDendro dataset.INBD uses a loss that combines the three classes it wants to detect (background, boundaries, andcenter region). This is done by using a combination of cross-entropy loss and Dice loss, as shownbelow:",
  "Experiments and Results": "This section discusses the inference results over some samples from the test set.The followingmodifications were made to the code: First, the inference code was updated to accept the pithboundary as an input argument. As shown in , the pith size in the EH dataset is relativelybigger than in the UruDendro dataset. The code was also modified to accept the disk mask as aninput, using it as a stopping criterion. As shown in , the automatic background detection isnot working properly, and the mask solves this problem for the performance evaluation. Finally, acondition was added regarding the patch width in polar coordinates: if the automatically determinedwidth is too small regarding the image dimensions, it is set to one-fourth of the images dimensions.The next sections discuss the INBD results with the test samples.",
  "Qualitative results": "presents three sample disks where the INBD method performs very well. The commonaspect of these disks is that the texture characteristics of the center (pith) do not differ from the restof the disk, allowing the method to propagate smoothly. In the southern direction of the F07d disk,a significant error only begins to appear in the last ring (first row, third column), indicated by a deepblue in the absolute error graph. On the other hand, in the F08b disk, the method also successfullydelineates the rings automatically and reasonably well, despite the disk showing a significant presenceof fungi (black spots) with a radial pattern. Finally, the method performs very well on the F03c disk,even with a blue stain in the southern region.As explained in , a significant proportion of the detected ring must be close enough to the GTone to assign a detected ring to a given ground truth ring. As the detections are grossly perturbed,this condition doesnt arise, and the detected rings are not assigned to the ground truth ones. Inthe graphs showing the absolute errors in Figures 5 to 7, each circular band corresponds to a groundtrue ring, and if left uncolored, it indicates that no detection has been assigned. presents three additional samples with knots near the pith (F04c and L03c) and cracks(F03e). Despite the presence of knots and cracks, the rest of the disk areas show a high contrast inthe annual ring transitions, making these disks not particularly challenging for ring detection. Byconstruction, the INBD method iteratively propagates errors from the inner rings to the outer oneswithout recovery. In the examples shown in , knots near the center disturb the detectionand propagate outward errors. This is indicated by the yellow intensity in the absolute error graphsin polar coordinates. Additionally, in disks L03c and F03e, it can be observed that the detections",
  "Henry Marichal, Gregory Randall": ": L02a (1), L04e (2) and L02b (3). INBD method cannot recover from an error in the first rings. The first columndisplays the raw disk. The second column shows the ground truth rings in green and the INBD detections in red. In thethird column, the absolute error between the detections and the ground truth rings is visualized, with colors ranging fromred (low error) to blue (high error).",
  "A Brief Analysis of the Iterative Next Boundary Detection Network for Tree Rings Delineation in Images of Pinus taeda": ": Disks F04c (First row), L03c (Second row), and F03e (Third row). The INBD method struggles to recover frompropagation errors originating in the inner rings along certain radial directions. The first column displays the raw disk. Thesecond column shows the ground truth rings in green and the INBD detections in red. In the third column, the absoluteerror between the detections and the ground truth rings is visualized, with colors ranging from red (low error) to blue (higherror).",
  "Quantitative results": "This section presents quantitative metrics to evaluate the performance of the INBD model. Precision(P), Recall (R), and F-score (F) metrics are used. We follow the methodology defined in todetermine the assignment of detections to each ground true ring. The mAR and ARAND metricsdefined in the INBD article are also utilized. lists the disks in the order they appear inthe figures. Notably, the F-score decreases in the order of the disks appearance, which aligns with",
  ": Average metrics computed over the train set (40 samples) and test set (24 samples) of the UruDendro dataset": "shows the metrics results over the EH dataset resized to 1500 pixels in the longerdimension.We trained the INBD network using the resized EH dataset to validate the resizedprocedure. As can be seen, there appears to be a minor improvement for both metrics (test set)regarding the results reported in the original article, which can be explained by the fact we addedthe ground truth center boundary as input and the modification in input image resolution.",
  "Conclusions": "We successfully train the INBD network for tree ring delineation in the smartphones cross-sectionimages of Pinus taeda. Although the results are not perfect, in situations where the disk was properlytreated (no fungus presence or cracks) like F03c disk (), the method gives a good estimationof the boundaries of the rings once the pith boundary is provided. However, in situations where",
  "Images from": "Alexander Gillert, Giulia Resente, Alba Anadon-Rosell, Martin Wilmking, andUwe Freiherr von Lukas, Iterative next boundary detection for instance segmentation of treerings in microscopy images of shrub cross sections, in Proceedings of the IEEE/CVF Conferenceon Computer Vision and Pattern Recognition (CVPR), June 2023, pp. 1454014548. Henry Marichal, Diego Passarella, Christine Lucas, Ludmila Profumo, VeronicaCasaravilla, Mara Noel Rocha Galli, Serrana Ambite, and Gregory Randall,Urudendro, a public dataset of cross-section images of pinus taeda, 2024."
}
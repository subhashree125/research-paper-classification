{
  "Abstract": "Accurate forecasting of crop yields is crucial for maintaining food security and promoting sustainable agriculturalmethods. While AI has shown significant promise in various scientific domains, the creation of deep learningmodels for crop yield prediction has been constrained by the absence of an expansive, publicly accessible,multimodal dataset that encompasses adequate information. To address this limitation, we introduce CropNet, thefirst terabyte-scale, publicly available, multimodal dataset designed for climate-aware crop yield predictions acrossthe contiguous United States at the county level. The CropNet dataset integrates three types of data: Sentinel-2Imagery, WRF-HRRR Computed Dataset, and USDA Crop Dataset, covering over 2200 U.S. counties over sixyears (2017-2022). This dataset is designed to help researchers develop versatile deep learning models for accurateand timely county-level crop yield predictions, considering both short-term weather variations during the growingseason and long-term climate change impacts. Additionally, we offer the CropNet package, which includes threetypes of APIs to facilitate data downloading for specific times and regions of interest and to support the flexibledevelopment of deep learning models for precise crop yield predictions. Extensive experiments using various deeplearning solutions on the CropNet dataset confirm its general applicability and effectiveness in climate-consciouscrop yield predictions. The CropNet dataset is officially released on Hugging Face Datasets, and the CropNetpackage is available on the Python Package Index (PyPI).",
  "Introduction": "The accurate estimation of crop yields is vital for proactive agricultural planning, timely adjustments to management policies,informed financial decision-making, and ensuring national food security. Recent progress in deep neural networks (DNNs) hasled to remarkable performance in various fields. Building on these advancements, numerous studies have utilized spatial-temporalDNNs to enhance the timeliness and accuracy of crop yield predictions. However, these studies often rely on individually curatedand limited datasets, resulting in somewhat moderate prediction accuracy. There is a pressing need for new, extensive, and deeplearning-ready datasets specifically designed for widespread use in crop yield forecasting. Recent studies have introduced open and large-scale datasets based on satellite imagery or meteorological parameters, which areadaptable to agricultural tasks like crop type classification. However, these datasets have two primary limitations that prevent theirdirect application to general crop yield predictions. First, they lack the essential ground-truth crop yield data, making them unsuitablefor predicting crop yields. Second, they offer only a single data modality, either satellite images or meteorological parameters.Accurate crop yield predictions often require the simultaneous monitoring of crop growth and the capture of meteorological variationsthat affect yields, necessitating multiple data modalities. To date, the creation of a large-scale, multimodal dataset specifically forcounty-level crop yield predictions remains an unresolved challenge. In this research, we aim to develop such a dataset, named CropNet, which is the first terabyte-sized, publicly accessible dataset withmultiple modalities, specifically designed for county-level crop yield predictions across the United States (U.S.) continent. TheCropNet dataset comprises three data modalities: Sentinel-2 Imagery, WRF-HRRR Computed Dataset, and USDA Crop Dataset,covering 2291 U.S. counties from 2017 to 2022. Specifically, the Sentinel-2 Imagery from the Sentinel-2 mission provides twotypes of satellite images, agriculture imagery (AG) and normalized difference vegetation index (NDVI), for detailed monitoring ofcrop growth. The WRF-HRRR Computed Dataset, derived from the WRF-HRRR model, offers daily and monthly meteorologicalparameters, accounting for short-term weather variations and long-term climate change, respectively. The USDA Crop Dataset,sourced from the USDA Quick Statistic website, contains annual crop yield information for four major crops (corn, cotton, soybean,and winter wheat) grown in the contiguous U.S., serving as the ground-truth label for crop yield prediction tasks.",
  "The CropNet dataset is constructed from three distinct data sources, as detailed below:": "Sentinel-2 Mission: Launched in 2015, the Sentinel-2 mission is a crucial Earth observation initiative. It offers multi-spectralsatellite images with 13 spectral bands and a high revisit frequency of 5 days. These images are valuable for various applications,including climate change monitoring and agricultural oversight. WRF-HRRR Model: The High-Resolution Rapid Refresh (HRRR) is a forecast modeling system based on the Weather Research &Forecasting Model (WRF). It provides hourly forecasts of weather parameters for the entire United States continent with a spatialresolution of 3 km. We use the HRRR assimilated results archived at the University of Utah, which include several parametersrelevant to crop growth, such as temperature, precipitation, wind speed, relative humidity, and radiation, starting from July 2016. USDA: The United States Department of Agriculture (USDA) offers annual crop information for major crops cultivated in the U.S.at the county level, including corn, cotton, soybeans, and wheat. The statistical data, dating back to 1850, includes planted areas,harvested areas, production, and yield for each crop type.",
  "Motivation": "Large-scale, multimodal data that include satellite images, numerical meteorological weather data, and crop yield statistics areessential for monitoring crop growth and correlating weather variations with crop yields. These data are crucial for making timelyand precise crop yield predictions at the county level. Currently, there is no such open and extensive dataset available for county-levelcrop yield prediction. In this benchmark article, we introduce CropNet, an open and large-scale dataset with multiple modalities,including visual satellite images, numerical meteorological parameters, and crop yield statistics across the U.S. continent. It isimportant to note that not all U.S. counties are suitable for crop planting; therefore, our dataset includes data from 2291 out of 3143counties. This multimodal dataset is invaluable for researchers and practitioners to design and test various deep learning models forcrop yield predictions, considering both short-term growing season weather variations and long-term climate change impacts oncrop yields.",
  "Overview of Our CropNet Dataset": "The CropNet dataset consists of three data modalities: Sentinel-2 Imagery, WRF-HRRR Computed Dataset, and USDA CropDataset, spanning from 2017 to 2022 across 2291 U.S. counties. Given that crop planting is highly dependent on geography, thedataset includes the number of counties for each crop type in the USDA Crop Dataset. The four major crops included are corn,cotton, soybeans, and winter wheat, with satellite imagery and meteorological data covering all 2291 counties. An overview of theCropNet dataset is provided in . The total size of the dataset is 2362.6 GB, with 2326.7 GB of visual data for Sentinel-2Imagery, 35.5 GB of numerical data for the WRF-HRRR Computed Dataset, and 2.3 MB of numerical data for the USDA CropDataset. Sentinel-2 Imagery contains two types of satellite images (AG and NDVI), both with a spatial resolution of approximately40 meters (covering an area of 9x9 km with 224x224 pixels) and a revisit frequency of 14 days. The WRF-HRRR Computed Datasetprovides daily or monthly meteorological parameters gridded at a spatial resolution of 9 km in one-day or one-month intervals. TheUSDA Dataset offers county-level crop information for four types of crops, with a temporal resolution of one year.",
  "Data Collection and Preparation": "Sentinel-2 Imagery: We acquire satellite images from the Sentinel-2 mission using the Sentinel Hub Processing API at a processinglevel of Sentinel-2 L1C. We set a maximum cloud coverage of 20%, with three spectral bands (B02, B08, and B11) for AG imagesand two bands (B04 and B08) for NDVI images. Satellite images are obtained every 14 days instead of the original 5 days to avoid alarge number of duplicate images. Each county is partitioned into multiple grids with a resolution of 9x9 km, each corresponding toone satellite image. The downloaded satellite images for one U.S. state, spanning one season, are stored in one Hierarchical DataFormat (HDF5) file. The HDF5 file format is chosen for its ability to save disk space, store data in multidimensional arrays, andstore descriptive information for the satellite images. WRF-HRRR Computed Dataset: The WRF-HRRR Computed Dataset is derived from the WRF-HRRR model, which produceshourly GRID files containing meteorological parameters across the contiguous U.S. at a spatial resolution of 3x3 km. Our CropNetdataset includes nine crop growth-relevant meteorological parameters: averaged temperature, precipitation, relative humidity, windgust, wind speed, downward shortwave radiation flux, maximal temperature, minimal temperature, and vapor pressure deficit (VPD).VPD is calculated using the formula:TC = TK 273.15,",
  "(1)": "We align the resolution of the WRF-HRRR Computed Dataset with that of Sentinel-2 Imagery by using the latitude and longitude ofthe centric point in the 9x9 km grid to find the nearest 3x3 km grid in the WRF-HRRR model. Meteorological parameters from the3x3 km grid and its surrounding eight grids represent a region gridded at 9x9 km. Daily meteorological parameters are computedfrom hourly data, and monthly parameters are derived from daily data. These parameters are stored in Comma Separated Values(CSV) files, which also include the FIPS code, latitude, and longitude of each grid. USDA Crop Dataset: Data from the USDA Crop Dataset is retrieved from the USDA Quick Statistic website using a newly developedweb crawler. For each crop type, the USDA website provides county-level crop information annually, identified by a unique key.Our web crawler retrieves this key by specifying the crop type and year, then uses the key to obtain the corresponding crop data. Thedownloaded data is stored in a CSV file, which includes additional information such as FIPS code, state name, and county name. Thedata format is unified to store production and yield information in separate columns for easy access by Python libraries like pandas. Our CropNet dataset targets county-level crop yield predictions across the contiguous U.S. continent. We use the FIPS code to fetchdata for each county, including HDF5 files for Sentinel-2 Imagery, CSV files for daily and monthly meteorological parameters, and aCSV file for the USDA Crop Dataset. Configurations are stored in a JSON file for enhanced accessibility.",
  "Experimental Settings": "Approaches: We employed ConvLSTM, CNN-RNN, GNN-RNN, and MMST-ViT models for crop yield predictions. Additionally,we considered two self-supervised learning (SSL) techniques: MAE and MM-SSL within the MMST-ViT, representing unimodaland multimodal SSL techniques, respectively. These methods were adapted to fit the CropNet data in our experiments. Metrics: We used Root Mean Square Error (RMSE), R-squared (R2), and Pearson Correlation Coefficient (Corr) to assess theeffectiveness of the CropNet dataset. Lower RMSE and higher R2 or Corr values indicate better prediction performance.",
  "Performance Evaluation for 2022 Crop Yield Predictions": "Experiments were conducted on the CropNet dataset for 2022 crop yield predictions using satellite images, daily weather conditionsduring growing seasons, and monthly meteorological conditions from 2017 to 2021. The models used were ConvLSTM, CNN-RNN,GNN-RNN, and MMST-ViT. presents the overall performance results for each crop. All models achieved excellent predictionperformance with our CropNet data. For instance, ConvLSTM, CNN-RNN, GNN-RNN, and MMST-ViT showed low RMSEvalues for soybean yield predictions. These results validate that our CropNet dataset is well-suited for LSTM-based, CNN-based,GNN-based, and ViT-based models, demonstrating its general applicability. MMST-ViT achieved the best performance across allscenarios, with the lowest RMSE values and highest R2 and Corr values for predicting corn, cotton, soybeans, and winter wheatyields. This superior performance is attributed to MMST-ViTs novel attention mechanisms, which capture the effects of bothgrowing season weather variations and climate change on crop growth. This experiment demonstrates that our CropNet datasetcan provide timely and precise crop yield predictions, which are essential for making informed economic decisions and optimizingagricultural resource allocation.",
  "Performance of One-Year Ahead Predictions": "Predicting crop yields well in advance of the planting season is crucial for farmers to make early crop planting and managementplans. We used the CropNet dataset one year before the planting season to predict the next years crop yields. The experimentalresults for 2022 crop yield predictions using 2021 growing season data show that all models maintain decent prediction performance.For example, ConvLSTM, CNN-RNN, GNN-RNN, and MMST-ViT achieved average RMSE values of 6.2, 5.4, 5.3, and 4.7,",
  "RMSE ()R2 ()Corr ()RMSE ()R2 ()Corr ()RMSE ()R2 ()Corr ()RMSE ()R2 ()Corr ()": "ConvLSTM19.20.7950.89256.70.8340.9135.30.8010.8956.00.7980.893CNN-RNN14.30.8670.92354.50.8260.8994.10.8530.9155.60.8230.906GNN-RNN14.10.8710.91755.10.8130.8814.10.8680.9295.30.8450.912MMST-ViT13.20.8900.94350.90.8480.9213.90.8790.9374.80.8640.929 respectively, for soybean predictions. MMST-ViT consistently achieved excellent Corr values, averaging 0.922 for corn, 0.890 forcotton, 0.926 for soybeans, and 0.904 for winter wheat predictions. These results are only slightly inferior to those for regular 2022crop yield predictions, which can be attributed to MMST-ViTs ability to capture the indirect influence of 2021s weather conditionson the subsequent years crop growth through the use of long-term weather parameters. This further underscores how our CropNetdataset enhances climate change-aware crop yield predictions.",
  "Improving the Generalization Capabilities of DNNs": "Self-supervised learning (SSL) techniques have significantly advanced the generalization capabilities of deep neural networks(DNNs), especially in vision transformers (ViTs). Our CropNet dataset, with over 2 TB of data, benefits both deep learning andagricultural communities by providing large-scale visual satellite imagery and numerical meteorological data for pre-trainingDNNs. To demonstrate the applications of our CropNet dataset to self-supervised pre-training, we used MMST-ViT for crop yieldpredictions under three scenarios: MMST-ViT without SSL (w/o SSL), MMST-ViT with SSL in MAE (MAE), and MMST-ViT withthe multi-modal SSL technique (MM-SSL). The performance results for four crop types under three metrics (RMSE, R2, and Corr)show that without SSL, MMST-ViT exhibits limitations in generalization capabilities, resulting in suboptimal crop yield predictionperformance. Pre-training MMST-ViT with MAEs SSL technique improves performance compared to the w/o SSL scenario, withdecreased RMSE values for corn, cotton, soybeans, and winter wheat predictions. This confirms that our CropNet dataset canimprove the generalization capabilities of vision models. Furthermore, MMST-ViT with the multi-modal SSL technique achievedthe best performance results under all scenarios, significantly decreasing RMSE values for predicting corn, cotton, soybeans, andwinter wheat. The effectiveness of the multi-modal SSL technique may stem from its ability to integrate visual satellite imagerywith numerical meteorological data in the CropNet dataset, enhancing the generalization capabilities of the MMST-ViT model byimproving its ability to discern the influence of weather conditions on crop growth patterns during pre-training.",
  "Significance of Each Modality of Our CropNet Dataset": "To demonstrate the necessity and significance of each modality in our CropNet dataset, we examined five scenarios. First, wedropped the temporal satellite images (w/o temporal images) by randomly selecting only one days imagery data. Second, wediscarded the high-resolution satellite images (w/o high-resolution images) by using only one satellite image to capture the wholecountys agricultural information. Third, we ignored the effects of weather variations on crop yields by dropping all meteorologicaldata (w/o WRF-HRRR data). Similarly, w/o short-term data and w/o long-term data represent masking out the daily and monthlymeteorological parameters, respectively. We also included prediction results using all modalities of the CropNet dataset (All) forperformance comparison. Note that the USDA Crop Dataset provides the label for crop yield predictions, so no ablation study isrequired for this modality. presents the experimental results under the MMST-ViT model. Discarding the temporal satellite images (w/o temporalimages) significantly degrades performance, increasing RMSE values and lowering Corr values for corn and soybean yield predictions.This is because a sequence of satellite images spanning the whole growing season is essential for tracking crop growth. The w/ohigh-resolution images scenario achieved the worst prediction performance, with the highest RMSE values and lowest Corr valuesfor corn and soybean yield predictions. This is because high-resolution satellite images are critical for precise agricultural tracking.Dropping meteorological parameters (w/o WRF-HRRR data) prevents MMST-ViT from capturing meteorological effects on cropyields, leading to increased RMSE values and decreased Corr values for corn and soybean yield predictions. Discarding eitherdaily weather parameters (w/o short-term data) or monthly meteorological parameters (w/o long-term data) also lowers crop yieldprediction performance, as the former is necessary for capturing growing season weather variations, while the latter is essentialfor monitoring long-term climate change effects. Therefore, each modality in our CropNet dataset is important and necessary foraccurate crop yield predictions, especially for crops sensitive to growing season weather variations and climate change.",
  "The CropNet Package": "In addition to the CropNet dataset, we release the CropNet package, which includes three types of APIs available on the PythonPackage Index (PyPI). These APIs are designed to help researchers develop DNNs for multi-modal climate change-aware crop yieldpredictions. DataDownloader: This API enables researchers to download CropNet data for specific times and regions of interest on the fly. Forinstance, given the time and region (e.g., the FIPS code for a U.S. county), the DataDownloader API can be used to download theup-to-date CropNet data. DataRetriever: This API allows researchers to conveniently obtain CropNet data stored locally (e.g., after downloading the curateddataset) for specific times and regions of interest. The requested data is presented in a user-friendly format. DataLoader: This API assists researchers in developing DNNs for crop yield predictions. It allows for the flexible merging ofmultiple modalities of CropNet data and exposes them through a DataLoader object after performing necessary data preprocessing.",
  "Conclusion": "This work introduces the CropNet dataset, an open, large-scale, and multi-modal dataset specifically designed for county-levelcrop yield predictions across the contiguous United States. The CropNet dataset comprises three modalities of data: Sentinel-2Imagery, WRF-HRRR Computed Dataset, and USDA Crop Dataset, containing high-resolution satellite images, daily and monthlymeteorological conditions, and crop yield information, aligned both spatially and temporally. This dataset is ready for use indeep learning, agriculture, and meteorology, facilitating the development of new solutions and models for crop yield predictions,considering both growing season weather variations and climate change impacts on crop growth. Extensive experimental resultsconfirm the general applicability of our CropNet dataset to various deep learning models for both timely and one-year ahead cropyield predictions. Additionally, the application of our dataset to self-supervised pre-training scenarios demonstrates its utility inimproving the generalization capabilities of DNNs. Alongside the dataset, we have developed the CropNet package, which enablesresearchers to construct CropNet data on the fly for specific times and regions of interest and to flexibly build deep learning modelsfor climate change-aware crop yield predictions. While the initial goal of creating the CropNet dataset and package was to enhancecrop yield prediction accuracy, we believe its future applicability is broad and warrants further exploration, benefiting the deeplearning, agriculture, and meteorology communities in pursuing more interesting, critical, and pertinent applications."
}